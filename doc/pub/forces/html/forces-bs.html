<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="PHY321: Forces, Newton's Laws and Motion Example">

<title>PHY321: Forces, Newton's Laws and Motion Example</title>

<!-- Bootstrap style: bootstrap -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>


</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Basic Steps of Scientific Investigations', 2, None, '___sec0'),
              ('Identifying our System', 2, None, '___sec1'),
              ('Defining a Model', 2, None, '___sec2'),
              ('Solving the Equations', 2, None, '___sec3'),
              ('Analyze', 2, None, '___sec4'),
              ("Newton's Laws", 2, None, '___sec5'),
              ('Setting up a model for forces acting on an object',
               2,
               None,
               '___sec6'),
              ("Newton's Laws, the Second one first", 2, None, '___sec7'),
              ('Then the First Law', 2, None, '___sec8'),
              ('And finally the Third Law', 2, None, '___sec9'),
              ('Motion of a Single Object', 2, None, '___sec10'),
              ('Air Resistance in One Dimension', 2, None, '___sec11'),
              ('Resulting Acceleration', 2, None, '___sec12'),
              ('Going Ballistic, Projectile Motion or a Softer Approach, '
               'Falling Raindrops',
               2,
               None,
               '___sec13'),
              ('Ways of solving these equations', 2, None, '___sec14'),
              ('Solving as differential equations', 2, None, '___sec15'),
              ('Differential Equations, contn', 2, None, '___sec16'),
              ('Splitting into two parts', 2, None, '___sec17'),
              ('More details', 2, None, '___sec18'),
              ('Motion in a Magnetic Field', 2, None, '___sec19'),
              ('Sliding Block tied to a Wall', 2, None, '___sec20'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec21'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec22'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec23'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec24'),
              ('Simple Example, Block tied to a Wall, python code',
               2,
               None,
               '___sec25'),
              ('The classical pendulum and scaling the equations',
               2,
               None,
               '___sec26'),
              ('More on the Pendulum', 2, None, '___sec27'),
              ('More on the Pendulum', 2, None, '___sec28'),
              ('More on the Pendulum', 2, None, '___sec29'),
              ('Gravitational Force', 2, None, '___sec30'),
              ('Building a code for the solar system, force equations',
               2,
               None,
               '___sec31'),
              ('Building a code for the solar system, coupled equations',
               2,
               None,
               '___sec32'),
              ('Building a code for the solar system, final coupled equations',
               2,
               None,
               '___sec33'),
              ('Building a code for the solar system, discretized equations',
               2,
               None,
               '___sec34'),
              ('Building a code for the solar system, adding Jupiter',
               2,
               None,
               '___sec35'),
              ('Building a code for the solar system, adding Jupiter',
               2,
               None,
               '___sec36'),
              ('How can I get the initial velocities and positions of the '
               'planets',
               2,
               None,
               '___sec37'),
              ('How do we develop a larger numerical project',
               2,
               None,
               '___sec38'),
              ('More on large numerical projects', 2, None, '___sec39'),
              ('How to start our solar system project', 2, None, '___sec40'),
              ('How to start our solar system project, the simple Euler '
               'equations',
               2,
               None,
               '___sec41'),
              ('Adaptive methods', 2, None, '___sec42'),
              ('Adaptive methods', 2, None, '___sec43'),
              ('Adaptive methods', 2, None, '___sec44'),
              ('Adaptive methods', 2, None, '___sec45')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="forces-bs.html">PHY321: Forces, Newton's Laws and Motion Example</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="#___sec0" style="font-size: 80%;">Basic Steps of Scientific Investigations</a></li>
     <!-- navigation toc: --> <li><a href="#___sec1" style="font-size: 80%;">Identifying our System</a></li>
     <!-- navigation toc: --> <li><a href="#___sec2" style="font-size: 80%;">Defining a Model</a></li>
     <!-- navigation toc: --> <li><a href="#___sec3" style="font-size: 80%;">Solving the Equations</a></li>
     <!-- navigation toc: --> <li><a href="#___sec4" style="font-size: 80%;">Analyze</a></li>
     <!-- navigation toc: --> <li><a href="#___sec5" style="font-size: 80%;">Newton's Laws</a></li>
     <!-- navigation toc: --> <li><a href="#___sec6" style="font-size: 80%;">Setting up a model for forces acting on an object</a></li>
     <!-- navigation toc: --> <li><a href="#___sec7" style="font-size: 80%;">Newton's Laws, the Second one first</a></li>
     <!-- navigation toc: --> <li><a href="#___sec8" style="font-size: 80%;">Then the First Law</a></li>
     <!-- navigation toc: --> <li><a href="#___sec9" style="font-size: 80%;">And finally the Third Law</a></li>
     <!-- navigation toc: --> <li><a href="#___sec10" style="font-size: 80%;">Motion of a Single Object</a></li>
     <!-- navigation toc: --> <li><a href="#___sec11" style="font-size: 80%;">Air Resistance in One Dimension</a></li>
     <!-- navigation toc: --> <li><a href="#___sec12" style="font-size: 80%;">Resulting Acceleration</a></li>
     <!-- navigation toc: --> <li><a href="#___sec13" style="font-size: 80%;">Going Ballistic, Projectile Motion or a Softer Approach, Falling Raindrops</a></li>
     <!-- navigation toc: --> <li><a href="#___sec14" style="font-size: 80%;">Ways of solving these equations</a></li>
     <!-- navigation toc: --> <li><a href="#___sec15" style="font-size: 80%;">Solving as differential equations</a></li>
     <!-- navigation toc: --> <li><a href="#___sec16" style="font-size: 80%;">Differential Equations, contn</a></li>
     <!-- navigation toc: --> <li><a href="#___sec17" style="font-size: 80%;">Splitting into two parts</a></li>
     <!-- navigation toc: --> <li><a href="#___sec18" style="font-size: 80%;">More details</a></li>
     <!-- navigation toc: --> <li><a href="#___sec19" style="font-size: 80%;">Motion in a Magnetic Field</a></li>
     <!-- navigation toc: --> <li><a href="#___sec20" style="font-size: 80%;">Sliding Block tied to a Wall</a></li>
     <!-- navigation toc: --> <li><a href="#___sec21" style="font-size: 80%;">Simple Example, Block tied to a Wall</a></li>
     <!-- navigation toc: --> <li><a href="#___sec22" style="font-size: 80%;">Simple Example, Block tied to a Wall</a></li>
     <!-- navigation toc: --> <li><a href="#___sec23" style="font-size: 80%;">Simple Example, Block tied to a Wall</a></li>
     <!-- navigation toc: --> <li><a href="#___sec24" style="font-size: 80%;">Simple Example, Block tied to a Wall</a></li>
     <!-- navigation toc: --> <li><a href="#___sec25" style="font-size: 80%;">Simple Example, Block tied to a Wall, python code</a></li>
     <!-- navigation toc: --> <li><a href="#___sec26" style="font-size: 80%;">The classical pendulum and scaling the equations</a></li>
     <!-- navigation toc: --> <li><a href="#___sec27" style="font-size: 80%;">More on the Pendulum</a></li>
     <!-- navigation toc: --> <li><a href="#___sec28" style="font-size: 80%;">More on the Pendulum</a></li>
     <!-- navigation toc: --> <li><a href="#___sec29" style="font-size: 80%;">More on the Pendulum</a></li>
     <!-- navigation toc: --> <li><a href="#___sec30" style="font-size: 80%;">Gravitational Force</a></li>
     <!-- navigation toc: --> <li><a href="#___sec31" style="font-size: 80%;">Building a code for the solar system, force equations</a></li>
     <!-- navigation toc: --> <li><a href="#___sec32" style="font-size: 80%;">Building a code for the solar system, coupled equations</a></li>
     <!-- navigation toc: --> <li><a href="#___sec33" style="font-size: 80%;">Building a code for the solar system, final coupled equations</a></li>
     <!-- navigation toc: --> <li><a href="#___sec34" style="font-size: 80%;">Building a code for the solar system, discretized equations</a></li>
     <!-- navigation toc: --> <li><a href="#___sec35" style="font-size: 80%;">Building a code for the solar system, adding Jupiter</a></li>
     <!-- navigation toc: --> <li><a href="#___sec36" style="font-size: 80%;">Building a code for the solar system, adding Jupiter</a></li>
     <!-- navigation toc: --> <li><a href="#___sec37" style="font-size: 80%;">How can I get the initial velocities and positions of the planets</a></li>
     <!-- navigation toc: --> <li><a href="#___sec38" style="font-size: 80%;">How do we develop a larger numerical project</a></li>
     <!-- navigation toc: --> <li><a href="#___sec39" style="font-size: 80%;">More on large numerical projects</a></li>
     <!-- navigation toc: --> <li><a href="#___sec40" style="font-size: 80%;">How to start our solar system project</a></li>
     <!-- navigation toc: --> <li><a href="#___sec41" style="font-size: 80%;">How to start our solar system project, the simple Euler equations</a></li>
     <!-- navigation toc: --> <li><a href="#___sec42" style="font-size: 80%;">Adaptive methods</a></li>
     <!-- navigation toc: --> <li><a href="#___sec43" style="font-size: 80%;">Adaptive methods</a></li>
     <!-- navigation toc: --> <li><a href="#___sec44" style="font-size: 80%;">Adaptive methods</a></li>
     <!-- navigation toc: --> <li><a href="#___sec45" style="font-size: 80%;">Adaptive methods</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<!-- ------------------- main content ---------------------- -->



<div class="jumbotron">
<center><h1>PHY321: Forces, Newton's Laws and Motion Example</h1></center>  <!-- document title -->

<p>
<!-- author(s): <a href="http://mhjgit.github.io/info/doc/web/" target="_self">Morten Hjorth-Jensen</a>, <a href="https://pa.msu.edu/profile/pratts/" target="_self">Scott Pratt</a>, and <a href="https://pa.msu.edu/profile/schmidt/" target="_self">Carl Schmidt</a> -->

<center>
<b><a href="http://mhjgit.github.io/info/doc/web/" target="_self">Morten Hjorth-Jensen</a></b> [1, 2]
</center>

<center>
<b><a href="https://pa.msu.edu/profile/pratts/" target="_self">Scott Pratt</a></b> [1]
</center>

<center>
<b><a href="https://pa.msu.edu/profile/schmidt/" target="_self">Carl Schmidt</a></b> [3]
</center>

<p>
<!-- institution(s) -->

<center>[1] <b>Department of Physics and Astronomy and National Superconducting Cyclotron Laboratory, Michigan State University, USA</b></center>
<center>[2] <b>Department of Physics, University of Oslo, Norway</b></center>
<center>[3] <b>Department of Physics and Astronomy, Michigan State University, USA</b></center>
<br>
<p>
<center><h4>Jan 17, 2020</h4></center> <!-- date -->
<br>
<p>
<!-- potential-jumbotron-button -->
</div> <!-- end jumbotron -->

<!-- !split -->

<h2 id="___sec0" class="anchor">Basic Steps of Scientific Investigations </h2>

<p>
An overarching aim in this course is to give you a deeper
understanding of the scientific method. The problems we study will all
involve cases where we can apply classical mechanics. In our previous
material we already assumed that we had a model for the motion of an
object.  Alternatively we could have data from experiment (like Usain
Bolt's 100m world record run in 2008).  Or we could have performed
ourselves an experiment and we want to understand which forces are at
play and whether these forces can be understood in terms of
fundamental forces.

<p>
Our first step consists in identifying the problem. What we sketch
here may include a mix of experiment and theoretical simulations, or
just experiment or only theory.

<p>
<!-- !split -->

<h2 id="___sec1" class="anchor">Identifying our System </h2>

<p>
Here we can ask questions like

<ol>
<li> What kind of object is moving</li>
<li> What kind of data do we have</li>
<li> How do we measure position, velocity, acceleration etc</li>
<li> Which initial conditions influence our system</li>
<li> Other aspects which allow us to identify the system</li>
</ol>

<!-- !split -->

<h2 id="___sec2" class="anchor">Defining a Model </h2>

<p>
With our eventual data and observations we would now like to develop a
model for the system. In the end we want obviously to be able to
understand which forces are at play and how they influence our
specific system. That is, can we extract some deeper insights about a
system?

<p>
We need then to

<ol>
<li> Find the forces that act on our system</li>
<li> Introduce models for the forces</li>
<li> Identify the equations which can govern the system (Newton's second law for example)</li>
<li> More elements we deem important for defining our model</li>
</ol>

<!-- !split -->

<h2 id="___sec3" class="anchor">Solving the Equations </h2>

<p>
With the model at hand, we can then solve the equations. In classical mechanics we normally end up  with solving sets of coupled ordinary differential equations or partial differential equations.

<ol>
<li> Using Newton's second law we have equations of the type \( \boldsymbol{F}=m\boldsymbol{a}=md\boldsymbol{v}/dt \)</li>
<li> We need to  define the initial conditions (typically the initial velocity and position as functions of time) and/or initial conditions and boundary conditions</li>
<li> The solution of the equations give us then the position, the velocity and other time-dependent quantities which may specify the motion of a given object.</li>
</ol>

We are not yet done. With our lovely solvers, we need to start thinking.

<p>
<!-- !split -->

<h2 id="___sec4" class="anchor">Analyze </h2>

<p>
Now it is time to ask the big questions. What do our results mean? Can we give a simple interpretation in terms of fundamental laws?  What do our results mean? Are they correct?
Thus, typical questions we may ask are

<ol>
<li> Are our results for say \( \boldsymbol{r}(t) \) valid?  Do we trust what we did?  Can you validate and verify the correctness of your results?</li>
<li> Evaluate the answers and their implications</li>
<li> Compare with experimental data if possible. Does our model make sense?</li>
<li> and obviously many other questions.</li>
</ol>

The analysis stage feeds back to the first stage. It may happen that
the data we had were not good enough, there could be large statistical
uncertainties. We may need to collect more data or perhaps we did a
sloppy job in identifying the degrees of freedom.

<p>
All these steps are essential elements in a scientific
enquiry. Hopefully, through a mix of numerical simulations, analytical
calculations and experiments we may gain a deeper insight about the
physics of a specific system.

<p>
Let us now remind ourselves of Newton's laws, since these are the laws of motion we will study in this course.

<p>
<!-- !split -->

<h2 id="___sec5" class="anchor">Newton's Laws </h2>

<p>
When analyzing a physical system we normally start with distinguishing between the object we are studying (we will label this in more general terms as our <b>system</b>) and how this system interacts with the environment (which often means everything else!)

<p>
In our investigations we will thus analyze a specific physics problem in terms of the system and the environment.
In doing so we need to identify the forces that act on the system and assume that the
forces acting on the system must have a source, an identifiable cause in
the environment.

<p>
A force acting on for example a falling object must be related to an interaction with something in the environment.
This also means that we do not consider internal forces. The latter are forces between
one part of the object and another part. In this course we will mainly focus on external forces.

<p>
Forces are either contact forces or long-range forces.

<p>
Contact forces, as evident from the name, are forces that occur at the contact between
the system and the environment. Well-known long-range forces are the gravitional force and the electromagnetic force.

<p>
<!-- !split -->

<h2 id="___sec6" class="anchor">Setting up a model for forces acting on an object </h2>

<p>
In order to set up the forces which act on an object, the following steps may be useful

<ol>
<li> Divide the problem into system and environment.</li>
<li> Draw a figure of the object and everything in contact with the object.</li>
<li> Draw a closed curve around the system.</li>
<li> Find contact points&#8212;these are the points where contact forces may act.</li>
<li> Give names and symbols to all the contact forces.</li>
<li> Identify the long-range forces.</li>
<li> Make a drawing of the object. Draw the forces as arrows, vectors, starting from where the force is acting. The direction of the vector(s) indicates the (positive) direction of the force. Try to make the length of the arrow indicate the relative magnitude of the forces.</li>
<li> Draw in the axes of the coordinate system. It is often convenient to make one axis parallel to the direction of motion. When you choose the direction of the axis you also choose the positive direction for the axis.</li>
</ol>

<!-- !split -->

<h2 id="___sec7" class="anchor">Newton's Laws, the Second one first </h2>

<p>
Newton&#8217;s second law of motion: The force \( \boldsymbol{F} \) on an object of inertial mass \( m \)
is related to the acceleration a of the object through
$$
\boldsymbol{F} = m\boldsymbol{a},
$$

where \( \boldsymbol{a} \) is the acceleration.

<p>
Newton&#8217;s laws of motion are laws of nature that have been found by experimental
investigations and have been shown to hold up to continued experimental investigations.
Newton&#8217;s laws are valid over a wide range of length- and time-scales. We
use Newton&#8217;s laws of motion to describe everything from the motion of atoms to the
motion of galaxies.

<p>
The second law is a vector equation with the acceleration having the same
direction as the force. The acceleration is proportional to the force via the mass \( m \) of the system under study.

<p>
Newton&#8217;s second law introduces a new property of an object, the so-called 
inertial mass \( m \). We determine the inertial mass of an object by measuring the
acceleration for a given applied force.

<p>
<!-- !split -->

<h2 id="___sec8" class="anchor">Then the First Law </h2>

<p>
What happens if the net external force on a body is zero? Applying Newton&#8217;s second
law, we find:
$$
\boldsymbol{F} = 0 = m\boldsymbol{a},
$$

which gives using the definition of the acceleration
$$
\boldsymbol{a} = \frac{d\boldsymbol{v}}{dt}=0.
$$

The acceleration is zero, which means that the velocity of the object is constant. This
is often referred to as Newton&#8217;s first law. An object in a state of uniform motion tends to remain in
that state unless an external force changes its state of motion.
Why do we need a separate law for this? Is it not simply a special case of Newton&#8217;s
second law? Yes, Newton&#8217;s first law can be deduced from the second law as we have
illustrated. However, the first law is often used for a different purpose: Newton&#8217;s
First Law tells us about the limit of applicability of Newton&#8217;s Second law. Newton&#8217;s
Second law can only be used in reference systems where the First law is obeyed. But
is not the First law always valid? No! The First law is only valid in reference systems
that are not accelerated. If you observe the motion of a ball from an accelerating
car, the ball will appear to accelerate even if there are no forces acting on it. We call
systems that are not accelerating inertial systems, and Newton&#8217;s first law is often
called the law of inertia. Newton&#8217;s first and second laws of motion are only valid in
inertial systems.

<p>
A system is an inertial system if it is not accelerated. It means that the reference system
must not be accelerating linearly or rotating. Unfortunately, this means that most
systems we know are not really inertial systems. For example, the surface of the
Earth is clearly not an inertial system, because the Earth is rotating. The Earth is also
not an inertial system, because it ismoving in a curved path around the Sun. However,
even if the surface of the Earth is not strictly an inertial system, it may be considered
to be approximately an inertial system for many laboratory-size experiments.

<p>
<!-- !split -->

<h2 id="___sec9" class="anchor">And finally the Third Law </h2>

<p>
If there is a force from object A on object B, there is also a force from object B on object A.
This fundamental principle of interactions is called Newton&#8217;s third law. We do not
know of any force that do not obey this law: All forces appear in pairs. Newton&#8217;s
third law is usually formulated as: For every action there is an equal and opposite
reaction.

<p>
<!-- !split -->

<h2 id="___sec10" class="anchor">Motion of a Single Object </h2>

<p>
Here we consider the motion of a single particle moving under
the influence of some set of forces.  We will consider some problems where
the force does not depend on the position. In that case Newton's law
\( m\dot{\boldsymbol{v}}=\boldsymbol{F}(\boldsymbol{v}) \) is a first-order differential
equation and one solves for \( \boldsymbol{v}(t) \), then moves on to integrate
\( \boldsymbol{v} \) to get the position. In essentially all of these cases we cna find an analytical solution.

<p>
<!-- !split -->

<h2 id="___sec11" class="anchor">Air Resistance in One Dimension </h2>

<p>
Air resistance tends to scale as the square of the velocity. This is
in contrast to many problems chosen for textbooks, where it is linear
in the velocity. The choice of a linear dependence is motivated by
mathematical simplicity (it keeps the differential equation linear)
rather than by physics. One can see that the force should be quadratic
in velocity by considering the momentum imparted on the air
molecules. If an object sweeps through a volume \( dV \) of air in time
\( dt \), the momentum imparted on the air is

$$
\begin{equation}
dP=\rho_m dV v,
\label{_auto1}
\end{equation}
$$

<p>
where \( v \) is the velocity of the object and \( \rho_m \) is the mass
density of the air. If the molecules bounce back as opposed to stop
you would double the size of the term. The opposite value of the
momentum is imparted onto the object itself. Geometrically, the
differential volume is

$$
\begin{equation}
dV=Avdt,
\label{_auto2}
\end{equation}
$$

<p>
where \( A \) is the cross-sectional area and \( vdt \) is the distance the
object moved in time \( dt \).

<p>
<!-- !split -->

<h2 id="___sec12" class="anchor">Resulting Acceleration </h2>
Plugging this into the expression above,

$$
\begin{equation}
\frac{dP}{dt}=-\rho_m A v^2.
\label{_auto3}
\end{equation}
$$

<p>
This is the force felt by the particle, and is opposite to its
direction of motion. Now, because air doesn't stop when it hits an
object, but flows around the best it can, the actual force is reduced
by a dimensionless factor \( c_W \), called the drag coefficient.

$$
\begin{equation}
F_{\rm drag}=-c_W\rho_m Av^2,
\label{_auto4}
\end{equation}
$$

<p>
and the acceleration is

$$
\begin{eqnarray}
\frac{dv}{dt}=-\frac{c_W\rho_mA}{m}v^2.
\end{eqnarray}
$$

<p>
For a particle with initial velocity \( v_0 \), one can separate the \( dt \)
to one side of the equation, and move everything with $v$s to the
other side. We did this in our discussion of simple motion and will not repeat it here.

<p>
On more general terms,
for many systems, e.g. an automobile, there are multiple sources of
resistance. In addition to wind resistance, where the force is
proportional to \( v^2 \), there are dissipative effects of the tires on
the pavement, and in the axel and drive train. These other forces can
have components that scale proportional to \( v \), and components that
are independent of \( v \). Those independent of \( v \), e.g. the usual
\( f=\mu_K N \) frictional force you consider in your first Physics courses, only set in
once the object is actually moving. As speeds become higher, the \( v^2 \)
components begin to dominate relative to the others. For automobiles
at freeway speeds, the \( v^2 \) terms are largely responsible for the
loss of efficiency. To travel a distance \( L \) at fixed speed \( v \), the
energy/work required to overcome the dissipative forces are \( fL \),
which for a force of the form \( f=\alpha v^n \) becomes
$$
\begin{eqnarray}
W=\int dx~f=\alpha v^n L.
\end{eqnarray}
$$

For \( n=0 \) the work is
independent of speed, but for the wind resistance, where \( n=2 \),
slowing down is essential if one wishes to reduce fuel consumption. It
is also important to consider that engines are designed to be most
efficient at a chosen range of power output. Thus, some cars will get
better mileage at higher speeds (They perform better at 50 mph than at
5 mph) despite the considerations mentioned above.

<p>
<!-- !split -->

<h2 id="___sec13" class="anchor">Going Ballistic, Projectile Motion or a Softer Approach, Falling Raindrops </h2>

<p>
As an example of Newton's Laws we consider projectile motion (or a
falling raindrop) with a drag force. Even though air resistance is
largely proportional to the square of the velocity, we will consider
the drag force to be linear to the velocity, \( \boldsymbol{F}=-m\gamma\boldsymbol{v} \),
for the purposes of this exercise. The acceleration,
\( \boldsymbol{a}=\boldsymbol{F}/m \), becomes

$$
\begin{eqnarray}
\frac{dv_x}{dt}=-\gamma v_x,\\
\nonumber
\frac{dv_y}{dt}=-\gamma v_y-g,
\end{eqnarray}
$$

and \( \gamma \) has dimensions of inverse time.

<p>
<!-- !split -->

<h2 id="___sec14" class="anchor">Ways of solving these equations </h2>

<p>
We will go over two different ways to solve this equation. The first
by direct integration, and the second as a differential equation. To
do this by direct integration, one simply multiplies both sides of the
equations above by \( dt \), then divide by the appropriate factors so
that the $v$s are all on one side of the equation and the \( dt \) is on
the other. For the \( x \) motion one finds an easily integrable equation,

$$
\begin{eqnarray}
\frac{dv_x}{v_x}&=&-\gamma dt,\\
\nonumber
\int_{v_{0x}}^{v_{x}}\frac{dv_x}{v_x}&=&-\gamma\int_0^{t}dt,\\
\nonumber
\ln\left(\frac{v_{x}}{v_{0x}}\right)&=&-\gamma t,\\
\nonumber
v_{x}(t)&=&v_{0x}e^{-\gamma t}.
\end{eqnarray}
$$

<p>
This is very much the result you would have written down
by inspection. For the \( y \)-component of the velocity,

$$
\begin{eqnarray}
\frac{dv_y}{v_y+g/\gamma}&=&-\gamma dt\\
\nonumber
\ln\left(\frac{v_{y}+g/\gamma}{v_{0y}-g/\gamma}\right)&=&-\gamma t_f,\\
\nonumber
v_{fy}&=&-\frac{g}{\gamma}+\left(v_{0y}+\frac{g}{\gamma}\right)e^{-\gamma t}.
\end{eqnarray}
$$

<p>
Whereas \( v_x \) starts at some value and decays
exponentially to zero, \( v_y \) decays exponentially to the terminal
velocity, \( v_t=-g/\gamma \).

<p>
<!-- !split -->

<h2 id="___sec15" class="anchor">Solving as differential equations </h2>

<p>
Although this direct integration is simpler than the method we invoke
below, the method below will come in useful for some slightly more
difficult differential equations in the future. The differential
equation for \( v_x \) is straight-forward to solve. Because it is first
order there is one arbitrary constant, \( A \), and by inspection the
solution is

$$
\begin{equation}
v_x=Ae^{-\gamma t}.
\label{_auto5}
\end{equation}
$$

<p>
The arbitrary constants for equations of motion are usually determined
by the initial conditions, or more generally boundary conditions. By
inspection \( A=v_{0x} \), the initial \( x \) component of the velocity.

<p>
<!-- !split -->

<h2 id="___sec16" class="anchor">Differential Equations, contn </h2>
The differential equation for \( v_y \) is a bit more complicated due to
the presence of \( g \). Differential equations where all the terms are
linearly proportional to a function, in this case \( v_y \), or to
derivatives of the function, e.g., \( v_y \), \( dv_y/dt \),
\( d^2v_y/dt^2\cdots \), are called linear differential equations. If
there are terms proportional to \( v^2 \), as would happen if the drag
force were proportional to the square of the velocity, the
differential equation is not longer linear. Because this expression
has only one derivative in \( v \) it is a first-order linear differential
equation. If a term were added proportional to \( d^2v/dt^2 \) it would be
a second-order differential equation.  In this case we have a term
completely independent of \( v \), the gravitational acceleration \( g \), and
the usual strategy is to first rewrite the equation with all the
linear terms on one side of the equal sign,

$$
\begin{equation}
\frac{dv_y}{dt}+\gamma v_y=-g.
\label{_auto6}
\end{equation}
$$

<p>
<!-- !split -->

<h2 id="___sec17" class="anchor">Splitting into two parts </h2>

<p>
Now, the solution to the equation can be broken into two
parts. Because this is a first-order differential equation we know
that there will be one arbitrary constant. Physically, the arbitrary
constant will be determined by setting the initial velocity, though it
could be determined by setting the velocity at any given time. Like
most differential equations, solutions are not &quot;solved&quot;. Instead,
one guesses at a form, then shows the guess is correct. For these
types of equations, one first tries to find a single solution,
i.e. one with no arbitrary constants. This is called the {\it
particular} solution, \( y_p(t) \), though it should really be called
&quot;a&quot; particular solution because there are an infinite number of such
solutions. One then finds a solution to the {\it homogenous} equation,
which is the equation with zero on the right-hand side,

$$
\begin{equation}
\frac{dv_{y,h}}{dt}+\gamma v_{y,h}=0.
\label{_auto7}
\end{equation}
$$

<p>
Homogenous solutions will have arbitrary constants.

<p>
The particular solution will solve the same equation as the original
general equation

$$
\begin{equation}
\frac{dv_{y,p}}{dt}+\gamma v_{y,p}=-g.
\label{_auto8}
\end{equation}
$$

<p>
However, we don't need find one with arbitrary constants. Hence, it is
called a <b>particular</b> solution.

<p>
The sum of the two,

$$
\begin{equation}
v_y=v_{y,p}+v_{y,h},
\label{_auto9}
\end{equation}
$$

<p>
is a solution of the total equation because of the linear nature of
the differential equation. One has now found a <em>general</em> solution
encompassing all solutions, because it both satisfies the general
equation (like the particular solution), and has an arbitrary constant
that can be adjusted to fit any initial condition (like the homogneous
solution). If the equation were not linear, e.g if there were a term
such as \( v_y^2 \) or \( v_y\dot{v}_y \), this technique would not work.

<p>
<!-- !split -->

<h2 id="___sec18" class="anchor">More details </h2>

<p>
Returning to the example above, the homogenous solution is the same as
that for \( v_x \), because there was no gravitational acceleration in
that case,

$$
\begin{equation}
v_{y,h}=Be^{-\gamma t}.
\label{_auto10}
\end{equation}
$$

In this case a particular solution is one with constant velocity,

$$
\begin{equation}
v_{y,p}=-g/\gamma.
\label{_auto11}
\end{equation}
$$

Note that this is the terminal velocity of a particle falling from a
great height. The general solution is thus,

$$
\begin{equation}
v_y=Be^{-\gamma t}-g/\gamma,
\label{_auto12}
\end{equation}
$$

<p>
and one can find \( B \) from the initial velocity,

$$
\begin{equation}
v_{0y}=B-g/\gamma,~~~B=v_{0y}+g/\gamma.
\label{_auto13}
\end{equation}
$$

Plugging in the expression for \( B \) gives the \( y \) motion given the initial velocity,

$$
\begin{equation}
v_y=(v_{0y}+g/\gamma)e^{-\gamma t}-g/\gamma.
\label{_auto14}
\end{equation}
$$

It is easy to see that this solution has \( v_y=v_{0y} \) when \( t=0 \) and
\( v_y=-g/\gamma \) when \( t\rightarrow\infty \).

<p>
One can also integrate the two equations to find the coordinates \( x \)
and \( y \) as functions of \( t \),

$$
\begin{eqnarray}
x&=&\int_0^t dt'~v_{0x}(t')=\frac{v_{0x}}{\gamma}\left(1-e^{-\gamma t}\right),\\
\nonumber
y&=&\int_0^t dt'~v_{0y}(t')=-\frac{gt}{\gamma}+\frac{v_{0y}+g/\gamma}{\gamma}\left(1-e^{-\gamma t}\right).
\end{eqnarray}
$$

<p>
If the question was to find the position at a time \( t \), we would be
finished. However, the more common goal in a projectile equation
problem is to find the range, i.e. the distance \( x \) at which \( y \)
returns to zero. For the case without a drag force this was much
simpler. The solution for the \( y \) coordinate would have been
\( y=v_{0y}t-gt^2/2 \). One would solve for \( t \) to make \( y=0 \), which would
be \( t=2v_{0y}/g \), then plug that value for \( t \) into \( x=v_{0x}t \) to
find \( x=2v_{0x}v_{0y}/g=v_0\sin(2\theta_0)/g \). One follows the same
steps here, except that the expression for \( y(t) \) is more
complicated. Searching for the time where \( y=0 \), and we get

$$
\begin{equation}
0=-\frac{gt}{\gamma}+\frac{v_{0y}+g/\gamma}{\gamma}\left(1-e^{-\gamma t}\right).
\label{_auto15}
\end{equation}
$$

<p>
This cannot be inverted into a simple expression \( t=\cdots \). Such
expressions are known as &quot;transcendental equations&quot;, and are not the
rare instance, but are the norm. In the days before computers, one
might plot the right-hand side of the above graphically as
a function of time, then find the point where it crosses zero.

<p>
Now, the most common way to solve for an equation of the above type
would be to apply Newton's method numerically. This involves the
following algorithm for finding solutions of some equation \( F(t)=0 \).

<ol>
<li> First guess a value for the time, \( t_{\rm guess} \).</li>
<li> Calculate \( F \) and its derivative, \( F(t_{\rm guess}) \) and \( F'(t_{\rm guess}) \).</li> 
<li> Unless you guessed perfectly, \( F\ne 0 \), and assuming that \( \Delta F\approx F'\Delta t \), one would choose</li> 
<li> \( \Delta t=-F(t_{\rm guess})/F'(t_{\rm guess}) \).</li>
<li> Now repeat step 1, but with \( t_{\rm guess}\rightarrow t_{\rm guess}+\Delta t \).</li>
</ol>

If the \( F(t) \) were perfectly linear in \( t \), one would find \( t \) in one
step. Instead, one typically finds a value of \( t \) that is closer to
the final answer than \( t_{\rm guess} \). One breaks the loop once one
finds \( F \) within some acceptable tolerance of zero. A program to do
this might look like:

<p>
<!-- !split -->

<h2 id="___sec19" class="anchor">Motion in a Magnetic Field </h2>

<p>
Another example of a velocity-dependent force is magnetism,
$$
\begin{eqnarray}
\boldsymbol{F}&=&q\boldsymbol{v}\times\boldsymbol{B},\\
\nonumber
F_i&=&q\sum_{jk}\epsilon_{ijk}v_jB_k.
\end{eqnarray}
$$

<p>
For a uniform field in the \( z \) direction \( \boldsymbol{B}=B\hat{z} \), the force can only have \( x \) and \( y \) components,

$$
\begin{eqnarray}
F_x&=&qBv_y\\
\nonumber
F_y&=&-qBv_x.
\end{eqnarray}
$$

<p>
The differential equations are
$$
\begin{eqnarray}
\dot{v}_x&=&\omega_c v_y,\omega_c\equiv qB/m\\
\nonumber
\dot{v}_y&=&-\omega_c v_x.
\end{eqnarray}
One can solve the equations by taking time derivatives of either equation, then substituting into the other equation,
\begin{eqnarray}
\ddot{v}_x=\omega_c\dot{v_y}=-\omega_c^2v_x,\\
\nonumber
\ddot{v}_y&=&-\omega_c\dot{v}_x=-\omega_cv_y.
\end{eqnarray}
$$

<p>
The solution to these equations can be seen by inspection,
$$
\begin{eqnarray}
v_x&=&A\sin(\omega_ct+\phi),\\
\nonumber
v_y&=&A\cos(\omega_ct+\phi).
\end{eqnarray}
$$

<p>
One can integrate the equations to find the positions\ as a function of time,
$$
\begin{eqnarray}
x-x_0&=&\int_{x_0}^x dx=\int_0^t dt v(t)\\
\nonumber
&=&\frac{-A}{\omega_c}\cos(\omega_ct+\phi),\\
\nonumber
y-y_0&=&\frac{A}{\omega_c}\sin(\omega_ct+\phi).
\end{eqnarray}
$$

The trajectory is a circle centered at \( x_0,y_0 \) with amplitude \( A \) rotating in the clockwise direction.

<p>
The equations of motion for the \( z \) motion are
$$
\begin{equation}
\dot{v_z}=0,
\label{_auto16}
\end{equation}
$$

which leads to
$$
\begin{equation}
z-z_0=V_zt.
\label{_auto17}
\end{equation}
$$

Added onto the circle, the motion is helical.

<p>
Note that the kinetic energy,
$$
\begin{equation}
T=\frac{1}{2}m(v_x^2+v_y^2+v_z^2)=\frac{1}{2}m(\omega_c^2A^2+V_z^2),
\label{_auto18}
\end{equation}
$$

is constant. This is because the force is perpendicular to the
velocity, so that in any differential time element \( dt \) the work done
on the particle \( \boldsymbol{F}\cdot{dr}=dt\boldsymbol{F}\cdot{v}=0 \).

<p>
One should think about the implications of a velocity dependent
force. Suppose one had a constant magnetic field in deep space. If a
particle came through with velocity \( v_0 \), it would undergo cyclotron
motion with radius \( R=v_0/\omega_c \). However, if it were still its
motion would remain fixed. Now, suppose an observer looked at the
particle in one reference frame where the particle was moving, then
changed their velocity so that the particle's velocity appeared to be
zero. The motion would change from circular to fixed. Is this
possible?

<p>
The solution to the puzzle above relies on understanding
relativity. Imagine that the first observer believes \( \boldsymbol{B}\ne 0 \) and
that the electric field \( \boldsymbol{E}=0 \). If the observer then changes
reference frames by accelerating to a velocity \( \boldsymbol{v} \), in the new
frame \( \boldsymbol{B} \) and \( \boldsymbol{E} \) both change. If the observer moved to the
frame where the charge, originally moving with a small velocity \( v \),
is now at rest, the new electric field is indeed \( \boldsymbol{v}\times\boldsymbol{B} \),
which then leads to the same acceleration as one had before. If the
velocity is not small compared to the speed of light, additional
\( \gamma \) factors come into play,
\( \gamma=1/\sqrt{1-(v/c)^2} \). Relativistic motion will not be
considered in this course.

<p>
<!-- !split -->

<h2 id="___sec20" class="anchor">Sliding Block tied to a Wall </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
Another classical case is that of simple harmonic oscillations, here represented by a block sliding on a horizontal frictionless surface. The block is tied to a wall with a spring. If the spring is not compressed or stretched too far, the force on the block at a given position \( x \) is 
$$
      F=-kx.
  $$

The negative sign means that the force acts to restore the object to an equilibrium position. Newton's equation of motion for this idealized system is then 
$$
    m\frac{d^2x}{dt^2}=-kx,
  $$

or we could rephrase it as
$$
   \frac{d^2x}{dt^2}=-\frac{k}{m}x=-\omega_0^2x,
\label{eq:newton1}
  $$

with the angular frequency \( \omega_0^2=k/m \).

<p>
The above differential equation has the advantage that it can be solved  analytically with solutions on the form
$$
     x(t)=Acos(\omega_0t+\nu),
  $$

where \( A \) is the amplitude and \( \nu \) the phase constant.   This provides in turn an important test for the numerical
solution and the development of a program for more complicated cases which cannot be solved analytically.
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec21" class="anchor">Simple Example, Block tied to a Wall </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
With the position \( x(t) \) and the velocity  \( v(t)=dx/dt \) we can reformulate Newton's equation in the following way
$$
      \frac{dx(t)}{dt}=v(t),
  $$

  and
$$
      \frac{dv(t)}{dt}=-\omega_0^2x(t).
  $$

  We are now going to solve these equations using the Runge-Kutta method
  to fourth order discussed previously.
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec22" class="anchor">Simple Example, Block tied to a Wall </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
Before proceeding however, it is important to note that in addition to the exact solution, we have at least two further tests which can be used to check our solution.

<p>
Since functions like \( cos \) are periodic with a period \( 2\pi \), then the solution \( x(t) \) has also to be periodic. This means that
$$
     x(t+T)=x(t),
$$

with \( T \) the period defined as 
$$
     T=\frac{2\pi}{\omega_0}=\frac{2\pi}{\sqrt{k/m}}.
$$

Observe that \( T \) depends only on \( k/m \) and not on the amplitude of the solution.
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec23" class="anchor">Simple Example, Block tied to a Wall </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
In addition to the periodicity test, the total energy has also to be conserved.

<p>
Suppose we choose the initial conditions 
$$
     x(t=0)=1\hspace{0.1cm} \mathrm{m}\hspace{1cm} v(t=0)=0\hspace{0.1cm}\mathrm{m/s},
$$

meaning that block is at rest at \( t=0 \) but with a potential energy
$$
    E_0=\frac{1}{2}kx(t=0)^2=\frac{1}{2}k.
$$

The total energy at any time \( t \) has however to be conserved, meaning that our solution has to fulfil the condition
$$
    E_0=\frac{1}{2}kx(t)^2+\frac{1}{2}mv(t)^2.
$$
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec24" class="anchor">Simple Example, Block tied to a Wall </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
An algorithm which implements these equations is included below.

<ul>
 <li> Choose the initial position and speed, with the most common choice \( v(t=0)=0 \) and some fixed value for the position.</li> 
 <li> Choose the method you wish to employ in solving the problem.</li>
 <li> Subdivide the time interval \( [t_i,t_f]  \) into a grid with step size</li>
</ul>

$$
	  h=\frac{t_f-t_i}{N},
      $$

where \( N \) is the number of mesh points. 

<ul>
 <li> Calculate now the total energy given by</li> 
</ul>

$$
    E_0=\frac{1}{2}kx(t=0)^2=\frac{1}{2}k.
  $$


<ul>
 <li> Choose ODE solver to obtain \( x_{i+1} \) and \( v_{i+1} \) starting from the previous values \( x_i \) and \( v_i \).</li>
 <li> When we have computed \( x(v)_{i+1} \) we upgrade  \( t_{i+1}=t_i+h \).</li>
 <li> This iterative  process continues till we reach the maximum time \( t_f \).</li>
 <li> The results are checked against the exact solution. Furthermore, one has to check the stability of the numerical solution against the chosen number of mesh points \( N \).</li>      
</ul>
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec25" class="anchor">Simple Example, Block tied to a Wall, python code </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
The following python program performs essentially the same calculations as the previous c++ code.
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic">#</span>
<span style="color: #408080; font-style: italic"># This program solves Newtons equation for a block sliding on</span>
<span style="color: #408080; font-style: italic"># an horizontal frictionless surface.</span>
<span style="color: #408080; font-style: italic"># The block is tied to the wall with a spring, so N&#39;s eq takes the form:</span>
<span style="color: #408080; font-style: italic">#</span>
<span style="color: #408080; font-style: italic">#  m d^2x/dt^2 = - kx</span>
<span style="color: #408080; font-style: italic">#</span>
<span style="color: #408080; font-style: italic"># In order to make the solution dimless, we set k/m = 1.</span>
<span style="color: #408080; font-style: italic"># This results in two coupled diff. eq&#39;s that may be written as:</span>
<span style="color: #408080; font-style: italic">#</span>
<span style="color: #408080; font-style: italic">#  dx/dt = v</span>
<span style="color: #408080; font-style: italic">#  dv/dt = -x</span>
<span style="color: #408080; font-style: italic">#</span>
<span style="color: #408080; font-style: italic"># The user has to specify the initial velocity and position,</span>
<span style="color: #408080; font-style: italic"># and the number of steps. The time interval is fixed to</span>
<span style="color: #408080; font-style: italic"># t \in [0, 4\pi) (two periods)</span>
<span style="color: #408080; font-style: italic">#</span>
<span style="color: #408080; font-style: italic"># Note that this is a highly simplifyed rk4 code, intended</span>
<span style="color: #408080; font-style: italic"># for conceptual understanding and experimentation.</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sys</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">math</span>

<span style="color: #408080; font-style: italic">#Global variables</span>
ofile <span style="color: #666666">=</span> <span style="color: #008000">None</span>;
E0    <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">sim</span>(x_0, v_0, N):
    ts <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>
    te <span style="color: #666666">=</span> <span style="color: #666666">4*</span>math<span style="color: #666666">.</span>pi
    h <span style="color: #666666">=</span> (te<span style="color: #666666">-</span>ts)<span style="color: #666666">/</span><span style="color: #008000">float</span>(N)

    t <span style="color: #666666">=</span> ts;
    x <span style="color: #666666">=</span> x_0
    v <span style="color: #666666">=</span> v_0
    <span style="color: #008000; font-weight: bold">while</span> (t <span style="color: #666666">&lt;</span> te):
        kv1 <span style="color: #666666">=</span> <span style="color: #666666">-</span>h<span style="color: #666666">*</span>x
        kx1 <span style="color: #666666">=</span> h<span style="color: #666666">*</span>v

        kv2 <span style="color: #666666">=</span> <span style="color: #666666">-</span>h<span style="color: #666666">*</span>(x<span style="color: #666666">+</span>kx1<span style="color: #666666">/2</span>)
        kx2 <span style="color: #666666">=</span>  h<span style="color: #666666">*</span>(v<span style="color: #666666">+</span>kv1<span style="color: #666666">/2</span>)

        kv3 <span style="color: #666666">=</span> <span style="color: #666666">-</span>h<span style="color: #666666">*</span>(x<span style="color: #666666">+</span>kx2<span style="color: #666666">/2</span>)
        kx3 <span style="color: #666666">=</span>  h<span style="color: #666666">*</span>(v<span style="color: #666666">+</span>kv2<span style="color: #666666">/2</span>)

        kv4 <span style="color: #666666">=</span> <span style="color: #666666">-</span>h<span style="color: #666666">*</span>(x<span style="color: #666666">+</span>kx3<span style="color: #666666">/2</span>)
        kx4 <span style="color: #666666">=</span>  h<span style="color: #666666">*</span>(v<span style="color: #666666">+</span>kv3<span style="color: #666666">/2</span>)

        <span style="color: #408080; font-style: italic">#Write the old values to file</span>
        output(t,x,v)

        <span style="color: #408080; font-style: italic">#Update</span>
        x <span style="color: #666666">=</span> x <span style="color: #666666">+</span> (kx1 <span style="color: #666666">+</span> <span style="color: #666666">2*</span>(kx2<span style="color: #666666">+</span>kx3) <span style="color: #666666">+</span> kx4)<span style="color: #666666">/6</span>
        v <span style="color: #666666">=</span> v <span style="color: #666666">+</span> (kv1 <span style="color: #666666">+</span> <span style="color: #666666">2*</span>(kv2<span style="color: #666666">+</span>kv3) <span style="color: #666666">+</span> kv4)<span style="color: #666666">/6</span>
        t <span style="color: #666666">=</span> t<span style="color: #666666">+</span>h
        
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">output</span>(t,x,v):
    de <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>x<span style="color: #666666">**2+0.5*</span>v<span style="color: #666666">**2</span> <span style="color: #666666">-</span> E0;
    ofile<span style="color: #666666">.</span>write(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">%15.8E</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%15.8E</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%15.8E</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%15.8E</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%15.8E</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span>\
                <span style="color: #666666">%</span>(t, x, v, math<span style="color: #666666">.</span>cos(t),de));


<span style="color: #408080; font-style: italic">#MAIN PROGRAM:</span>

<span style="color: #408080; font-style: italic">#Get input</span>
<span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">len</span>(sys<span style="color: #666666">.</span>argv) <span style="color: #666666">==</span> <span style="color: #666666">5</span>:
    ofilename <span style="color: #666666">=</span>       sys<span style="color: #666666">.</span>argv[<span style="color: #666666">1</span>];
    x_0       <span style="color: #666666">=</span> <span style="color: #008000">float</span>(sys<span style="color: #666666">.</span>argv[<span style="color: #666666">2</span>])
    v_0       <span style="color: #666666">=</span> <span style="color: #008000">float</span>(sys<span style="color: #666666">.</span>argv[<span style="color: #666666">3</span>])
    N         <span style="color: #666666">=</span>   <span style="color: #008000">int</span>(sys<span style="color: #666666">.</span>argv[<span style="color: #666666">4</span>])
<span style="color: #008000; font-weight: bold">else</span>:
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;Usage:&quot;</span>, sys<span style="color: #666666">.</span>argv[<span style="color: #666666">0</span>], <span style="color: #BA2121">&quot;ofilename x0 v0 N&quot;</span>
    sys<span style="color: #666666">.</span>exit(<span style="color: #666666">0</span>)

<span style="color: #408080; font-style: italic">#Setup</span>
ofile <span style="color: #666666">=</span> <span style="color: #008000">open</span>(ofilename, <span style="color: #BA2121">&#39;w&#39;</span>)
E0    <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>x_0<span style="color: #666666">**2+0.5*</span>v_0<span style="color: #666666">**2</span>

<span style="color: #408080; font-style: italic">#Run simulation</span>
sim(x_0,v_0,N)

<span style="color: #408080; font-style: italic">#Cleanup</span>
ofile<span style="color: #666666">.</span>close() 
</pre></div>
<p>
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec26" class="anchor">The classical pendulum and scaling the equations </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
The angular equation of motion of the pendulum is given by
Newton's equation and with no external force it reads 
$$
\begin{equation}
  ml\frac{d^2\theta}{dt^2}+mgsin(\theta)=0,
\label{_auto19}
\end{equation}
$$

with an angular velocity and acceleration given by
$$
\begin{equation}
     v=l\frac{d\theta}{dt},
\label{_auto20}
\end{equation}
$$

and 
$$
\begin{equation}
     a=l\frac{d^2\theta}{dt^2}.
\label{_auto21}
\end{equation}
$$
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec27" class="anchor">More on the Pendulum </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
We do however expect that the motion will gradually come to an end due a viscous drag torque acting on the pendulum. 
In the presence of the drag, the above equation becomes
$$
\begin{equation}
   ml\frac{d^2\theta}{dt^2}+\nu\frac{d\theta}{dt}  +mgsin(\theta)=0, \label{eq:pend1}
\end{equation}
$$

where \( \nu \) is now a positive constant parameterizing the viscosity
of the medium in question. In order to maintain the motion against
viscosity, it is necessary to add some external driving force. 
We choose here a periodic driving force. The last equation becomes then
$$
\begin{equation}
   ml\frac{d^2\theta}{dt^2}+\nu\frac{d\theta}{dt}  +mgsin(\theta)=Asin(\omega t), \label{eq:pend2}
\end{equation}
$$

with \( A \) and \( \omega \) two constants representing the amplitude and 
the angular frequency respectively. The latter is called the driving frequency.
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec28" class="anchor">More on the Pendulum </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
We define 
$$
      \omega_0=\sqrt{g/l},
  $$

the so-called natural frequency and the new dimensionless quantities
$$
      \hat{t}=\omega_0t,
  $$

with the dimensionless driving frequency
$$
     \hat{\omega}=\frac{\omega}{\omega_0},
  $$

and introducing the quantity \( Q \), called the <em>quality factor</em>,
$$
     Q=\frac{mg}{\omega_0\nu},
  $$

  and the dimensionless amplitude 
$$
\hat{A}=\frac{A}{mg}
  $$
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec29" class="anchor">More on the Pendulum </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
We have 
$$
    \frac{d^2\theta}{d\hat{t}^2}+\frac{1}{Q}\frac{d\theta}{d\hat{t}}  
     +sin(\theta)=\hat{A}cos(\hat{\omega}\hat{t}).
$$

This equation can in turn be recast in terms of two coupled first-order differential equations as follows
$$
     \frac{d\theta}{d\hat{t}}=\hat{v},
$$

and
$$
     \frac{d\hat{v}}{d\hat{t}}=-\frac{\hat{v}}{Q}-sin(\theta)+\hat{A}cos(\hat{\omega}\hat{t}).
$$

These are the equations to be solved.  The factor \( Q \) represents the number of oscillations of the undriven system that must occur before  its energy is significantly reduced due to the viscous drag. The  amplitude \( \hat{A} \) is measured in units of the maximum possible  gravitational torque while \( \hat{\omega} \) is the angular frequency of the external torque measured in units of the pendulum's natural frequency.
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec30" class="anchor">Gravitational Force </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
We start with a simpler case first, the Earth-Sun system  in two dimensions only.  The gravitational force \( F_G \) is  
$$
      F=\frac{GM_{\odot}M_E}{r^2},
  $$

where \( G \) is the gravitational constant, 
$$
M_E=6\times 10^{24}\mathrm{Kg},
$$

the mass of Earth, 
$$
M_{\odot}=2\times 10^{30}\mathrm{Kg}, 
$$

the mass of the Sun and 
$$
r=1.5\times 10^{11}\mathrm{m}, 
$$

is the distance between Earth and the Sun. The latter defines what we call an astronomical unit <b>AU</b>.
From Newton's second law we have then for the \( x \) direction
$$
   \frac{d^2x}{dt^2}=\frac{F_{x}}{M_E},
  $$

and
$$
   \frac{d^2y}{dt^2}=\frac{F_{y}}{M_E},
  $$

for the \( y \) direction.
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec31" class="anchor">Building a code for the solar system, force equations </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
Introducing \( x=r\cos{(\theta)} \), \( y=r\sin{(\theta)} \) and
$$
r = \sqrt{x^2+y^2},
$$

we can rewrite 
$$
   F_{x}=-\frac{GM_{\odot}M_E}{r^2}\cos{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}x,
  $$

and
$$
     F_{y}=-\frac{GM_{\odot}M_E}{r^2}\sin{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}y,
  $$

for the \( y \) direction.
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec32" class="anchor">Building a code for the solar system, coupled equations </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
We can rewrite these two equations
$$
   F_{x}=-\frac{GM_{\odot}M_E}{r^2}\cos{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}x,
  $$

and
$$
     F_{y}=-\frac{GM_{\odot}M_E}{r^2}\sin{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}y,
  $$

as four first-order coupled differential equations
$$
   \frac{dv_x}{dt}=-\frac{GM_{\odot}}{r^3}x,
$$

$$
   \frac{dx}{dt}=v_x,
$$

$$
   \frac{dv_y}{dt}=-\frac{GM_{\odot}}{r^3}y,
$$

$$
   \frac{dy}{dt}=v_y.
$$
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec33" class="anchor">Building a code for the solar system, final coupled equations </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
The four coupled differential equations
$$
   \frac{dv_x}{dt}=-\frac{GM_{\odot}}{r^3}x,
$$

$$
   \frac{dx}{dt}=v_x,
$$

$$
   \frac{dv_y}{dt}=-\frac{GM_{\odot}}{r^3}y,
$$

$$
   \frac{dy}{dt}=v_y,
$$

can be turned into dimensionless equations or we can introduce astronomical units with \( 1 \) AU = \( 1.5\times 10^{11} \).

<p>
Using the equations from circular motion (with \( r =1\mathrm{AU} \)) 
$$
\frac{M_E v^2}{r} = F = \frac{GM_{\odot}M_E}{r^2},
$$

we have
$$
GM_{\odot}=v^2r,
$$

and using that the velocity of Earth (assuming circular motion) is
\( v = 2\pi r/\mathrm{yr}=2\pi\mathrm{AU}/\mathrm{yr} \), we have
$$
GM_{\odot}= v^2r = 4\pi^2 \frac{(\mathrm{AU})^3}{\mathrm{yr}^2}.
$$
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec34" class="anchor">Building a code for the solar system, discretized equations </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
The four coupled differential equations can then be discretized using Euler's method as (with step length \( h \))
$$
   v_{x,i+1}=v_{x,i}-h\frac{4\pi^2}{r_i^3}x_i,
$$

$$
   x_{i+1}=x_i+hv_{x,i},
$$

$$
   v_{y,i+1}=v_{y,i}-h\frac{4\pi^2}{r_i^3}y_i,
$$

$$
   y_{i+1}=y_i+hv_{y,i},
$$

<p>
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec35" class="anchor">Building a code for the solar system, adding Jupiter </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
It is rather straightforward to add a new planet, say Jupiter.
Jupiter has mass
$$
M_J=1.9\times 10^{27}\mathrm{kg},
$$

and distance to the Sun of \( 5.2 \) AU. 
The additional gravitational force the Earth feels from Jupiter in the \( x \)-direction is
$$
   F_{x}^{EJ}=-\frac{GM_JM_E}{r_{EJ}^3}(x_E-x_J),
  $$

where \( E \) stands for Earth, \( J \) for Jupiter, \( r_{EJ} \) is distance between Earth and Jupiter
$$
r_{EJ} = \sqrt{(x_E-x_J)^2+(y_E-y_J)^2},
$$

and \( x_E \) and \( y_E \) are the \( x \) and \( y \) coordinates of Earth, respectively, and 
\( x_J \) and \( y_J \) are the \( x \) and \( y \) coordinates of Jupiter, respectively.
The \( x \)-component of the velocity of Earth changes thus to
$$
   \frac{dv_x^E}{dt}=-\frac{GM_{\odot}}{r^3}x_E-\frac{GM_J}{r_{EJ}^3}(x_E-x_J).
$$
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec36" class="anchor">Building a code for the solar system, adding Jupiter </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
We can rewrite 
$$
   \frac{dv_x^E}{dt}=-\frac{GM_{\odot}}{r^3}x_E-\frac{GM_J}{r_{EJ}^3}(x_E-x_J).
$$

to
$$
   \frac{dv_x^E}{dt}=-\frac{4\pi^2}{r^3}x_E-\frac{4\pi^2M_J/M_{\odot}}{r_{EJ}^3}(x_E-x_J),
$$

where we used 
$$
GM_J = GM_{\odot}\left(\frac{M_J}{M_{\odot}}\right)=4\pi^2 \frac{M_J}{M_{\odot}}.
$$

Similarly, for the velocity in \( y \)-direction we have 
$$
   \frac{dv_y^E}{dt}=-\frac{4\pi^2}{r^3}y_E-\frac{4\pi^2M_J/M_{\odot}}{r_{EJ}^3}(y_E-y_J).
$$

Similar expressions apply for Jupiter. The equations for \( x \) and \( y \) 
derivatives are unchanged. This equations are similar for all other planets and as we will see later, it will be convenient to object orient this part when we program the full solar system.
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec37" class="anchor">How can I get the initial velocities and positions of the planets </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
<a href="http://www.nasa.gov/index.html" target="_self">NASA</a> has an excellent site at <a href="http://ssd.jpl.nasa.gov/horizons.cgi#top" target="_self"><tt>http://ssd.jpl.nasa.gov/horizons.cgi#top</tt></a>.
From there you can extract initial conditions in order to start your differential equation solver.
At the above website you need to change from <b>OBSERVER</b> to <b>VECTOR</b> and then write in the planet you are interested in.
The generated data contain the \( x \), \( y \) and \( z \) values as well as their corresponding velocities. The velocities are in units of AU per day.
Alternatively they can be obtained in terms of km and km/s.

<p>
For the first simple system involving the Earth and the Sun, you could just initialize the position with say \( x=1 \) AU
and \( y=0 \) AU.
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec38" class="anchor">How do we develop a larger numerical project  </h2>

<p>
When building up a numerical project there are several elements you should think of, amongst these we take the liberty of mentioning the following.

<ol>
 <li> How to structure a code in terms of functions and modules</li>
 <li> How to read input data flexibly from the command line</li>
 <li> Find tests and how to write unit tests (test functions). A very good example is <a href="https://github.com/philsquared/Catch" target="_self">Catch</a>, a modern, C++-native, header-only, framework for unit-tests. Try to find suitable tests of the mathematical algorithms as well as tests which reflect the physics of the system.</li> 
 <li> It takes one quick command to let all your code undergo heavy testing</li>
 <li> How to refactor code in terms of classes (instead of functions only)</li>
 <li> How to conduct and automate large-scale numerical experiments</li>
</ol>

<!-- !split -->

<h2 id="___sec39" class="anchor">More on large numerical projects  </h2>
The conventions and techniques outlined here will save you a lot of time when you incrementally extend software over time from simpler to more complicated problems.

<ol>
<li> Scale your equations in order to simplify, make for example the equations dimensionless or scale them in convenient units</li>
<li> New code is added in a modular fashion to a library (modules)</li>
<li> Programs are run through convenient user interfaces</li>
<li> Tedious manual work with running programs is automated,</li>
<li> Your scientific investigations are reproducible, scientific reports with top quality typesetting are produced both for paper and electronic devices.</li>
</ol>

<!-- !split -->

<h2 id="___sec40" class="anchor">How to start our solar system project  </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->

<p>
The simplest possible step is to code the Earth-Sun system using Euler's method in two dimensions.
The four coupled differential equations can then be discretized using Euler's method as (with step length \( h \)) are
$$
   v_{x,i+1}=v_{x,i}-h\frac{4\pi^2}{r_i^3}x_i,
$$

$$
   x_{i+1}=x_i+hv_{x,i},
$$

$$
   v_{y,i+1}=v_{y,i}-h\frac{4\pi^2}{r_i^3}y_i,
$$

$$
   y_{i+1}=y_i+hv_{y,i},
$$

<p>
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec41" class="anchor">How to start our solar system project, the simple Euler equations  </h2>
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic">/*    </span>
<span style="color: #408080; font-style: italic">    Euler&#39;s method for the Eart-Sun system, simplest possible code</span>
<span style="color: #408080; font-style: italic">*/</span> 
<span style="color: #BC7A00">#include</span> <span style="color: #408080; font-style: italic">&lt;cmath&gt;</span><span style="color: #BC7A00"></span>
<span style="color: #BC7A00">#include</span> <span style="color: #408080; font-style: italic">&lt;iostream&gt;</span><span style="color: #BC7A00"></span>
<span style="color: #BC7A00">#include</span> <span style="color: #408080; font-style: italic">&lt;fstream&gt;</span><span style="color: #BC7A00"></span>
<span style="color: #BC7A00">#include</span> <span style="color: #408080; font-style: italic">&lt;iomanip&gt;</span><span style="color: #BC7A00"></span>
<span style="color: #008000; font-weight: bold">using</span> <span style="color: #008000; font-weight: bold">namespace</span>  std;
<span style="color: #408080; font-style: italic">// output file as global variable</span>
ofstream ofile;
<span style="color: #408080; font-style: italic">// function declarations</span>
<span style="color: #B00040">void</span> <span style="color: #0000FF">output</span>( <span style="color: #B00040">double</span>, <span style="color: #B00040">double</span>, <span style="color: #B00040">double</span>, <span style="color: #B00040">double</span>, <span style="color: #B00040">double</span>);

<span style="color: #B00040">int</span> <span style="color: #0000FF">main</span>(<span style="color: #B00040">int</span> argc, <span style="color: #B00040">char</span><span style="color: #666666">*</span> argv[])
{
<span style="color: #408080; font-style: italic">//  declarations of variables</span>
  <span style="color: #B00040">char</span> <span style="color: #666666">*</span>outfilename;
  <span style="color: #408080; font-style: italic">// Read in output file, abort if there are too few command-line arguments</span>
  <span style="color: #008000; font-weight: bold">if</span>( argc <span style="color: #666666">&lt;=</span> <span style="color: #666666">1</span> ){
    cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;Bad Usage: &quot;</span> <span style="color: #666666">&lt;&lt;</span> argv[<span style="color: #666666">0</span>] <span style="color: #666666">&lt;&lt;</span>
      <span style="color: #BA2121">&quot; read also output file on same line&quot;</span> <span style="color: #666666">&lt;&lt;</span> endl;
    <span style="color: #408080; font-style: italic">//    exit(1);</span>
  }
  <span style="color: #008000; font-weight: bold">else</span>{
    outfilename<span style="color: #666666">=</span>argv[<span style="color: #666666">1</span>];
  }
  ofile.open(outfilename);

  <span style="color: #B00040">int</span> NumberofSteps <span style="color: #666666">=</span> <span style="color: #666666">1000</span>;
  <span style="color: #B00040">double</span> FinalTime <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>;
  <span style="color: #B00040">double</span> Step <span style="color: #666666">=</span> FinalTime<span style="color: #666666">/</span>((<span style="color: #B00040">double</span>) NumberofSteps);
  <span style="color: #B00040">double</span> time <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>;
  <span style="color: #408080; font-style: italic">// Initial values  x = 1.0 AU and vy = 2*pi</span>
  <span style="color: #B00040">double</span> pi <span style="color: #666666">=</span> acos(<span style="color: #666666">-1.0</span>);
  <span style="color: #B00040">double</span> FourPi2 <span style="color: #666666">=</span> <span style="color: #666666">4*</span>pi<span style="color: #666666">*</span>pi;
  <span style="color: #B00040">double</span> x <span style="color: #666666">=</span>  <span style="color: #666666">1.0</span>; <span style="color: #B00040">double</span> y <span style="color: #666666">=</span>  <span style="color: #666666">0.0</span>; <span style="color: #B00040">double</span> vx <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>; <span style="color: #B00040">double</span> vy <span style="color: #666666">=</span> <span style="color: #666666">2.0*</span>pi;
  <span style="color: #B00040">double</span> r <span style="color: #666666">=</span> sqrt(x<span style="color: #666666">*</span>x<span style="color: #666666">+</span>y<span style="color: #666666">*</span>y);

<span style="color: #408080; font-style: italic">// now we start solving the differential equations using Euler&#39;s method</span>
  <span style="color: #008000; font-weight: bold">while</span> (time <span style="color: #666666">&lt;=</span> FinalTime){
    x <span style="color: #666666">+=</span> Step<span style="color: #666666">*</span>vx;
    y <span style="color: #666666">+=</span> Step<span style="color: #666666">*</span>vy;
    vx <span style="color: #666666">-=</span> Step<span style="color: #666666">*</span>FourPi2<span style="color: #666666">*</span>x<span style="color: #666666">/</span>(r<span style="color: #666666">*</span>r<span style="color: #666666">*</span>r);
    vy <span style="color: #666666">-=</span> Step<span style="color: #666666">*</span>FourPi2<span style="color: #666666">*</span>y<span style="color: #666666">/</span>(r<span style="color: #666666">*</span>r<span style="color: #666666">*</span>r);
    r <span style="color: #666666">=</span> sqrt(x<span style="color: #666666">*</span>x<span style="color: #666666">+</span>y<span style="color: #666666">*</span>y);
    time <span style="color: #666666">+=</span> Step;
    output(time, x, y, vx, vy);   <span style="color: #408080; font-style: italic">// write to file </span>
  }
  ofile.close();  <span style="color: #408080; font-style: italic">// close output file</span>
  <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span>;
}   <span style="color: #408080; font-style: italic">//  End of main function </span>

<span style="color: #408080; font-style: italic">//    function to write out the final results</span>
<span style="color: #B00040">void</span> <span style="color: #0000FF">output</span>(<span style="color: #B00040">double</span> time, <span style="color: #B00040">double</span> x, <span style="color: #B00040">double</span> y, <span style="color: #B00040">double</span> vx, <span style="color: #B00040">double</span> vy)
{
  ofile <span style="color: #666666">&lt;&lt;</span> setiosflags(ios<span style="color: #666666">::</span>showpoint <span style="color: #666666">|</span> ios<span style="color: #666666">::</span>uppercase);
  ofile <span style="color: #666666">&lt;&lt;</span> setw(<span style="color: #666666">15</span>) <span style="color: #666666">&lt;&lt;</span> setprecision(<span style="color: #666666">8</span>) <span style="color: #666666">&lt;&lt;</span> time;
  ofile <span style="color: #666666">&lt;&lt;</span> setw(<span style="color: #666666">15</span>) <span style="color: #666666">&lt;&lt;</span> setprecision(<span style="color: #666666">8</span>) <span style="color: #666666">&lt;&lt;</span> x;
  ofile <span style="color: #666666">&lt;&lt;</span> setw(<span style="color: #666666">15</span>) <span style="color: #666666">&lt;&lt;</span> setprecision(<span style="color: #666666">8</span>) <span style="color: #666666">&lt;&lt;</span> y;
  ofile <span style="color: #666666">&lt;&lt;</span> setw(<span style="color: #666666">15</span>) <span style="color: #666666">&lt;&lt;</span> setprecision(<span style="color: #666666">8</span>) <span style="color: #666666">&lt;&lt;</span> vx;
  ofile <span style="color: #666666">&lt;&lt;</span> setw(<span style="color: #666666">15</span>) <span style="color: #666666">&lt;&lt;</span> setprecision(<span style="color: #666666">8</span>) <span style="color: #666666">&lt;&lt;</span> vy <span style="color: #666666">&lt;&lt;</span> endl;
}  <span style="color: #408080; font-style: italic">// end of function output</span>
</pre></div>
<p>
<!-- !split -->

<h2 id="___sec42" class="anchor">Adaptive methods </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
In case the function to integrate varies slowly or fast in different integration domains, adaptive methods are normally used. One strategy is always to decrease the step size. As we have seen earlier, this leads to more CPU cycles and may lead to loss or numerical precision. An alternative is to use higher-order RK methods for example. However, this leads again to more cycles, furthermore, there is no guarantee that higher-order leads to an improved error.
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec43" class="anchor">Adaptive methods </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
Assume the exact result is \( \tilde{x} \) and that we are using an RKM method. Suppose we run two calculations, one with \( h \) (called \( x_1 \)) and one with \( h/2 \) (called \( x_2 \)). Then
$$
\tilde{x}=x_1+Ch^{M+1}+O(h^{M+2}),
$$

and
$$
\tilde{x}=x_2+2C(h/2)^{M+1}+O(h^{M+2}),
$$

with \( C \) a constant. Note that we calculate two halves in the last equation. We get then
$$
|x_1-x_2| = Ch^{M+1}(1-\frac{1}{2^M}).
$$

yielding
$$
C=\frac{|x_1-x_2|}{(1-2^{-M})h^{M+1}}.
$$

We rewrite
$$
\tilde{x}=x_2+\epsilon+O((h)^{M+2}),
$$

with 
$$
\epsilon = \frac{|x_1-x_2|}{2^M-1}.
$$
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec44" class="anchor">Adaptive methods </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
With RK4 the expressions become
$$
\tilde{x}=x_2+\epsilon+O((h)^{6}),
$$

with
$$
\epsilon = \frac{|x_1-x_2|}{15}.
$$

The estimate is one order higher than the original RK4. But this method is normally rather inefficient since it requires a lot of computations. We solve typically the equation three times at each time step. 
However, we can compare the estimate \( \epsilon \) with some by us given accuracy \( \xi \). 
We can then ask the question: what is, with a given \( x_j \) and \( t_j \), the largest possible step size \( \tilde{h} \) that leads to a truncation error below \( \xi \)?
We want
$$
C\tilde{h} \le \xi,
$$

which leads to 
$$
\left(\frac{\tilde{h}}{h}\right)^{M+1}\frac{|x_1-x_2|}{(1-2^{-M})}\le \xi, 
$$

meaning that
$$
\tilde{h}=h\left(\frac{\xi}{\epsilon}\right)^{1+1/M}. 
$$
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec45" class="anchor">Adaptive methods </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
With 
$$
\tilde{h}=h\left(\frac{\xi}{\epsilon}\right)^{1+1/M}. 
$$

we can design the following algorithm:

<ul>
 <li> If the two answers are close, keep the approximation to \( h \).</li>
 <li> If \( \epsilon > \xi \) we need to decrease the step size in the next time step.</li>
 <li> If \( \epsilon < \xi \) we need to increase the step size in the next time step.</li>
</ul>
</div>
</div>


<p>

<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright --> &copy; 1999-2020, "Morten Hjorth-Jensen":"http://mhjgit.github.io/info/doc/web/". Released under CC Attribution-NonCommercial 4.0 license
</center>


</body>
</html>
    


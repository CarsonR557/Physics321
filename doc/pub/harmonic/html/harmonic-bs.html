<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Oscillations">

<title>Oscillations</title>

<!-- Bootstrap style: bootstrap -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>


</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Harmonic Oscillator', 2, None, '___sec0'),
              ('Damped Oscillators', 2, None, '___sec1'),
              ('Underdamped: $\\beta<\\omega_0$', 3, None, '___sec2'),
              ('Critical dampling: $\\beta=\\omega_0$', 3, None, '___sec3'),
              ('Overdamped: $\\beta>\\omega_0$', 3, None, '___sec4'),
              ('Our Sliding Block Code', 2, None, '___sec5'),
              ('Sinusoidally Driven Oscillators', 2, None, '___sec6'),
              ('Alternative Derivation for Driven Oscillators',
               2,
               None,
               '___sec7'),
              ('Resonance Widths; the $Q$ factor', 2, None, '___sec8'),
              ('Principle of Superposition and Periodic Forces (Fourier '
               'Transforms)',
               2,
               None,
               '___sec9'),
              ('Response to Transient Force', 2, None, '___sec10'),
              ('Sliding Block tied to a Wall', 2, None, '___sec11'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec12'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec13'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec14'),
              ('Simple Example, Block tied to a Wall', 2, None, '___sec15'),
              ('Simple Example, Block tied to a Wall, python code',
               2,
               None,
               '___sec16'),
              ('The classical pendulum and scaling the equations',
               2,
               None,
               '___sec17'),
              ('More on the Pendulum', 2, None, '___sec18'),
              ('More on the Pendulum', 2, None, '___sec19'),
              ('More on the Pendulum', 2, None, '___sec20')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="harmonic-bs.html">Oscillations</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="#___sec0" style="font-size: 80%;"><b>Harmonic Oscillator</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec1" style="font-size: 80%;"><b>Damped Oscillators</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Underdamped: \( \beta<\omega_0 \)</a></li>
     <!-- navigation toc: --> <li><a href="#___sec3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Critical dampling: \( \beta=\omega_0 \)</a></li>
     <!-- navigation toc: --> <li><a href="#___sec4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Overdamped: \( \beta>\omega_0 \)</a></li>
     <!-- navigation toc: --> <li><a href="#___sec5" style="font-size: 80%;"><b>Our Sliding Block Code</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec6" style="font-size: 80%;"><b>Sinusoidally Driven Oscillators</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec7" style="font-size: 80%;"><b>Alternative Derivation for Driven Oscillators</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec8" style="font-size: 80%;"><b>Resonance Widths; the \( Q \) factor</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec9" style="font-size: 80%;"><b>Principle of Superposition and Periodic Forces (Fourier Transforms)</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec10" style="font-size: 80%;"><b>Response to Transient Force</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec11" style="font-size: 80%;"><b>Sliding Block tied to a Wall</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec12" style="font-size: 80%;"><b>Simple Example, Block tied to a Wall</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec13" style="font-size: 80%;"><b>Simple Example, Block tied to a Wall</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec14" style="font-size: 80%;"><b>Simple Example, Block tied to a Wall</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec15" style="font-size: 80%;"><b>Simple Example, Block tied to a Wall</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec16" style="font-size: 80%;"><b>Simple Example, Block tied to a Wall, python code</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec17" style="font-size: 80%;"><b>The classical pendulum and scaling the equations</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec18" style="font-size: 80%;"><b>More on the Pendulum</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec19" style="font-size: 80%;"><b>More on the Pendulum</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec20" style="font-size: 80%;"><b>More on the Pendulum</b></a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<!-- ------------------- main content ---------------------- -->



<div class="jumbotron">
<center><h1>Oscillations</h1></center>  <!-- document title -->

<p>
<!-- author(s): <a href="http://mhjgit.github.io/info/doc/web/" target="_self">Morten Hjorth-Jensen</a>, <a href="https://pa.msu.edu/profile/pratts/" target="_self">Scott Pratt</a>, and <a href="https://pa.msu.edu/profile/schmidt/" target="_self">Carl Schmidt</a> -->

<center>
<b><a href="http://mhjgit.github.io/info/doc/web/" target="_self">Morten Hjorth-Jensen</a></b> [1, 2]
</center>

<center>
<b><a href="https://pa.msu.edu/profile/pratts/" target="_self">Scott Pratt</a></b> [1]
</center>

<center>
<b><a href="https://pa.msu.edu/profile/schmidt/" target="_self">Carl Schmidt</a></b> [3]
</center>

<p>
<!-- institution(s) -->

<center>[1] <b>Department of Physics and Astronomy and National Superconducting Cyclotron Laboratory, Michigan State University, USA</b></center>
<center>[2] <b>Department of Physics, University of Oslo, Norway</b></center>
<center>[3] <b>Department of Physics and Astronomy, Michigan State University, USA</b></center>
<br>
<p>
<center><h4>Feb 10, 2020</h4></center> <!-- date -->
<br>
<p>
</div> <!-- end jumbotron -->

<h2 id="___sec0" class="anchor">Harmonic Oscillator </h2>

<p>
The harmonic oscillator is omnipresent in physics. Although you may think 
of this as being related to springs, it, or an equivalent
mathematical representation, appears in just about any problem where a
mode is sitting near its potential energy minimum. At that point,
\( \partial_x V(x)=0 \), and the first non-zero term (aside from a
constant) in the potential energy is that of a harmonic oscillator. In
a solid, sound modes (phonons) are built on a picture of coupled
harmonic oscillators, and in relativistic field theory the fundamental
interactions are also built on coupled oscillators positioned
infinitesimally close to one another in space. The phenomena of a
resonance of an oscillator driven at a fixed frequency plays out
repeatedly in atomic, nuclear and high-energy physics, when quantum
mechanically the evolution of a state oscillates according to
\( e^{-iEt} \) and exciting discrete quantum states has very similar
mathematics as exciting discrete states of an oscillator.

<p>
The potential energy for a single particle as a function of its position \( x \) can be written as a Taylor expansion about some point \( x_0 \)

$$
\begin{equation}
V(x)=V(x_0)+(x-x_0)\left.\partial_xV(x)\right|_{x_0}+\frac{1}{2}(x-x_0)^2\left.\partial_x^2V(x)\right|_{x_0}
+\frac{1}{3!}\left.\partial_x^3V(x)\right|_{x_0}+\cdots
\label{_auto1}
\end{equation}
$$

If the position \( x_0 \) is at the minimum of the resonance, the first two non-zero terms of the potential are

$$
\begin{eqnarray}
V(x)&\approx& V(x_0)+\frac{1}{2}(x-x_0)^2\left.\partial_x^2V(x)\right|_{x_0},\\
\nonumber
&=&V(x_0)+\frac{1}{2}k(x-x_0)^2,~~~~k\equiv \left.\partial_x^2V(x)\right|_{x_0},\\
\nonumber
F&=&-\partial_xV(x)=-k(x-x_0).
\end{eqnarray}
$$

Put into Newton's 2nd law (assuming \( x_0=0 \)),

$$
\begin{eqnarray}
m\ddot{x}&=&-kx,\\
x&=&A\cos(\omega_0 t-\phi),~~~\omega_0=\sqrt{k/m}.
\end{eqnarray}
$$

<p>
Here \( A \) and \( \phi \) are arbitrary. Equivalently, one could have
written this as \( A\cos(\omega_0 t)+B\sin(\omega_0 t) \), or as the real
part of \( Ae^{i\omega_0 t} \). In this last case \( A \) could be an
arbitrary complex constant. Thus, there are 2 arbitrary constants
(either \( A \) and \( B \) or \( A \) and \( \phi \), or the real and imaginary part
of one complex constant. This is the expectation for a second order
differential equation, and also agrees with the physical expectation
that if you know a particle's initial velocity and position you should
be able to define its future motion, and that those two arbitrary
conditions should translate to two arbitrary constants.

<p>
A key feature of harmonic motion is that the system repeats itself
after a time \( T=1/f \), where \( f \) is the frequency, and \( \omega=2\pi f \)
is the angular frequency. The period of the motion is independent of
the amplitude. However, this independence is only exact when one can
neglect higher terms of the potential, \( x^3, x^4\cdots \). Once can
neglect these terms for sufficiently small amplitudes, and for larger
amplitudes the motion is no longer purely sinusoidal, and even though
the motion repeats itself, the time for repeating the motion is no
longer independent of the amplitude.

<p>
One can also calculate the velocity and the kinetic energy as a function of time,

$$
\begin{eqnarray}
\dot{x}&=&-\omega_0A\sin(\omega_0 t-\phi),\\
\nonumber
K&=&\frac{1}{2}m\dot{x}^2=\frac{m\omega_0^2A^2}{2}\sin^2(\omega_0t-\phi),\\
\nonumber
&=&\frac{k}{2}A^2\sin^2(\omega_0t-\phi).
\end{eqnarray}
$$

<p>
The total energy is then

$$
\begin{equation}
E=K+V=\frac{1}{2}m\dot{x}^2+\frac{1}{2}kx^2=\frac{1}{2}kA^2.
\label{_auto2}
\end{equation}
$$

<p>
The total energy then goes as the square of the amplitude.

<p>
A pendulum is an example of a harmonic oscillator. By expanding the
kinetic and potential energies for small angles find the frequency for
a pendulum of length \( L \) with all the mass \( m \) centered at the end by
writing the eq.s of motion in the form of a harmonic oscillator.

<p>
The potential energy and kinetic energies are (for \( x \) being the displacement)

$$
\begin{eqnarray*}
V&=&mgL(1-\cos\theta)\approx mgL\frac{x^2}{2L^2},\\
K&=&\frac{1}{2}mL^2\dot{\theta}^2\approx \frac{m}{2}\dot{x}^2.
\end{eqnarray*}
$$

<p>
For small \( x \) Newton's 2nd law becomes

$$
m\ddot{x}=-\frac{mg}{L}x,
$$

<p>
and the spring constant would appear to be \( k=mg/L \), which makes the
frequency equal to \( \omega_0=\sqrt{g/L} \). Note that the frequency is
independent of the mass.

<h2 id="___sec1" class="anchor">Damped Oscillators </h2>

<p>
We consider only the case where the damping force is proportional to
the velocity. This is counter to dragging friction, where the force is
proportional in strength to the normal force and independent of
velocity, and is also inconsistent with wind resistance, where the
magnitude of the drag force is proportional the square of the
velocity. Rolling resistance does seem to be mainly proportional to
the velocity. However, the main motivation for considering damping
forces proportional to the velocity is that the math is more
friendly. This is because the differential equation is linear,
i.e. each term is of order \( x \), \( \dot{x} \), \( \ddot{x}\cdots \), or even
terms with no mention of \( x \), and there are no terms such as \( x^2 \) or
\( x\ddot{x} \). The equations of motion for a spring with damping force
\( -b\dot{x} \) are

$$
\begin{equation}
m\ddot{x}+b\dot{x}+kx=0.
\label{_auto3}
\end{equation}
$$

<p>
Just to make the solution a bit less messy, we rewrite this equation as

$$
\begin{equation}
\label{eq:dampeddiffyq}
\ddot{x}+2\beta\dot{x}+\omega_0^2x=0,~~~~\beta\equiv b/2m,~\omega_0\equiv\sqrt{k/m}.
\end{equation}
$$

<p>
Both \( \beta \) and \( \omega \) have dimensions of inverse time. To find solutions (see appendix C in the text) you must make an educated guess at the form of the solution. To do this, first realize that the solution will need an arbitrary normalization \( A \) because the equation is linear. Secondly, realize that if the form is

$$
\begin{equation}
x=Ae^{rt}
\label{_auto4}
\end{equation}
$$

<p>
that each derivative simply brings out an extra power of \( r \). This
means that the \( Ae^{rt} \) factors out and one can simply solve for an
equation for \( r \). Plugging this form into Eq. \eqref{eq:dampeddiffyq},

$$
\begin{equation}
r^2+2\beta r+\omega_0^2=0.
\label{_auto5}
\end{equation}
$$

<p>
Because this is a quadratic equation there will be two solutions,

$$
\begin{equation}
r=-\beta\pm\sqrt{\beta^2-\omega_0^2}.
\label{_auto6}
\end{equation}
$$

<p>
We refer to the two solutions as \( r_1 \) and \( r_2 \) corresponding to the
\( + \) and \( - \) roots. As expected, there should be two arbitrary
constants involved in the solution,

$$
\begin{equation}
x=A_1e^{r_1t}+A_2e^{r_2t},
\label{_auto7}
\end{equation}
$$

<p>
where the coefficients \( A_1 \) and \( A_2 \) are determined by initial
conditions.

<p>
The roots listed above, \( \sqrt{\omega_0^2-\beta_0^2} \), will be
imaginary if the damping is small and \( \beta < \omega_0 \). In that case,
\( r \) is complex and the factor \( e{rt} \) will have some oscillatory
behavior. If the roots are real, there will only be exponentially
decaying solutions. There are three cases:

<h3 id="___sec2" class="anchor">Underdamped: \( \beta < \omega_0 \) </h3>

$$
\begin{eqnarray}
x&=&A_1e^{-\beta t}e^{i\omega't}+A_2e^{-\beta t}e^{-i\omega't},~~\omega'\equiv\sqrt{\omega_0^2-\beta^2}\\
\nonumber
&=&(A_1+A_2)e^{-\beta t}\cos\omega't+i(A_1-A_2)e^{-\beta t}\sin\omega't.
\end{eqnarray}
$$

<p>
Here we have made use of the identity
\( e^{i\omega't}=\cos\omega't+i\sin\omega't \). Because the constants are
arbitrary, and because the real and imaginary parts are both solutions
individually, we can simply consider the real part of the solution
alone:

$$
\begin{eqnarray}
\label{eq:homogsolution}
x&=&B_1e^{-\beta t}\cos\omega't+B_2e^{-\beta t}\sin\omega't,\\
\nonumber 
\omega'&\equiv&\sqrt{\omega_0^2-\beta^2}.
\end{eqnarray}
$$

<h3 id="___sec3" class="anchor">Critical dampling: \( \beta=\omega_0 \) </h3>

<p>
In this case the two terms involving \( r_1 \) and \( r_2 \) are identical
because \( \omega'=0 \). Because we need to arbitrary constants, there
needs to be another solution. This is found by simply guessing, or by
taking the limit of \( \omega'\rightarrow 0 \) from the underdamped
solution. The solution is then

$$
\begin{equation}
\label{eq:criticallydamped}
x=Ae^{-\beta t}+Bte^{-\beta t}.
\end{equation}
$$

<p>
The critically damped solution is interesting because the solution
approaches zero quickly, but does not oscillate. For a problem with
zero initial velocity, the solution never crosses zero. This is a good
choice for designing shock absorbers or swinging doors.

<h3 id="___sec4" class="anchor">Overdamped: \( \beta>\omega_0 \) </h3>

$$
\begin{eqnarray}
x&=&A_1\exp{-(\beta+\sqrt{\beta^2-\omega_0^2})t}+A_2\exp{-(\beta-\sqrt{\beta^2-\omega_0^2})t}
\end{eqnarray}
$$

<p>
This solution will also never pass the origin more than once, and then
only if the initial velocity is strong and initially toward zero.

<p>
Given \( b \), \( m \) and \( \omega_0 \), find \( x(t) \) for a particle whose
initial position is \( x=0 \) and has initial velocity \( v_0 \) (assuming an
underdamped solution).

<p>
The solution is of the form,

$$
\begin{eqnarray*}
x&=&e^{-\beta t}\left[A_1\cos(\omega' t)+A_2\sin\omega't\right],\\
\dot{x}&=&-\beta x+\omega'e^{-\beta t}\left[-A_1\sin\omega't+A_2\cos\omega't\right].\\
\omega'&\equiv&\sqrt{\omega_0^2-\beta^2},~~~\beta\equiv b/2m.
\end{eqnarray*}
$$

<p>
From the initial conditions, \( A_1=0 \) because \( x(0)=0 \) and \( \omega'A_2=v_0 \). So 

$$
x=\frac{v_0}{\omega'}e^{-\beta t}\sin\omega't.
$$

<p>
<!-- !split -->

<h2 id="___sec5" class="anchor">Our Sliding Block Code </h2>
Here we study first the case without additional friction term and scale our equation
in terms of a dimensionless time \( \tau \).

<p>
Let us remind ourselves about the differential equation we want to solve (the general case with damping due to friction)
$$
m\frac{d^2x}{dt^2} + b\frac{dx}{dt}+kx(t) =0.
$$

We divide by \( m \) and introduce \( \omega_0^2=\sqrt{k/m} \) and obtain
$$
\frac{d^2x}{dt^2} + \frac{b}{m}\frac{dx}{dt}+\omega_0^2x(t) =0.
$$

<p>
Thereafter we introduce a dimensionless time \( \tau = t\omega_0 \) (check
that the dimensionality is correct) and rewrite our equation as

$$
\frac{d^2x}{d\tau^2} + \frac{b}{m\omega_0^2}\frac{dx}{d\tau}+x(\tau) =0,
$$

which gives us
$$
\frac{d^2x}{d\tau^2} + \frac{b}{m\omega_0}\frac{dx}{d\tau}+x(\tau) =0.
$$

<p>
We then define \( \gamma = b/(2m\omega_0) \) and rewrite our equations as
$$
\frac{d^2x}{d\tau^2} + 2\gamma\frac{dx}{d\tau}+x(\tau) =0.
$$

This is the equation we will code below. The first version employs the Euler-Cromer method.
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># Common imports</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pandas</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">pd</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">os</span>

<span style="color: #408080; font-style: italic"># Where to save the figures and data files</span>
PROJECT_ROOT_DIR <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Results&quot;</span>
FIGURE_ID <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Results/FigureFiles&quot;</span>
DATA_ID <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;DataFiles/&quot;</span>

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>exists(PROJECT_ROOT_DIR):
    os<span style="color: #666666">.</span>mkdir(PROJECT_ROOT_DIR)

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>exists(FIGURE_ID):
    os<span style="color: #666666">.</span>makedirs(FIGURE_ID)

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>exists(DATA_ID):
    os<span style="color: #666666">.</span>makedirs(DATA_ID)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">image_path</span>(fig_id):
    <span style="color: #008000; font-weight: bold">return</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>join(FIGURE_ID, fig_id)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">data_path</span>(dat_id):
    <span style="color: #008000; font-weight: bold">return</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>join(DATA_ID, dat_id)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">save_fig</span>(fig_id):
    plt<span style="color: #666666">.</span>savefig(image_path(fig_id) <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;.png&quot;</span>, format<span style="color: #666666">=</span><span style="color: #BA2121">&#39;png&#39;</span>)


<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">pylab</span> <span style="color: #008000; font-weight: bold">import</span> plt, mpl
plt<span style="color: #666666">.</span>style<span style="color: #666666">.</span>use(<span style="color: #BA2121">&#39;seaborn&#39;</span>)
mpl<span style="color: #666666">.</span>rcParams[<span style="color: #BA2121">&#39;font.family&#39;</span>] <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;serif&#39;</span>

DeltaT <span style="color: #666666">=</span> <span style="color: #666666">0.001</span>
<span style="color: #408080; font-style: italic">#set up arrays </span>
tfinal <span style="color: #666666">=</span> <span style="color: #666666">20</span> <span style="color: #408080; font-style: italic"># in years</span>
n <span style="color: #666666">=</span> ceil(tfinal<span style="color: #666666">/</span>DeltaT)
<span style="color: #408080; font-style: italic"># set up arrays for t, v, and x</span>
t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(n)
v <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(n)
x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(n)
<span style="color: #408080; font-style: italic"># Initial conditions as compact 2-dimensional arrays</span>
x0 <span style="color: #666666">=</span>  <span style="color: #666666">1.0</span> 
v0 <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>
x[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> x0
v[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> v0
gamma <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>
<span style="color: #408080; font-style: italic"># Start integrating using Euler&#39;s method</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(n<span style="color: #666666">-1</span>):
    <span style="color: #408080; font-style: italic"># Set up the acceleration</span>
    <span style="color: #408080; font-style: italic"># Here you could have defined your own function for this</span>
    a <span style="color: #666666">=</span>  <span style="color: #666666">-2*</span>gamma<span style="color: #666666">*</span>v[i]<span style="color: #666666">-</span>x[i]
    <span style="color: #408080; font-style: italic"># update velocity, time and position using Euler&#39;s forward method</span>
    v[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> v[i] <span style="color: #666666">+</span> DeltaT<span style="color: #666666">*</span>a
    x[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> x[i] <span style="color: #666666">+</span> DeltaT<span style="color: #666666">*</span>v[i<span style="color: #666666">+1</span>]
    t[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> t[i] <span style="color: #666666">+</span> DeltaT
<span style="color: #408080; font-style: italic"># Plot position as function of time    </span>
fig, ax <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>subplots()
<span style="color: #408080; font-style: italic">#ax.set_xlim(0, tfinal)</span>
ax<span style="color: #666666">.</span>set_ylabel(<span style="color: #BA2121">&#39;x[m]&#39;</span>)
ax<span style="color: #666666">.</span>set_xlabel(<span style="color: #BA2121">&#39;t[s]&#39;</span>)
ax<span style="color: #666666">.</span>plot(t, x)
fig<span style="color: #666666">.</span>tight_layout()
save_fig(<span style="color: #BA2121">&quot;BlockEulerCromer&quot;</span>)
plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
When setting up the value of \( \gamma \) we see that for \( \gamma=0 \) we get the simple oscillatory motion with no damping.
Choosing \( \gamma < 1 \) leads to the classical underdamped case with oscillatory motion, but where the motion comes to an end.

<p>
Choosing \( \gamma =1 \) leads to what normally is called critical damping and \( \gamma> 1 \) leads to critical overdamping.
Try it out and try also to change the initial position and velocity. Setting \( \gamma=1 \)
yields a situation, as discussed above, where the solution approaches quickly zero and does not oscillate. With zero initial velocity it will never cross zero.

<p>
<!-- !split -->

<h2 id="___sec6" class="anchor">Sinusoidally Driven Oscillators </h2>

<p>
Here, we consider the force

$$
\begin{equation}
F=-kx-b\dot{x}+F_0\cos\omega t,
\label{_auto8}
\end{equation}
$$

<p>
which leads to the differential equation

$$
\begin{equation}
\label{eq:drivenosc}
\ddot{x}+2\beta\dot{x}+\omega_0^2x=(F_0/m)\cos\omega t.
\end{equation}
$$

<p>
Consider a single solution with no arbitrary constants, which we will
call a {\it particular solution}, \( x_p(t) \). It should be emphasized
that this is {\bf A} particular solution, because there exists an
infinite number of such solutions because the general solution should
have two arbitrary constants. Now consider solutions to the same
equation without the driving term, which include two arbitrary
constants. These are called either {\it homogenous solutions} or {\it
complementary solutions}, and were given in the previous section,
e.g. Eq. \eqref{eq:homogsolution} for the underdamped case. The
homogenous solution already incorporates the two arbitrary constants,
so any sum of a homogenous solution and a particular solution will
represent the {\it general solution} of the equation. The general
solution incorporates the two arbitrary constants \( A \) and \( B \) to
accommodate the two initial conditions. One could have picked a
different particular solution, i.e. the original particular solution
plus any homogenous solution with the arbitrary constants \( A_p \) and
\( B_p \) chosen at will. When one adds in the homogenous solution, which
has adjustable constants with arbitrary constants \( A' \) and \( B' \), to
the new particular solution, one can get the same general solution by
simply adjusting the new constants such that \( A'+A_p=A \) and
\( B'+B_p=B \). Thus, the choice of \( A_p \) and \( B_p \) are irrelevant, and
when choosing the particular solution it is best to make the simplest
choice possible.

<p>
To find a particular solution, one first guesses at the form,

$$
\begin{equation}
\label{eq:partform}
x_p(t)=D\cos(\omega t-\delta),
\end{equation}
$$

<p>
and rewrite the differential equation as

$$
\begin{equation}
D\left\{-\omega^2\cos(\omega t-\delta)-2\beta\omega\sin(\omega t-\delta)+\omega_0^2\cos(\omega t-\delta)\right\}=\frac{F_0}{m}\cos(\omega t).
\label{_auto9}
\end{equation}
$$

<p>
One can now use angle addition formulas to get

$$
\begin{eqnarray}
D\left\{(-\omega^2\cos\delta+2\beta\omega\sin\delta+\omega_0^2\cos\delta)\cos(\omega t)\right.&&\\
\nonumber
\left.+(-\omega^2\sin\delta-2\beta\omega\cos\delta+\omega_0^2\sin\delta)\sin(\omega t)\right\}
&=&\frac{F_0}{m}\cos(\omega t).
\end{eqnarray}
$$

<p>
Both the \( \cos \) and \( \sin \) terms need to equate if the expression is to hold at all times. Thus, this becomes two equations

$$
\begin{eqnarray}
D\left\{-\omega^2\cos\delta+2\beta\omega\sin\delta+\omega_0^2\cos\delta\right\}&=&\frac{F_0}{m}\\
\nonumber
-\omega^2\sin\delta-2\beta\omega\cos\delta+\omega_0^2\sin\delta&=&0.
\end{eqnarray}
$$

<p>
After dividing by \( \cos\delta \), the lower expression leads to

$$
\begin{equation}
\tan\delta=\frac{2\beta\omega}{\omega_0^2-\omega^2}.
\label{_auto10}
\end{equation}
$$

<p>
Using the identities \( \tan^2+1=\csc^2 \) and \( \sin^2+\cos\^2=1 \), one can also express \( \sin\delta \) and \( \cos\delta \),

$$
\begin{eqnarray}
\sin\delta&=&\frac{2\beta\omega}{\sqrt{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}},\\
\nonumber
\cos\delta&=&\frac{(\omega_0^2-\omega^2)}{\sqrt{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}}
\end{eqnarray}
$$

<p>
Inserting the expressions for \( \cos\delta \) and \( \sin\delta \) into the expression for \( D \),

$$
\begin{equation}
\label{eq:Ddrive}
D=\frac{F_0/m}{\sqrt{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}}.
\end{equation}
$$

<p>
For a given initial condition, e.g. initial displacement and velocity,
one must add the homogenous solution then solve for the two arbitrary
constants. However, because the homogenous solutions decay with time
as \( e^{-\beta t} \), the particular solution is all that remains at
large times, and is therefore the steady state solution. Because the
arbitrary constants are all in the homogenous solution, all memory of
the initial conditions are lost at large times, \( t>>1/\beta \).

<p>
The amplitude of the motion, \( D \), is linearly proportional to the
driving force (\( F_0/m \)), but also depends on the driving frequency
\( \omega \). For small \( \beta \) the maximum will occur at
\( \omega=\omega_0 \). This is referred to as a resonance. In the limit
\( \beta\rightarrow 0 \) the amplitude at resonance approaches infinity.

<p>
<!-- !split -->

<h2 id="___sec7" class="anchor">Alternative Derivation for Driven Oscillators </h2>

<p>
Here, we derive the same expressions as in Equations \eqref{eq:partform} and \eqref{eq:Ddrive} but express the driving forces as

$$
\begin{eqnarray}
F(t)&=&F_0e^{i\omega t},
\end{eqnarray}
$$

rather than as \( F_0\cos\omega t \). The real part of \( F \) is the same as before. For the differential equation,

$$
\begin{eqnarray}
\label{eq:compdrive}
\ddot{x}+2\beta\dot{x}+\omega_0^2x&=&\frac{F_0}{m}e^{i\omega t},
\end{eqnarray}
$$

<p>
one can treat \( x(t) \) as an imaginary function. Because the operations
\( d^2/dt^2 \) and \( d/dt \) are real and thus do not mix the real and
imaginary parts of \( x(t) \), Eq. \eqref{eq:compdrive} is effectively 2
equations. Because \( e^{\omega t}=\cos\omega t+i\sin\omega t \), the real
part of the solution for \( x(t) \) gives the solution for a driving force
\( F_0\cos\omega t \), and the imaginary part of \( x \) corresponds to the
case where the driving force is \( F_0\sin\omega t \). It is rather easy
to solve for the complex \( x \) in this case, and by taking the real part
of the solution, one finds the answer for the \( \cos\omega t \) driving
force.

<p>
We assume a simple form for the particular solution

$$
\begin{equation}
x_p=De^{i\omega t},
\label{_auto11}
\end{equation}
$$

<p>
where \( D \) is a complex constant.

<p>
From Eq. \eqref{eq:compdrive} one inserts the form for \( x_p \) above to get

$$
\begin{eqnarray}
D\left\{-\omega^2+2i\beta\omega+\omega_0^2\right\}e^{i\omega t}=(F_0/m)e^{i\omega t},\\
\nonumber
D=\frac{F_0/m}{(\omega_0^2-\omega^2)+2i\beta\omega}.
\end{eqnarray}
$$

<p>
The norm and phase for \( D=|D|e^{-i\delta} \) can be read by inspection,

$$
\begin{equation}
|D|=\frac{F_0/m}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}},~~~~\tan\delta=\frac{2\beta\omega}{\omega_0^2-\omega^2}.
\label{_auto12}
\end{equation}
$$

<p>
This is the same expression for \( \delta \) as before. One then finds \( x_p(t) \),

$$
\begin{eqnarray}
\label{eq:fastdriven1}
x_p(t)&=&\Re\frac{(F_0/m)e^{i\omega t-i\delta}}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}\\
\nonumber
&=&\frac{(F_0/m)\cos(\omega t-\delta)}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}.
\end{eqnarray}
$$

This is the same answer as before.
If one wished to solve for the case where \( F(t)= F_0\sin\omega t \), the imaginary part of the solution would work

$$
\begin{eqnarray}
\label{eq:fastdriven2}
x_p(t)&=&\Im\frac{(F_0/m)e^{i\omega t-i\delta}}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}\\
\nonumber
&=&\frac{(F_0/m)\sin(\omega t-\delta)}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}.
\end{eqnarray}
$$

<p>
Consider the damped and driven harmonic oscillator worked out above. Given \( F_0, m,\beta \) and \( \omega_0 \), solve for the complete solution \( x(t) \) for the case where \( F=F_0\sin\omega t \) with initial conditions \( x(t=0)=0 \) and \( v(t=0)=0 \). Assume the underdamped case.

<p>
The general solution including the arbitrary constants includes both the homogenous and particular solutions,

$$
\begin{eqnarray*}
x(t)&=&\frac{F_0}{m}\frac{\sin(\omega t-\delta)}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}
+A\cos\omega't e^{-\beta t}+B\sin\omega't e^{-\beta t}.
\end{eqnarray*}
$$

<p>
The quantities \( \delta \) and \( \omega' \) are given earlier in the
section, \( \omega'=\sqrt{\omega_0^2-\beta^2},
\delta=\tan^{-1}(2\beta\omega/(\omega_0^2-\omega^2) \). Here, solving
the problem means finding the arbitrary constants \( A \) and
\( B \). Satisfying the initial conditions for the initial position and
velocity:

$$
\begin{eqnarray*}
x(t=0)=0&=&-\eta\sin\delta+A,\\
v(t=0)=0&=&\omega\eta\cos\delta-\beta A+\omega'B,\\
\eta&\equiv&\frac{F_0}{m}\frac{1}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}.
\end{eqnarray*}
$$

<p>
The problem is now reduced to 2 equations and 2 unknowns, \( A \) and \( B \). The solution is

$$
\begin{eqnarray}
A&=& \eta\sin\delta ,~~~B=\frac{-\omega\eta\cos\delta+\beta\eta\sin\delta}{\omega'}.
\end{eqnarray}
$$

<h2 id="___sec8" class="anchor">Resonance Widths; the \( Q \) factor </h2>

<p>
From the previous two sections, the particular solution for a driving force, \( F=F_0\cos\omega t \), is

$$
\begin{eqnarray}
x_p(t)&=&\frac{F_0/m}{\sqrt{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}}\cos(\omega_t-\delta),\\
\nonumber
\delta&=&\tan^{-1}\left(\frac{2\beta\omega}{\omega_0^2-\omega^2}\right).
\end{eqnarray}
$$

<p>
If one fixes the driving frequency \( \omega \) and adjusts the
fundamental frequency \( \omega_0=\sqrt{k/m} \), the maximum amplitude
occurs when \( \omega_0=\omega \) because that is when the term from the
denominator \( (\omega_0^2-\omega^2)^2+4\omega^2\beta^2 \) is at a
minimum. This is akin to dialing into a radio station. However, if one
fixes \( \omega_0 \) and adjusts the driving frequency one minimize with
respect to \( \omega \), e.g. set

$$
\begin{equation}
\frac{d}{d\omega}\left[(\omega_0^2-\omega^2)^2+4\omega^2\beta^2\right]=0,
\label{_auto13}
\end{equation}
$$

<p>
and one finds that the maximum amplitude occurs when
\( \omega=\sqrt{\omega_0^2-2\beta^2} \). If \( \beta \) is small relative to
\( \omega_0 \), one can simply state that the maximum amplitude is

$$
\begin{equation}
x_{\rm max}\approx\frac{F_0}{2m\beta \omega_0}.
\label{_auto14}
\end{equation}
$$


$$
\begin{eqnarray}
\frac{4\omega^2\beta^2}{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}=\frac{1}{2}.
\end{eqnarray}
$$

<p>
For small damping this occurs when \( \omega=\omega_0\pm \beta \), so the \( FWHM\approx 2\beta \). For the purposes of tuning to a specific frequency, one wants the width to be as small as possible. The ratio of \( \omega_0 \) to \( FWHM \) is known as the {\it quality} factor, or \( Q \) factor,

$$
\begin{equation}
Q\equiv \frac{\omega_0}{2\beta}.
\label{_auto15}
\end{equation}
$$

<p>
<!-- !split  -->

<h2 id="___sec9" class="anchor">Principle of Superposition and Periodic Forces (Fourier Transforms) </h2>

<p>
If one has several driving forces, \( F(t)=\sum_n F_n(t) \), one can find
the particular solution to each \( F_n \), \( x_{pn}(t) \), and the particular
solution for the entire driving force is

$$
\begin{equation}
x_p(t)=\sum_nx_{pn}(t).
\label{_auto16}
\end{equation}
$$

<p>
This is known as the principal of superposition. It only applies when
the homogenous equation is linear. If there were an anharmonic term
such as \( x^3 \) in the homogenous equation, then when one summed various
solutions, \( x=(\sum_n x_n)^2 \), one would get cross
terms. Superposition is especially useful when \( F(t) \) can be written
as a sum of sinusoidal terms, because the solutions for each
sinusoidal term is analytic, and are given in the previous two
subsections.

<p>
Driving forces are often periodic, even when they are not
sinusoidal. Periodicity implies that for some time \( \tau \)

$$
\begin{eqnarray}
F(t+\tau)=F(t). 
\end{eqnarray}
$$

<p>
One example of a non-sinusoidal periodic force is a square wave. Many
components in electric circuits are non-linear, e.g. diodes, which
makes many wave forms non-sinusoidal even when the circuits are being
driven by purely sinusoidal sources.

<p>
For the sinusoidal example studied in the previous subsections the
period is \( \tau=2\pi/\omega \). However, higher harmonics can also
satisfy the periodicity requirement. In general, any force that
satisfies the periodicity requirement can be expressed as a sum over
harmonics,

$$
\begin{equation}
F(t)=\frac{f_0}{2}+\sum_{n>0} f_n\cos(2n\pi t/\tau)+g_n\sin(2n\pi t/\tau).
\label{_auto17}
\end{equation}
$$

<p>
From the previous subsection, one can write down the answer for
\( x_{pn}(t) \), by substituting \( f_n/m \) or \( g_n/m \) for \( F_0/m \) into Eq.s
\eqref{eq:fastdriven1} or \eqref{eq:fastdriven2} respectively. By
writing each factor \( 2n\pi t/\tau \) as \( n\omega t \), with \( \omega\equiv
2\pi/\tau \),

$$
\begin{equation}
\label{eq:fourierdef1}
F(t)=\frac{f_0}{2}+\sum_{n>0}f_n\cos(n\omega t)+g_n\sin(n\omega t).
\end{equation}
$$

<p>
The solutions for \( x(t) \) then come from replacing \( \omega \) with
\( n\omega \) for each term in the particular solution in Equations
\eqref{eq:partform} and \eqref{eq:Ddrive},

$$
\begin{eqnarray}
x_p(t)&=&\frac{f_0}{2k}+\sum_{n>0} \alpha_n\cos(n\omega t-\delta_n)+\beta_n\sin(n\omega t-\delta_n),\\
\nonumber
\alpha_n&=&\frac{f_n/m}{\sqrt{((n\omega)^2-\omega_0^2)+4\beta^2n^2\omega^2}},\\
\nonumber
\beta_n&=&\frac{g_n/m}{\sqrt{((n\omega)^2-\omega_0^2)+4\beta^2n^2\omega^2}},\\
\nonumber
\delta_n&=&\tan^{-1}\left(\frac{2\beta n\omega}{\omega_0^2-n^2\omega^2}\right).
\end{eqnarray}
$$

<p>
Because the forces have been applied for a long time, any non-zero
damping eliminates the homogenous parts of the solution, so one need
only consider the particular solution for each \( n \).

<p>
The problem will considered solved if one can find expressions for the
coefficients \( f_n \) and \( g_n \), even though the solutions are expressed
as an infinite sum. The coefficients can be extracted from the
function \( F(t) \) by

$$
\begin{eqnarray}
\label{eq:fourierdef2}
f_n&=&\frac{2}{\tau}\int_{-\tau/2}^{\tau/2} dt~F(t)\cos(2n\pi t/\tau),\\
\nonumber
g_n&=&\frac{2}{\tau}\int_{-\tau/2}^{\tau/2} dt~F(t)\sin(2n\pi t/\tau).
\end{eqnarray}
$$

<p>
To check the consistency of these expressions and to verify
Eq. \eqref{eq:fourierdef2}, one can insert the expansion of \( F(t) \) in
Eq. \eqref{eq:fourierdef1} into the expression for the coefficients in
Eq. \eqref{eq:fourierdef2} and see whether

$$
\begin{eqnarray}
f_n&=?&\frac{2}{\tau}\int_{-\tau/2}^{\tau/2} dt~\left\{
\frac{f_0}{2}+\sum_{m>0}f_m\cos(m\omega t)+g_m\sin(m\omega t)
\right\}\cos(n\omega t).
\end{eqnarray}
$$

<p>
Immediately, one can throw away all the terms with \( g_m \) because they
convolute an even and an odd function. The term with \( f_0/2 \)
disappears because \( \cos(n\omega t) \) is equally positive and negative
over the interval and will integrate to zero. For all the terms
\( f_m\cos(m\omega t) \) appearing in the sum, one can use angle addition
formulas to see that \( \cos(m\omega t)\cos(n\omega
t)=(1/2)(\cos[(m+n)\omega t]+\cos[(m-n)\omega t] \). This will integrate
to zero unless \( m=n \). In that case the \( m=n \) term gives

$$
\begin{equation}
\int_{-\tau/2}^{\tau/2}dt~\cos^2(m\omega t)=\frac{\tau}{2},
\label{_auto18}
\end{equation}
$$

<p>
and

$$
\begin{eqnarray}
f_n&=?&\frac{2}{\tau}\int_{-\tau/2}^{\tau/2} dt~f_n/2\\
\nonumber
&=&f_n~\checkmark.
\end{eqnarray}
$$

<p>
The same method can be used to check for the consistency of \( g_n \).

<p>
Consider the driving force:

$$
\begin{equation}
F(t)=At/\tau,~~-\tau/2 < t < \tau/2,~~~F(t+\tau)=F(t).
\label{_auto19}
\end{equation}
$$

<p>
Find the Fourier coefficients \( f_n \) and \( g_n \) for all \( n \) using Eq. \eqref{eq:fourierdef2}.

<p>
Only the odd coefficients enter by symmetry, i.e. \( f_n=0 \). One can find \( g_n \) integrating by parts,

$$
\begin{eqnarray}
\label{eq:fouriersolution}
g_n&=&\frac{2}{\tau}\int_{-\tau/2}^{\tau/2}dt~\sin(n\omega t) \frac{At}{\tau}\\
\nonumber
u&=&t,~dv=\sin(n\omega t)dt,~v=-\cos(n\omega t)/(n\omega),\\
\nonumber
g_n&=&\frac{-2A}{n\omega \tau^2}\int_{-\tau/2}^{\tau/2}dt~\cos(n\omega t)
+\left.2A\frac{-t\cos(n\omega t)}{n\omega\tau^2}\right|_{-\tau/2}^{\tau/2}.
\end{eqnarray}
$$

<p>
The first term is zero because \( \cos(n\omega t) \) will be equally
positive and negative over the interval. Using the fact that
\( \omega\tau=2\pi \),

$$
\begin{eqnarray}
g_n&=&-\frac{2A}{2n\pi}\cos(n\omega\tau/2)\\
\nonumber
&=&-\frac{A}{n\pi}\cos(n\pi)\\
\nonumber
&=&\frac{A}{n\pi}(-1)^{n+1}.
\end{eqnarray}
$$

<p>
<!-- !split -->

<h2 id="___sec10" class="anchor">Response to Transient Force </h2>

<p>
Consider a particle at rest in the bottom of an underdamped harmonic
oscillator, that then feels a sudden impulse, or change in momentum,
\( I=F\Delta t \) at \( t=0 \). This increases the velocity immediately by an
amount \( v_0=I/m \) while not changing the position. One can then solve
the trajectory by solving Eq. \eqref{eq:homogsolution} with initial
conditions \( v_0=I/m \) and \( x_0=0 \). This gives

$$
\begin{equation}
x(t)=\frac{I}{m\omega'}e^{-\beta t}\sin\omega't, ~~t>0.
\label{_auto20}
\end{equation}
$$

<p>
Here, \( \omega'=\sqrt{\omega_0^2-\beta^2} \). For an impulse \( I_i \) that
occurs at time \( t_i \) the trajectory would be

$$
\begin{equation}
x(t)=\frac{I_i}{m\omega'}e^{-\beta (t-t_i)}\sin[\omega'(t-t_i)] \Theta(t-t_i),
\label{_auto21}
\end{equation}
$$

<p>
where \( \Theta(t-t_i) \) is a step function, i.e. \( \Theta(x) \) is zero for
\( x < 0 \) and unity for \( x>0 \). If there were several impulses linear
superposition tells us that we can sum over each contribution,

$$
\begin{equation}
x(t)=\sum_i\frac{I_i}{m\omega'}e^{-\beta(t-t_i)}\sin[\omega'(t-t_i)]\Theta(t-t_i)
\label{_auto22}
\end{equation} 
$$

<p>
Now one can consider a series of impulses at times separated by
\( \Delta t \), where each impulse is given by \( F_i\Delta t \). The sum
above now becomes an integral,

$$
\begin{eqnarray}label{eq:Greeny}
x(t)&=&\int_{-\infty}^\infty dt'~F(t')\frac{e^{-\beta(t-t')}\sin[\omega'(t-t')]}{m\omega'}\Theta(t-t')\\
\nonumber
&=&\int_{-\infty}^\infty dt'~F(t')G(t-t'),\\
\nonumber
G(\Delta t)&=&\frac{e^{-\beta\Delta t}\sin[\omega' \Delta t]}{m\omega'}\Theta(\Delta t)
\end{eqnarray}
$$

<p>
The quantity
\( e^{-\beta(t-t')}\sin[\omega'(t-t')]/m\omega'\Theta(t-t') \) is called a
Green's function, \( G(t-t') \). It describes the response at \( t \) due to a
force applied at a time \( t' \), and is a function of \( t-t' \). The step
function ensures that the response does not occur before the force is
applied. One should remember that the form for \( G \) would change if the
oscillator were either critically- or over-damped.

<p>
When performing the integral in Eq. \eqref{eq:Greeny} one can use
angle addition formulas to factor out the part with the \( t' \)
dependence in the integrand,

$$
\begin{eqnarray}
\label{eq:Greeny2}
x(t)&=&\frac{1}{m\omega'}e^{-\beta t}\left[I_c(t)\sin(\omega't)-I_s(t)\cos(\omega't)\right],\\
\nonumber
I_c(t)&\equiv&\int_{-\infty}^t dt'~F(t')e^{\beta t'}\cos(\omega't'),\\
\nonumber
I_s(t)&\equiv&\int_{-\infty}^t dt'~F(t')e^{\beta t'}\sin(\omega't').
\end{eqnarray}
$$

<p>
If the time \( t \) is beyond any time at which the force acts,
\( F(t'>t)=0 \), the coefficients \( I_c \) and \( I_s \) become independent of
\( t \).

<p>
Consider an undamped oscillator (\( \beta\rightarrow 0 \)), with
characteristic frequency \( \omega_0 \) and mass \( m \), that is at rest
until it feels a force described by a Gaussian form,

$$
\begin{eqnarray*}
F(t)&=&F_0 \exp\left\{\frac{-t^2}{2\tau^2}\right\}.
\end{eqnarray*}
$$

<p>
For large times (\( t>>\tau \)), where the force has died off, find
\( x(t) \).\\ Solve for the coefficients \( I_c \) and \( I_s \) in
Eq. \eqref{eq:Greeny2}. Because the Gaussian is an even function,
\( I_s=0 \), and one need only solve for \( I_c \),

$$
\begin{eqnarray*}
I_c&=&F_0\int_{-\infty}^\infty dt'~e^{-t^{\prime 2}/(2\tau^2)}\cos(\omega_0 t')\\
&=&\Re F_0 \int_{-\infty}^\infty dt'~e^{-t^{\prime 2}/(2\tau^2)}e^{i\omega_0 t'}\\
&=&\Re F_0 \int_{-\infty}^\infty dt'~e^{-(t'-i\omega_0\tau^2)^2/(2\tau^2)}e^{-\omega_0^2\tau^2/2}\\
&=&F_0\tau \sqrt{2\pi} e^{-\omega_0^2\tau^2/2}.
\end{eqnarray*}
$$

<p>
The third step involved completing the square, and the final step used the fact that the integral

$$
\begin{eqnarray*}
\int_{-\infty}^\infty dx~e^{-x^2/2}&=&\sqrt{2\pi}.
\end{eqnarray*}
$$

<p>
To see that this integral is true, consider the square of the integral, which you can change to polar coordinates,

$$
\begin{eqnarray*}
I&=&\int_{-\infty}^\infty dx~e^{-x^2/2}\\
I^2&=&\int_{-\infty}^\infty dxdy~e^{-(x^2+y^2)/2}\\
&=&2\pi\int_0^\infty rdr~e^{-r^2/2}\\
&=&2\pi.
\end{eqnarray*}
$$

<p>
Finally, the expression for \( x \) from Eq. \eqref{eq:Greeny2} is

$$
\begin{eqnarray*}
x(t>>\tau)&=&\frac{F_0\tau}{m\omega_0} \sqrt{2\pi} e^{-\omega_0^2\tau^2/2}\sin(\omega_0t).
\end{eqnarray*}
$$

<p>
<!-- !split -->

<h2 id="___sec11" class="anchor">Sliding Block tied to a Wall </h2>
<div class="panel panel-default">
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
Another classical case is that of simple harmonic oscillations, here represented by a block sliding on a horizontal frictionless surface. The block is tied to a wall with a spring. If the spring is not compressed or stretched too far, the force on the block at a given position \( x \) is 
$$
      F=-kx.
  $$

The negative sign means that the force acts to restore the object to an equilibrium position. Newton's equation of motion for this idealized system is then 
$$
    m\frac{d^2x}{dt^2}=-kx,
  $$

or we could rephrase it as
$$
   \frac{d^2x}{dt^2}=-\frac{k}{m}x=-\omega_0^2x,
\label{eq:newton1}
  $$

with the angular frequency \( \omega_0^2=k/m \).

<p>
The above differential equation has the advantage that it can be solved  analytically with solutions on the form
$$
     x(t)=Acos(\omega_0t+\nu),
  $$

where \( A \) is the amplitude and \( \nu \) the phase constant.   This provides in turn an important test for the numerical
solution and the development of a program for more complicated cases which cannot be solved analytically.
</div>
</div>


<p>
<!-- !split -->

<h2 id="___sec12" class="anchor">Simple Example, Block tied to a Wall </h2>

<p>
With the position \( x(t) \) and the velocity  \( v(t)=dx/dt \) we can reformulate Newton's equation in the following way
$$
      \frac{dx(t)}{dt}=v(t),
  $$

  and
$$
      \frac{dv(t)}{dt}=-\omega_0^2x(t).
  $$

  We are now going to solve these equations using first the standard forward Euler  method. Later we will try to improve upon this.

<p>
<!-- !split -->

<h2 id="___sec13" class="anchor">Simple Example, Block tied to a Wall </h2>

<p>
Before proceeding however, it is important to note that in addition to the exact solution, we have at least two further tests which can be used to check our solution.

<p>
Since functions like \( cos \) are periodic with a period \( 2\pi \), then the solution \( x(t) \) has also to be periodic. This means that
$$
     x(t+T)=x(t),
$$

with \( T \) the period defined as 
$$
     T=\frac{2\pi}{\omega_0}=\frac{2\pi}{\sqrt{k/m}}.
$$

Observe that \( T \) depends only on \( k/m \) and not on the amplitude of the solution.

<p>
<!-- !split -->

<h2 id="___sec14" class="anchor">Simple Example, Block tied to a Wall </h2>

<p>
In addition to the periodicity test, the total energy has also to be conserved.

<p>
Suppose we choose the initial conditions 
$$
     x(t=0)=1\hspace{0.1cm} \mathrm{m}\hspace{1cm} v(t=0)=0\hspace{0.1cm}\mathrm{m/s},
$$

meaning that block is at rest at \( t=0 \) but with a potential energy
$$
    E_0=\frac{1}{2}kx(t=0)^2=\frac{1}{2}k.
$$

The total energy at any time \( t \) has however to be conserved, meaning that our solution has to fulfil the condition
$$
    E_0=\frac{1}{2}kx(t)^2+\frac{1}{2}mv(t)^2.
$$

<p>
<!-- !split -->

<h2 id="___sec15" class="anchor">Simple Example, Block tied to a Wall </h2>

<p>
An algorithm which implements these equations is included below.

<ul>
 <li> Choose the initial position and speed, with the most common choice \( v(t=0)=0 \) and some fixed value for the position.</li> 
 <li> Choose the method you wish to employ in solving the problem.</li>
 <li> Subdivide the time interval \( [t_i,t_f]  \) into a grid with step size</li>
</ul>

$$
	  h=\frac{t_f-t_i}{N},
      $$

where \( N \) is the number of mesh points. 

<ul>
 <li> Calculate now the total energy given by</li> 
</ul>

$$
    E_0=\frac{1}{2}kx(t=0)^2=\frac{1}{2}k.
  $$


<ul>
 <li> Choose ODE solver to obtain \( x_{i+1} \) and \( v_{i+1} \) starting from the previous values \( x_i \) and \( v_i \).</li>
 <li> When we have computed \( x(v)_{i+1} \) we upgrade  \( t_{i+1}=t_i+h \).</li>
 <li> This iterative  process continues till we reach the maximum time \( t_f \).</li>
 <li> The results are checked against the exact solution. Furthermore, one has to check the stability of the numerical solution against the chosen number of mesh points \( N \).</li>      
</ul>

<!-- !split -->

<h2 id="___sec16" class="anchor">Simple Example, Block tied to a Wall, python code </h2>

<p>
The following python program performs essentially the same calculations as the previous c++ code.
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic">#</span>
<span style="color: #408080; font-style: italic"># This program solves Newtons equation for a block sliding on</span>
<span style="color: #408080; font-style: italic"># an horizontal frictionless surface.</span>
<span style="color: #408080; font-style: italic"># The block is tied to the wall with a spring, so N&#39;s eq takes the form:</span>
<span style="color: #408080; font-style: italic">#</span>
<span style="color: #408080; font-style: italic">#  m d^2x/dt^2 = - kx</span>
<span style="color: #408080; font-style: italic">#</span>
<span style="color: #408080; font-style: italic"># In order to make the solution dimless, we set k/m = 1.</span>
<span style="color: #408080; font-style: italic"># This results in two coupled diff. eq&#39;s that may be written as:</span>
<span style="color: #408080; font-style: italic">#</span>
<span style="color: #408080; font-style: italic">#  dx/dt = v</span>
<span style="color: #408080; font-style: italic">#  dv/dt = -x</span>
<span style="color: #408080; font-style: italic">#</span>
<span style="color: #408080; font-style: italic"># The user has to specify the initial velocity and position,</span>
<span style="color: #408080; font-style: italic"># and the number of steps. The time interval is fixed to</span>
<span style="color: #408080; font-style: italic"># t \in [0, 4\pi) (two periods)</span>
<span style="color: #408080; font-style: italic">#</span>
<span style="color: #408080; font-style: italic"># Note that this is a highly simplifyed rk4 code, intended</span>
<span style="color: #408080; font-style: italic"># for conceptual understanding and experimentation.</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sys</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">math</span>

<span style="color: #408080; font-style: italic">#Global variables</span>
ofile <span style="color: #666666">=</span> <span style="color: #008000">None</span>;
E0    <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">sim</span>(x_0, v_0, N):
    ts <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>
    te <span style="color: #666666">=</span> <span style="color: #666666">4*</span>math<span style="color: #666666">.</span>pi
    h <span style="color: #666666">=</span> (te<span style="color: #666666">-</span>ts)<span style="color: #666666">/</span><span style="color: #008000">float</span>(N)

    t <span style="color: #666666">=</span> ts;
    x <span style="color: #666666">=</span> x_0
    v <span style="color: #666666">=</span> v_0
    <span style="color: #008000; font-weight: bold">while</span> (t <span style="color: #666666">&lt;</span> te):
        kv1 <span style="color: #666666">=</span> <span style="color: #666666">-</span>h<span style="color: #666666">*</span>x
        kx1 <span style="color: #666666">=</span> h<span style="color: #666666">*</span>v

        kv2 <span style="color: #666666">=</span> <span style="color: #666666">-</span>h<span style="color: #666666">*</span>(x<span style="color: #666666">+</span>kx1<span style="color: #666666">/2</span>)
        kx2 <span style="color: #666666">=</span>  h<span style="color: #666666">*</span>(v<span style="color: #666666">+</span>kv1<span style="color: #666666">/2</span>)

        kv3 <span style="color: #666666">=</span> <span style="color: #666666">-</span>h<span style="color: #666666">*</span>(x<span style="color: #666666">+</span>kx2<span style="color: #666666">/2</span>)
        kx3 <span style="color: #666666">=</span>  h<span style="color: #666666">*</span>(v<span style="color: #666666">+</span>kv2<span style="color: #666666">/2</span>)

        kv4 <span style="color: #666666">=</span> <span style="color: #666666">-</span>h<span style="color: #666666">*</span>(x<span style="color: #666666">+</span>kx3<span style="color: #666666">/2</span>)
        kx4 <span style="color: #666666">=</span>  h<span style="color: #666666">*</span>(v<span style="color: #666666">+</span>kv3<span style="color: #666666">/2</span>)

        <span style="color: #408080; font-style: italic">#Write the old values to file</span>
        output(t,x,v)

        <span style="color: #408080; font-style: italic">#Update</span>
        x <span style="color: #666666">=</span> x <span style="color: #666666">+</span> (kx1 <span style="color: #666666">+</span> <span style="color: #666666">2*</span>(kx2<span style="color: #666666">+</span>kx3) <span style="color: #666666">+</span> kx4)<span style="color: #666666">/6</span>
        v <span style="color: #666666">=</span> v <span style="color: #666666">+</span> (kv1 <span style="color: #666666">+</span> <span style="color: #666666">2*</span>(kv2<span style="color: #666666">+</span>kv3) <span style="color: #666666">+</span> kv4)<span style="color: #666666">/6</span>
        t <span style="color: #666666">=</span> t<span style="color: #666666">+</span>h
        
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">output</span>(t,x,v):
    de <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>x<span style="color: #666666">**2+0.5*</span>v<span style="color: #666666">**2</span> <span style="color: #666666">-</span> E0;
    ofile<span style="color: #666666">.</span>write(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">%15.8E</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%15.8E</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%15.8E</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%15.8E</span><span style="color: #BA2121"> </span><span style="color: #BB6688; font-weight: bold">%15.8E</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span>\
                <span style="color: #666666">%</span>(t, x, v, math<span style="color: #666666">.</span>cos(t),de));


<span style="color: #408080; font-style: italic">#MAIN PROGRAM:</span>

<span style="color: #408080; font-style: italic">#Get input</span>
<span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">len</span>(sys<span style="color: #666666">.</span>argv) <span style="color: #666666">==</span> <span style="color: #666666">5</span>:
    ofilename <span style="color: #666666">=</span>       sys<span style="color: #666666">.</span>argv[<span style="color: #666666">1</span>];
    x_0       <span style="color: #666666">=</span> <span style="color: #008000">float</span>(sys<span style="color: #666666">.</span>argv[<span style="color: #666666">2</span>])
    v_0       <span style="color: #666666">=</span> <span style="color: #008000">float</span>(sys<span style="color: #666666">.</span>argv[<span style="color: #666666">3</span>])
    N         <span style="color: #666666">=</span>   <span style="color: #008000">int</span>(sys<span style="color: #666666">.</span>argv[<span style="color: #666666">4</span>])
<span style="color: #008000; font-weight: bold">else</span>:
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;Usage:&quot;</span>, sys<span style="color: #666666">.</span>argv[<span style="color: #666666">0</span>], <span style="color: #BA2121">&quot;ofilename x0 v0 N&quot;</span>
    sys<span style="color: #666666">.</span>exit(<span style="color: #666666">0</span>)

<span style="color: #408080; font-style: italic">#Setup</span>
ofile <span style="color: #666666">=</span> <span style="color: #008000">open</span>(ofilename, <span style="color: #BA2121">&#39;w&#39;</span>)
E0    <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>x_0<span style="color: #666666">**2+0.5*</span>v_0<span style="color: #666666">**2</span>

<span style="color: #408080; font-style: italic">#Run simulation</span>
sim(x_0,v_0,N)

<span style="color: #408080; font-style: italic">#Cleanup</span>
ofile<span style="color: #666666">.</span>close() 
</pre></div>
<p>
<!-- !split -->

<h2 id="___sec17" class="anchor">The classical pendulum and scaling the equations </h2>

<p>
The angular equation of motion of the pendulum is given by
Newton's equation and with no external force it reads 
$$
\begin{equation}
  ml\frac{d^2\theta}{dt^2}+mgsin(\theta)=0,
\label{_auto23}
\end{equation}
$$

with an angular velocity and acceleration given by
$$
\begin{equation}
     v=l\frac{d\theta}{dt},
\label{_auto24}
\end{equation}
$$

and 
$$
\begin{equation}
     a=l\frac{d^2\theta}{dt^2}.
\label{_auto25}
\end{equation}
$$

<p>
<!-- !split -->

<h2 id="___sec18" class="anchor">More on the Pendulum </h2>

<p>
We do however expect that the motion will gradually come to an end due a viscous drag torque acting on the pendulum. 
In the presence of the drag, the above equation becomes
$$
\begin{equation}
   ml\frac{d^2\theta}{dt^2}+\nu\frac{d\theta}{dt}  +mgsin(\theta)=0, \label{eq:pend1}
\end{equation}
$$

where \( \nu \) is now a positive constant parameterizing the viscosity
of the medium in question. In order to maintain the motion against
viscosity, it is necessary to add some external driving force. 
We choose here a periodic driving force. The last equation becomes then
$$
\begin{equation}
   ml\frac{d^2\theta}{dt^2}+\nu\frac{d\theta}{dt}  +mgsin(\theta)=Asin(\omega t), \label{eq:pend2}
\end{equation}
$$

with \( A \) and \( \omega \) two constants representing the amplitude and 
the angular frequency respectively. The latter is called the driving frequency.

<p>
<!-- !split -->

<h2 id="___sec19" class="anchor">More on the Pendulum </h2>

<p>
We define 
$$
      \omega_0=\sqrt{g/l},
  $$

the so-called natural frequency and the new dimensionless quantities
$$
      \hat{t}=\omega_0t,
  $$

with the dimensionless driving frequency
$$
     \hat{\omega}=\frac{\omega}{\omega_0},
  $$

and introducing the quantity \( Q \), called the <em>quality factor</em>,
$$
     Q=\frac{mg}{\omega_0\nu},
  $$

  and the dimensionless amplitude 
$$
\hat{A}=\frac{A}{mg}
  $$

<p>
<!-- !split -->

<h2 id="___sec20" class="anchor">More on the Pendulum </h2>

<p>
We have 
$$
    \frac{d^2\theta}{d\hat{t}^2}+\frac{1}{Q}\frac{d\theta}{d\hat{t}}  
     +sin(\theta)=\hat{A}cos(\hat{\omega}\hat{t}).
$$

This equation can in turn be recast in terms of two coupled first-order differential equations as follows
$$
     \frac{d\theta}{d\hat{t}}=\hat{v},
$$

and
$$
     \frac{d\hat{v}}{d\hat{t}}=-\frac{\hat{v}}{Q}-sin(\theta)+\hat{A}cos(\hat{\omega}\hat{t}).
$$

These are the equations to be solved.  The factor \( Q \) represents the number of oscillations of the undriven system that must occur before  its energy is significantly reduced due to the viscous drag. The  amplitude \( \hat{A} \) is measured in units of the maximum possible  gravitational torque while \( \hat{\omega} \) is the angular frequency of the external torque measured in units of the pendulum's natural frequency.

<p>

<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright --> &copy; 1999-2020, "Morten Hjorth-Jensen":"http://mhjgit.github.io/info/doc/web/". Released under CC Attribution-NonCommercial 4.0 license
</center>


</body>
</html>
    


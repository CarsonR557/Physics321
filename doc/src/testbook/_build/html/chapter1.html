

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PHY321: Introduction to Classical Mechanics and plans for Spring 2020 &#8212; Classical mechanics</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Classical mechanics</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   PHY321, Classical Mechanics I, Michigan State University, Spring 2021 (to be modified, new material ready by December 30)
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Simple Motion and Forces
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter2.html">
   1. PHY321: Review of Vectors, Math and first Numerical Examples for simple Motion Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter2.html#space-time-motion-reference-frames-and-reminder-on-vectors-and-other-mathematical-quantities">
   2. Space, Time, Motion, Reference Frames  and Reminder on vectors and other mathematical quantities
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Conservation Laws
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter3.html">
   1. PHY321: Forces, Newton’s Laws and Motion Example
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter3.html#basic-steps-of-scientific-investigations">
   2. Basic Steps of Scientific Investigations
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/chapter1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            
        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <!-- dom:TITLE: PHY321: Introduction to Classical Mechanics and plans for Spring 2020 -->
<div class="section" id="phy321-introduction-to-classical-mechanics-and-plans-for-spring-2020">
<h1>PHY321: Introduction to Classical Mechanics and plans for Spring 2020<a class="headerlink" href="#phy321-introduction-to-classical-mechanics-and-plans-for-spring-2020" title="Permalink to this headline">¶</a></h1>
<!-- dom:AUTHOR: [Morten Hjorth-Jensen](http://mhjgit.github.io/info/doc/web/) at Department of Physics and Astronomy and National Superconducting Cyclotron Laboratory, Michigan State University, USA & Department of Physics, University of Oslo, Norway -->
<!-- Author: -->  
<p><strong><a class="reference external" href="http://mhjgit.github.io/info/doc/web/">Morten Hjorth-Jensen</a></strong>, Department of Physics and Astronomy and National Superconducting Cyclotron Laboratory, Michigan State University, USA and Department of Physics, University of Oslo, Norway</p>
<!-- dom:AUTHOR: [Scott Pratt](https://pa.msu.edu/profile/pratts/) at Department of Physics and Astronomy and National Superconducting Cyclotron Laboratory, Michigan State University, USA -->
<!-- Author: --> **[Scott Pratt](https://pa.msu.edu/profile/pratts/)**, Department of Physics and Astronomy and National Superconducting Cyclotron Laboratory, Michigan State University, USA  
<!-- dom:AUTHOR: [Carl Schmidt](https://pa.msu.edu/profile/schmidt/) at Department of Physics and Astronomy, Michigan State University, USA -->
<!-- Author: --> **[Carl Schmidt](https://pa.msu.edu/profile/schmidt/)**, Department of Physics and Astronomy, Michigan State University, USA
<p>Date: <strong>Dec 16, 2020</strong></p>
<p>Copyright 1999-2020, <a class="reference external" href="http://mhjgit.github.io/info/doc/web/">Morten Hjorth-Jensen</a>. Released under CC Attribution-NonCommercial 4.0 license</p>
</div>
<div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>Classical mechanics is a topic which has been taught intensively over
several centuries. It is, with its many variants and ways of
presenting the educational material, normally the first <strong>real</strong> physics
course many of us meet and it lays the foundation for further physics
studies. Many of the equations and ways of reasoning about the
underlying laws of motion and pertinent forces, shape our approaches and understanding
of the scientific method and discourse, as well as the way we develop our insights
and deeper understanding about physical systems.</p>
<p>There is a wealth of
well-tested (from both a physics point of view and a pedagogical
standpoint) exercises and problems which can be solved
analytically. However, many of these problems represent idealized and
less realistic situations.  The large majority of these problems are
solved by paper and pencil and are traditionally aimed
at what we normally refer to as continuous models from which we may find an analytical solution.  As a consequence,
when teaching mechanics, it implies that we can seldomly venture beyond an idealized case
in order to develop our understandings and insights about the
underlying forces and laws of motion.</p>
<p>On the other hand, numerical algorithms call for approximate discrete
models and much of the development of methods for continuous models
are nowadays being replaced by methods for discrete models in science and
industry, simply because <strong>much larger classes of problems can be addressed</strong> with discrete models, often  by simpler and more
generic methodologies.</p>
<p>As we will see below, when properly scaling the equations at hand,
discrete models open up for more advanced abstractions and the possibility to
study  real life systems, with the added bonus that we can explore and
deepen our basic understanding of various physical systems</p>
<p>Analytical solutions are as important as before. In addition, such
solutions provide us with invaluable benchmarks and tests for our
discrete models. Such benchmarks, as we will see below, allow us
to discuss possible sources of errors and their behaviors.  And
finally, since most of our models are based on various algorithms from
numerical mathematics, we have a unique oppotunity to gain a deeper
understanding of the mathematical approaches we are using.</p>
<p>With computing and data science as important elements in essentially
all aspects of a modern society, we could  then try to define Computing as
<strong>solving scientific problems using all possible tools, including
symbolic computing, computers and numerical algorithms, and analytical
paper and pencil solutions</strong>.
Computing provides us with the tools to develope our own understanding of the scientific method by enhancing algorithmic thinking.</p>
<p>The way we will teach this course reflects
this definition of computing. The course contains both classical paper
and pencil exercises as well as  computational projects and exercises. The
hope is that this will allow you to explore the physics of systems
governed by the degrees of freedom of classical mechanics at a deeper
level, and that these insights about the scientific method will help
you to develop a better understanding of how the underlying forces and
equations of motion and how they impact a given system. Furthermore, by introducing various numerical methods
via computational projects and exercises, we aim at developing your competences and skills about these topics.</p>
<p>These competences will enable you to</p>
<ul class="simple">
<li><p>understand how algorithms are used to solve mathematical problems,</p></li>
<li><p>derive, verify, and implement algorithms,</p></li>
<li><p>understand what can go wrong with algorithms,</p></li>
<li><p>use these algorithms to construct reproducible scientific outcomes and to engage in science in ethical ways, and</p></li>
<li><p>think algorithmically for the purposes of gaining deeper insights about scientific problems.</p></li>
</ul>
<p>All these elements are central for maturing and gaining a better understanding of the modern scientific process <em>per se</em>.</p>
<p>The power of the scientific method lies in identifying a given problem
as a special case of an abstract class of problems, identifying
general solution methods for this class of problems, and applying a
general method to the specific problem (applying means, in the case of
computing, calculations by pen and paper, symbolic computing, or
numerical computing by ready-made and/or self-written software). This
generic view on problems and methods is particularly important for
understanding how to apply available, generic software to solve a
particular problem.</p>
<p><em>However, verification of algorithms and understanding their limitations requires much of the classical knowledge about continuous models.</em></p>
<div class="section" id="a-well-known-examples-to-illustrate-many-of-the-above-concepts">
<h2>A well-known examples to illustrate many of the above concepts<a class="headerlink" href="#a-well-known-examples-to-illustrate-many-of-the-above-concepts" title="Permalink to this headline">¶</a></h2>
<p>Before we venture into a reminder on Python and mechanics relevant applications, let us briefly outline some of the
abovementioned topics using an example many of you may have seen before in for example CMSE201.
A simple algorithm for integration is the Trapezoidal rule.
Integration of a function <span class="math notranslate nohighlight">\(f(x)\)</span> by the Trapezoidal Rule is given by following algorithm for an interval <span class="math notranslate nohighlight">\(x \in [a,b]\)</span></p>
<div class="math notranslate nohighlight">
\[
\int_a^b(f(x) dx = \frac{1}{2}\left [f(a)+2f(a+h)+\dots+2f(b-h)+f(b)\right] +O(h^2),
\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is the so-called stepsize defined by the number of integration points <span class="math notranslate nohighlight">\(N\)</span> as <span class="math notranslate nohighlight">\(h=(b-a)/(n)\)</span>.
Python offers an  extremely versatile programming  environment, allowing for
the inclusion of analytical studies in a numerical program. Here we show an
example code with the <strong>trapezoidal rule</strong>. We use also <strong>SymPy</strong> to evaluate the exact value of the integral and compute the absolute error
with respect to the numerically evaluated one of the integral
<span class="math notranslate nohighlight">\(\int_0^1 dx x^2 = 1/3\)</span>.
The following code for  the trapezoidal rule allows you  to plot the relative error by comparing with the exact result. By increasing to <span class="math notranslate nohighlight">\(10^8\)</span> points one arrives at a region where numerical errors start to accumulate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log10</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">integrate</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># function for the trapezoidal rule</span>
<span class="k">def</span> <span class="nf">Trapez</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
   <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="n">x</span> <span class="o">=</span> <span class="n">a</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
       <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">h</span>
       <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
   <span class="n">s</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="o">+</span><span class="n">s</span>
   <span class="k">return</span> <span class="n">h</span><span class="o">*</span><span class="n">s</span>
<span class="c1">#  function to compute pi</span>
<span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="c1"># define integration limits</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>  <span class="n">b</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
<span class="c1"># find result from sympy</span>
<span class="c1"># define x as a symbol to be used by sympy</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">exact</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="c1"># set up the arrays for plotting the relative error</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
<span class="c1"># find the relative error as function of integration points</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">npts</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">i</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">Trapez</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">function</span><span class="p">,</span><span class="n">npts</span><span class="p">)</span>
    <span class="n">RelativeError</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="n">exact</span><span class="o">-</span><span class="n">result</span><span class="p">)</span><span class="o">/</span><span class="n">exact</span><span class="p">)</span>
    <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">log10</span><span class="p">(</span><span class="n">npts</span><span class="p">);</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">log10</span><span class="p">(</span><span class="n">RelativeError</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Relative error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter1_3_0.png" src="_images/chapter1_3_0.png" />
</div>
</div>
<p>This example shows the potential of combining numerical algorithms with symbolic calculations, allowing us to</p>
<ul class="simple">
<li><p>Validate and verify  their  algorithms.</p></li>
<li><p>Including concepts like unit testing, one has the possibility to test and test several or all parts of the code.</p></li>
<li><p>Validation and verification are then included <em>naturally</em> and one can develop a better attitude to what is meant with an ethically sound scientific approach.</p></li>
<li><p>The above example allows the student to also test the mathematical error of the algorithm for the trapezoidal rule by changing the number of integration points. The students get <strong>trained from day one to think error analysis</strong>.</p></li>
<li><p>With a Jupyter notebook you can keep exploring similar examples and turn them in as your own notebooks.</p></li>
</ul>
<p>In this process we can easily bake in</p>
<ol class="simple">
<li><p>How to structure a code in terms of functions</p></li>
<li><p>How to make a module</p></li>
<li><p>How to read input data flexibly from the command line</p></li>
<li><p>How to create graphical/web user interfaces</p></li>
<li><p>How to write unit tests (test functions or doctests)</p></li>
<li><p>How to refactor code in terms of classes (instead of functions only)</p></li>
<li><p>How to conduct and automate large-scale numerical experiments</p></li>
<li><p>How to write scientific reports in various formats (LaTeX, HTML)</p></li>
</ol>
<p>The conventions and techniques outlined here will save you a lot of time when you incrementally extend software over time from simpler to more complicated problems. In particular, you will benefit from many good habits:</p>
<ol class="simple">
<li><p>New code is added in a modular fashion to a library (modules)</p></li>
<li><p>Programs are run through convenient user interfaces</p></li>
<li><p>It takes one quick command to let all your code undergo heavy testing</p></li>
<li><p>Tedious manual work with running programs is automated,</p></li>
<li><p>Your scientific investigations are reproducible, scientific reports with top quality typesetting are produced both for paper and electronic devices.</p></li>
</ol>
</div>
</div>
<div class="section" id="space-time-motion-reference-frames-and-reminder-on-vectors-and-other-mathematical-quantities">
<h1>Space, Time, Motion, Reference Frames  and Reminder on vectors and other mathematical quantities<a class="headerlink" href="#space-time-motion-reference-frames-and-reminder-on-vectors-and-other-mathematical-quantities" title="Permalink to this headline">¶</a></h1>
<p>Our studies will start with the motion of different types of objects
such as a falling ball, a runner, a bicycle etc etc. It means that an
object’s position in space varies with time.
In order to study such systems we need to define</p>
<ul class="simple">
<li><p>choice of origin</p></li>
<li><p>choice of the direction of the axes</p></li>
<li><p>choice of positive direction (left-handed or right-handed system of reference)</p></li>
<li><p>choice of units and dimensions</p></li>
</ul>
<p>These choices lead to some important questions such as</p>
<ul class="simple">
<li><p>is the  physics of a system independent of the origin of the axes?</p></li>
<li><p>is the  physics independent of the directions of the axes, that is are there privileged axes?</p></li>
<li><p>is the physics independent of the orientation of system?</p></li>
<li><p>is the physics independent of the scale of the length?</p></li>
</ul>
<div class="section" id="dimension-units-and-labels">
<h2>Dimension, units and labels<a class="headerlink" href="#dimension-units-and-labels" title="Permalink to this headline">¶</a></h2>
<p>Throughout this course we will use the standardized SI units. The standard unit for length is thus one meter 1m, for mass
one kilogram 1kg, for time one second 1s, for force one Newton 1kgm/s<span class="math notranslate nohighlight">\(^2\)</span> and for energy 1 Joule 1kgm<span class="math notranslate nohighlight">\(^2\)</span>s<span class="math notranslate nohighlight">\(^{-2}\)</span>.</p>
<p>We will use the following notations for various variables (vectors are always boldfaced in these lecture notes):</p>
<ul class="simple">
<li><p>position <span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span>, in one dimention we will normally just use <span class="math notranslate nohighlight">\(x\)</span>,</p></li>
<li><p>mass <span class="math notranslate nohighlight">\(m\)</span>,</p></li>
<li><p>time <span class="math notranslate nohighlight">\(t\)</span>,</p></li>
<li><p>velocity <span class="math notranslate nohighlight">\(\boldsymbol{v}\)</span> or just <span class="math notranslate nohighlight">\(v\)</span> in one dimension,</p></li>
<li><p>acceleration <span class="math notranslate nohighlight">\(\boldsymbol{a}\)</span> or just <span class="math notranslate nohighlight">\(a\)</span> in one dimension,</p></li>
<li><p>momentum <span class="math notranslate nohighlight">\(\boldsymbol{p}\)</span> or just <span class="math notranslate nohighlight">\(p\)</span> in one dimension,</p></li>
<li><p>kinetic energy <span class="math notranslate nohighlight">\(K\)</span>,</p></li>
<li><p>potential energy <span class="math notranslate nohighlight">\(V\)</span> and</p></li>
<li><p>frequency <span class="math notranslate nohighlight">\(\omega\)</span>.</p></li>
</ul>
<p>More variables will be defined as we need them.</p>
<p>It is also important to keep track of dimensionalities. Don’t mix this up with a chosen unit for a given variable. We mark the dimensionality in these lectures as <span class="math notranslate nohighlight">\([a]\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> is the quantity we are interested in. Thus</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\([\boldsymbol{r}]=\)</span> length</p></li>
<li><p><span class="math notranslate nohighlight">\([m]=\)</span> mass</p></li>
<li><p><span class="math notranslate nohighlight">\([K]=\)</span> energy</p></li>
<li><p><span class="math notranslate nohighlight">\([t]=\)</span> time</p></li>
<li><p><span class="math notranslate nohighlight">\([\boldsymbol{v}]=\)</span> length over time</p></li>
<li><p><span class="math notranslate nohighlight">\([\boldsymbol{a}]=\)</span> length over time squared</p></li>
<li><p><span class="math notranslate nohighlight">\([\boldsymbol{p}]=\)</span> mass times length over time</p></li>
<li><p><span class="math notranslate nohighlight">\([\omega]=\)</span> 1/time</p></li>
</ul>
</div>
<div class="section" id="elements-of-vector-algebra">
<h2>Elements of Vector Algebra<a class="headerlink" href="#elements-of-vector-algebra" title="Permalink to this headline">¶</a></h2>
<p><strong>Note</strong>: This section is under revision</p>
<p>In these lectures we will use boldfaced lower-case letters to label a vector. A vector <span class="math notranslate nohighlight">\(\boldsymbol{a}\)</span> in three dimensions is thus defined as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{a} =(a_x,a_y, a_z),
\]</div>
<p>and using the unit vectors in a cartesian system we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{a} = a_x\boldsymbol{e}_x+a_y\boldsymbol{e}_y+a_z\boldsymbol{e}_z,
\]</div>
<p>where the unit vectors have magnitude <span class="math notranslate nohighlight">\(\vert\boldsymbol{e}_i\vert = 1\)</span> with <span class="math notranslate nohighlight">\(i=x,y,z\)</span>.</p>
<p>Using the fact that multiplication of reals is distributive we can show that</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{a}(\boldsymbol{b}+\boldsymbol{c})=\boldsymbol{a}\boldsymbol{b}+\boldsymbol{a}\boldsymbol{c},
\]</div>
<p>Similarly we can also show that (using product rule for differentiating reals)</p>
<div class="math notranslate nohighlight">
\[
\frac{d}{dt}(\boldsymbol{a}\boldsymbol{b})=\boldsymbol{a}\frac{d\boldsymbol{b}}{dt}+\boldsymbol{b}\frac{d\boldsymbol{a}}{dt}.
\]</div>
<p>We can repeat these operations for the cross products and show that they are distribuitive</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{a}\times(\boldsymbol{b}+\boldsymbol{c})=\boldsymbol{a}\times\boldsymbol{b}+\boldsymbol{a}\times\boldsymbol{c}.
\]</div>
<p>We have also that</p>
<div class="math notranslate nohighlight">
\[
\frac{d}{dt}(\boldsymbol{a}\times\boldsymbol{b})=\boldsymbol{a}\times\frac{d\boldsymbol{b}}{dt}+\boldsymbol{b}\times\frac{d\boldsymbol{a}}{dt}.
\]</div>
<p>The rotation of a three-dimensional  vector <span class="math notranslate nohighlight">\(\boldsymbol{a}=(a_x,a_y,a_z)\)</span> in the <span class="math notranslate nohighlight">\(xy\)</span> plane around an angle <span class="math notranslate nohighlight">\(\phi\)</span> results in a new vector <span class="math notranslate nohighlight">\(\boldsymbol{b}=(b_x,b_y,b_z)\)</span>.  This operation can be expressed in terms of linear algebra as a matrix (the rotation matrix) multiplied with a vector. We can write this as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix} b_x \\ b_y \\ b_z \end{bmatrix} = \begin{bmatrix} \cos{\phi} &amp; \sin{\phi} &amp; 0 \\ -\sin{\phi} &amp; \cos{\phi} &amp; 0 \\ 0 &amp; 0 &amp; 1\end{bmatrix}\begin{bmatrix} a_x \\ a_y \\ a_z \end{bmatrix}.
\end{split}\]</div>
<p>We can write this in a more compact form as <span class="math notranslate nohighlight">\(\boldsymbol{b} = \boldsymbol{R}\boldsymbol{a}\)</span>, where the rotation matrix is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\boldsymbol{R} = \begin{bmatrix} \cos{\phi} &amp; \sin{\phi} &amp; 0 \\ -\sin{\phi} &amp; \cos{\phi} &amp; 0 \\ 0 &amp; 0 &amp; 1\end{bmatrix}.
\end{split}\]</div>
</div>
<div class="section" id="falling-baseball-in-one-dimension">
<h2>Falling baseball in one dimension<a class="headerlink" href="#falling-baseball-in-one-dimension" title="Permalink to this headline">¶</a></h2>
<p>We anticipate the mathematical model to come and assume that we have a
model for the motion of a falling baseball without air resistance.
Our system (the baseball) is at an initial height <span class="math notranslate nohighlight">\(y_0\)</span> (which we will
specify in the program below) at the initial time <span class="math notranslate nohighlight">\(t_0=0\)</span>. In our program example here we will plot the position in steps of <span class="math notranslate nohighlight">\(\Delta t\)</span> up to a final time <span class="math notranslate nohighlight">\(t_f\)</span>.
The mathematical formula for the position <span class="math notranslate nohighlight">\(y(t)\)</span> as function of time <span class="math notranslate nohighlight">\(t\)</span> is</p>
<div class="math notranslate nohighlight">
\[
y(t) = y_0-\frac{1}{2}gt^2,
\]</div>
<p>where <span class="math notranslate nohighlight">\(g=9.80665=0.980655\times 10^1\)</span>m/s<span class="math notranslate nohighlight">\({}^2\)</span> is a constant representing the standard acceleration due to gravity.
We have here adopted the conventional standard value. This does not take into account other effects, such as buoyancy or drag.
Furthermore, we stop when the ball hits the ground, which takes place at</p>
<div class="math notranslate nohighlight">
\[
y(t) = 0= y_0-\frac{1}{2}gt^2,
\]</div>
<p>which gives us a final time <span class="math notranslate nohighlight">\(t_f=\sqrt{2y_0/g}\)</span>.</p>
<p>As of now we simply assume that   we know the formula for the falling object. Afterwards, we will derive it.</p>
</div>
<div class="section" id="our-python-encounter">
<h2>Our Python Encounter<a class="headerlink" href="#our-python-encounter" title="Permalink to this headline">¶</a></h2>
<p>We start with preparing folders for storing our calculations, figures and if needed, specific data files we use as input or output files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>

<span class="c1">#in case we have an input file we wish to read in</span>
<span class="c1">#infile = open(data_path(&quot;MassEval2016.dat&quot;),&#39;r&#39;)</span>
</pre></div>
</div>
</div>
</div>
<p>You could also define a function for making our plots. You
can obviously avoid this and simply set up various <strong>matplotlib</strong>
commands every time you need them. You may however find it convenient
to collect all such commands in one function and simply call this
function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">plt</span><span class="p">,</span> <span class="n">mpl</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>

<span class="k">def</span> <span class="nf">MakePlot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">styles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">axlabels</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">styles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">axlabels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">axlabels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Thereafter we start setting up the code for the falling object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>

<span class="n">g</span> <span class="o">=</span> <span class="mf">9.80655</span> <span class="c1">#m/s^2</span>
<span class="n">y_0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># initial position in meters</span>
<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># time step</span>
<span class="c1"># final time when y = 0, t = sqrt(2*10/g)</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">y_0</span><span class="o">/</span><span class="n">g</span><span class="p">)</span>
<span class="c1">#set up arrays </span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tfinal</span><span class="p">,</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span><span class="n">y_0</span> <span class="o">-</span><span class="n">g</span><span class="o">*.</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span>
<span class="c1"># Then make a nice printout in table form using Pandas</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;t[s]&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span>
        <span class="s1">&#39;y[m]&#39;</span><span class="p">:</span> <span class="n">y</span>
        <span class="p">}</span>
<span class="n">RawData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">RawData</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">blue_patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Height y as function of  time t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">blue_patch</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;t[s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y[m]&quot;</span><span class="p">)</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;FallingBaseball&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t[s]</th>
      <th>y[m]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>10.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.1</td>
      <td>9.950967</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.2</td>
      <td>9.803869</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.3</td>
      <td>9.558705</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.4</td>
      <td>9.215476</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.5</td>
      <td>8.774181</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.6</td>
      <td>8.234821</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.7</td>
      <td>7.597395</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.8</td>
      <td>6.861904</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.9</td>
      <td>6.028347</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.0</td>
      <td>5.096725</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.1</td>
      <td>4.067037</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.2</td>
      <td>2.939284</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1.3</td>
      <td>1.713465</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.4</td>
      <td>0.389581</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/chapter1_29_1.png" src="_images/chapter1_29_1.png" />
</div>
</div>
<p>Here we used <strong>pandas</strong> (see below) to systemize the output of the position as function of time.</p>
</div>
<div class="section" id="average-quantities">
<h2>Average quantities<a class="headerlink" href="#average-quantities" title="Permalink to this headline">¶</a></h2>
<p>We define now the average velocity as</p>
<div class="math notranslate nohighlight">
\[
\overline{v}(t) = \frac{y(t+\Delta t)-y(t)}{\Delta t}.
\]</div>
<p>In the code we have set the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> to a given value. We could define it in terms of the number of points <span class="math notranslate nohighlight">\(n\)</span> as</p>
<div class="math notranslate nohighlight">
\[
\Delta t = \frac{t_{\mathrm{final}-}t_{\mathrm{initial}}}{n+1}.
\]</div>
<p>Since we have discretized the variables, we introduce the counter <span class="math notranslate nohighlight">\(i\)</span> and let <span class="math notranslate nohighlight">\(y(t)\rightarrow y(t_i)=y_i\)</span> and <span class="math notranslate nohighlight">\(t\rightarrow t_i\)</span>
with <span class="math notranslate nohighlight">\(i=0,1,\dots, n\)</span>. This gives us the following shorthand notations that we will use for the rest of this course. We define</p>
<div class="math notranslate nohighlight">
\[
y_i = y(t_i),\hspace{0.2cm} i=0,1,2,\dots,n.
\]</div>
<p>This applies to other variables which depend on say time. Examples are the velocities, accelerations, momenta etc.
Furthermore we use the shorthand</p>
<div class="math notranslate nohighlight">
\[
y_{i\pm 1} = y(t_i\pm \Delta t),\hspace{0.12cm} i=0,1,2,\dots,n.
\]</div>
</div>
<div class="section" id="compact-equations">
<h2>Compact equations<a class="headerlink" href="#compact-equations" title="Permalink to this headline">¶</a></h2>
<p>We can then rewrite in a more compact form the average velocity as</p>
<div class="math notranslate nohighlight">
\[
\overline{v}_i = \frac{y_{i+1}-y_{i}}{\Delta t}.
\]</div>
<p>The velocity is defined as the change in position per unit time.
In the limit <span class="math notranslate nohighlight">\(\Delta t \rightarrow 0\)</span> this defines the instantaneous velocity, which is nothing but the slope of the position at a time <span class="math notranslate nohighlight">\(t\)</span>.
We have thus</p>
<div class="math notranslate nohighlight">
\[
v(t) = \frac{dy}{dt}=\lim_{\Delta t \rightarrow 0}\frac{y(t+\Delta t)-y(t)}{\Delta t}.
\]</div>
<p>Similarly, we can define the average acceleration as the change in velocity per unit time as</p>
<div class="math notranslate nohighlight">
\[
\overline{a}_i = \frac{v_{i+1}-v_{i}}{\Delta t},
\]</div>
<p>resulting in the instantaneous acceleration</p>
<div class="math notranslate nohighlight">
\[
a(t) = \frac{dv}{dt}=\lim_{\Delta t\rightarrow 0}\frac{v(t+\Delta t)-v(t)}{\Delta t}.
\]</div>
<p><strong>A note on notations</strong>: When writing for example the velocity as <span class="math notranslate nohighlight">\(v(t)\)</span> we are then referring to the continuous and instantaneous value. A subscript like
<span class="math notranslate nohighlight">\(v_i\)</span> refers always to the discretized values.</p>
</div>
<div class="section" id="a-differential-equation">
<h2>A differential equation<a class="headerlink" href="#a-differential-equation" title="Permalink to this headline">¶</a></h2>
<p>We can rewrite the instantaneous acceleration as</p>
<div class="math notranslate nohighlight">
\[
a(t) = \frac{dv}{dt}=\frac{d}{dt}\frac{dy}{dt}=\frac{d^2y}{dt^2}.
\]</div>
<p>This forms the starting point for our definition of forces later. It is a famous second-order differential equation. If the acceleration is constant we can now recover the formula for the falling ball we started with.
The acceleration can depend on the position and the velocity. To be more formal we should then write the above differential equation as</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2y}{dt^2}=a(t,y(t),\frac{dy}{dt}).
\]</div>
<p>With given initial conditions for <span class="math notranslate nohighlight">\(y(t_0)\)</span> and <span class="math notranslate nohighlight">\(v(t_0)\)</span> we can then
integrate the above equation and find the velocities and positions at
a given time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>If we multiply with mass, we have one of the famous expressions for Newton’s second law,</p>
<div class="math notranslate nohighlight">
\[
F(y,v,t)=m\frac{d^2y}{dt^2}=ma(t,y(t),\frac{dy}{dt}),
\]</div>
<p>where <span class="math notranslate nohighlight">\(F\)</span> is the force acting on an object with mass <span class="math notranslate nohighlight">\(m\)</span>. We see that it also has the right dimension, mass times length divided by time squared.
We will come back to this soon.</p>
</div>
<div class="section" id="integrating-our-equations">
<h2>Integrating our equations<a class="headerlink" href="#integrating-our-equations" title="Permalink to this headline">¶</a></h2>
<p>Formally we can then, starting with the acceleration (suppose we have measured it, how could we do that?)
compute say the height of a building.  To see this we perform the following integrations from an initial time <span class="math notranslate nohighlight">\(t_0\)</span>  to a given time <span class="math notranslate nohighlight">\(t\)</span></p>
<div class="math notranslate nohighlight">
\[
\int_{t_0}^t dt a(t) = \int_{t_0}^t dt \frac{dv}{dt} = v(t)-v(t_0),
\]</div>
<p>or as</p>
<div class="math notranslate nohighlight">
\[
v(t)=v(t_0)+\int_{t_0}^t dt a(t).
\]</div>
<p>When we know the velocity as function of time, we can find the position as function of time starting from the defintion of velocity as the derivative with respect to time, that is we have</p>
<div class="math notranslate nohighlight">
\[
\int_{t_0}^t dt v(t) = \int_{t_0}^t dt \frac{dy}{dt} = y(t)-y(t_0),
\]</div>
<p>or as</p>
<div class="math notranslate nohighlight">
\[
y(t)=y(t_0)+\int_{t_0}^t dt v(t).
\]</div>
<p>These equations define what is called the integration method for
finding the position and the velocity as functions of time. There is
no loss of generality if we extend these equations to more than one
spatial dimension.</p>
</div>
<div class="section" id="constant-acceleration-case-the-velocity">
<h2>Constant acceleration case, the velocity<a class="headerlink" href="#constant-acceleration-case-the-velocity" title="Permalink to this headline">¶</a></h2>
<p>Let us compute the velocity using the constant value for the acceleration given by <span class="math notranslate nohighlight">\(-g\)</span>. We have</p>
<div class="math notranslate nohighlight">
\[
v(t)=v(t_0)+\int_{t_0}^t dt a(t)=v(t_0)+\int_{t_0}^t dt (-g).
\]</div>
<p>Using our initial time as <span class="math notranslate nohighlight">\(t_0=0\)</span>s and setting the initial velocity <span class="math notranslate nohighlight">\(v(t_0)=v_0=0\)</span>m/s we get when integrating</p>
<div class="math notranslate nohighlight">
\[
v(t)=-gt.
\]</div>
<p>The more general case is</p>
<div class="math notranslate nohighlight">
\[
v(t)=v_0-g(t-t_0).
\]</div>
<p>We can then integrate the velocity and obtain the final formula for the position as function of time through</p>
<div class="math notranslate nohighlight">
\[
y(t)=y(t_0)+\int_{t_0}^t dt v(t)=y_0+\int_{t_0}^t dt v(t)=y_0+\int_{t_0}^t dt (-gt),
\]</div>
<p>With <span class="math notranslate nohighlight">\(y_0=10\)</span>m and <span class="math notranslate nohighlight">\(t_0=0\)</span>s, we obtain the equation we started with</p>
<div class="math notranslate nohighlight">
\[
y(t)=10-\frac{1}{2}gt^2.
\]</div>
</div>
<div class="section" id="computing-the-averages">
<h2>Computing the averages<a class="headerlink" href="#computing-the-averages" title="Permalink to this headline">¶</a></h2>
<p>After this mathematical background we are now ready to compute the mean velocity using our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now we can compute the mean velocity using our data</span>
<span class="c1"># We define first an array Vaverage</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">Vaverage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">Vaverage</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">DeltaT</span>
<span class="c1"># Now we can compute the mean accelearatio using our data</span>
<span class="c1"># We define first an array Aaverage</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">Aaverage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">Aaverage</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">g</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">Aaverage</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Vaverage</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">Vaverage</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">DeltaT</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;t[s]&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span>
        <span class="s1">&#39;y[m]&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
        <span class="s1">&#39;v[m/s]&#39;</span><span class="p">:</span> <span class="n">Vaverage</span><span class="p">,</span>
        <span class="s1">&#39;a[m/s^2]&#39;</span><span class="p">:</span> <span class="n">Aaverage</span>
        <span class="p">}</span>
<span class="n">NewData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">NewData</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t[s]</th>
      <th>y[m]</th>
      <th>v[m/s]</th>
      <th>a[m/s^2]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>10.000000</td>
      <td>0.000000</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.1</td>
      <td>9.950967</td>
      <td>-1.470982</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.2</td>
      <td>9.803869</td>
      <td>-2.451638</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.3</td>
      <td>9.558705</td>
      <td>-3.432292</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.4</td>
      <td>9.215476</td>
      <td>-4.412948</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.5</td>
      <td>8.774181</td>
      <td>-5.393602</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.6</td>
      <td>8.234821</td>
      <td>-6.374258</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.7</td>
      <td>7.597395</td>
      <td>-7.354913</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.8</td>
      <td>6.861904</td>
      <td>-8.335567</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.9</td>
      <td>6.028347</td>
      <td>-9.316222</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.0</td>
      <td>5.096725</td>
      <td>-10.296878</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.1</td>
      <td>4.067037</td>
      <td>-11.277533</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.2</td>
      <td>2.939284</td>
      <td>-12.258187</td>
      <td>-9.80655</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that we don’t print the last values!</p>
</div>
<div class="section" id="including-air-resistance-in-our-model">
<h2>Including Air Resistance in our model<a class="headerlink" href="#including-air-resistance-in-our-model" title="Permalink to this headline">¶</a></h2>
<p>In our discussions till now of the falling baseball, we have ignored
air resistance and simply assumed that our system is only influenced
by the gravitational force.  We will postpone the derivation of air
resistance till later, after our discussion of Newton’s laws and
forces.</p>
<p>For our discussions here it suffices to state that the accelerations is now modified to</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{a}(t) = -g +D\boldsymbol{v}(t)\vert v(t)\vert,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\vert v(t)\vert\)</span> is the absolute value of the velocity and <span class="math notranslate nohighlight">\(D\)</span> is a constant which pertains to the specific object we are studying.
Since we are dealing with motion in one dimension, we can simplify the above to</p>
<div class="math notranslate nohighlight">
\[
a(t) = -g +Dv^2(t).
\]</div>
<p>We can rewrite this as a differential equation</p>
<div class="math notranslate nohighlight">
\[
a(t) = \frac{dv}{dt}=\frac{d^2y}{dt^2}= -g +Dv^2(t).
\]</div>
<p>Using the integral equations discussed above we can integrate twice
and obtain first the velocity as function of time and thereafter the
position as function of time.</p>
<p>For this particular case, we can actually obtain an analytical
solution for the velocity and for the position. Here we will first
compute the solutions analytically, thereafter we will derive Euler’s
method for solving these differential equations numerically.</p>
</div>
<div class="section" id="analytical-solutions">
<h2>Analytical solutions<a class="headerlink" href="#analytical-solutions" title="Permalink to this headline">¶</a></h2>
<p>For simplicity let us just write <span class="math notranslate nohighlight">\(v(t)\)</span> as <span class="math notranslate nohighlight">\(v\)</span>. We have</p>
<div class="math notranslate nohighlight">
\[
\frac{dv}{dt}= -g +Dv^2(t).
\]</div>
<p>We can solve this using the technique of separation of variables. We
isolate on the left all terms that involve <span class="math notranslate nohighlight">\(v\)</span> and on the right all
terms that involve time. We get then</p>
<div class="math notranslate nohighlight">
\[
\frac{dv}{g -Dv^2(t) }= -dt,
\]</div>
<p>We scale now the equation to the left by introducing a constant
<span class="math notranslate nohighlight">\(v_T=\sqrt{g/D}\)</span>. This constant has dimension length/time. Can you
show this?</p>
<p>Next we integrate the left-hand side (lhs) from <span class="math notranslate nohighlight">\(v_0=0\)</span> m/s to <span class="math notranslate nohighlight">\(v\)</span> and
the right-hand side (rhs) from <span class="math notranslate nohighlight">\(t_0=0\)</span> to <span class="math notranslate nohighlight">\(t\)</span> and obtain</p>
<div class="math notranslate nohighlight">
\[
\int_{0}^v\frac{dv}{g -Dv^2(t) }= \frac{v_T}{g}\mathrm{arctanh}(\frac{v}{v_T})  =-\int_0^tdt = -t.
\]</div>
<p>We can reorganize these equations as</p>
<div class="math notranslate nohighlight">
\[
v_T\mathrm{arctanh}(\frac{v}{v_T})  =-gt,
\]</div>
<p>which gives us <span class="math notranslate nohighlight">\(v\)</span> as function of time</p>
<div class="math notranslate nohighlight">
\[
v(t)=v_T\tanh{-(\frac{gt}{v_T})}.
\]</div>
</div>
<div class="section" id="finding-the-final-height">
<h2>Finding the final height<a class="headerlink" href="#finding-the-final-height" title="Permalink to this headline">¶</a></h2>
<p>With the velocity we can then find the height <span class="math notranslate nohighlight">\(y(t)\)</span> by integrating yet another time, that is</p>
<div class="math notranslate nohighlight">
\[
y(t)=y(t_0)+\int_{t_0}^t dt v(t)=\int_{0}^t dt[v_T\tanh{-(\frac{gt}{v_T})}].
\]</div>
<p>This integral is a little bit trickier but we can look it up in a table over
known integrals and we get</p>
<div class="math notranslate nohighlight">
\[
y(t)=y(t_0)-\frac{v_T^2}{g}\log{[\cosh{(\frac{gt}{v_T})}]}.
\]</div>
<p>Alternatively we could have used the symbolic Python package <strong>Sympy</strong>  (example will be inserted later).</p>
<p>In most cases however, we need to revert to numerical solutions.</p>
</div>
<div class="section" id="our-first-attempt-at-solving-differential-equations">
<h2>Our first attempt at solving differential equations<a class="headerlink" href="#our-first-attempt-at-solving-differential-equations" title="Permalink to this headline">¶</a></h2>
<p>Here we will try the simplest possible approach to solving the second-order differential
equation</p>
<div class="math notranslate nohighlight">
\[
a(t) =\frac{d^2y}{dt^2}= -g +Dv^2(t).
\]</div>
<p>We rewrite it as two coupled first-order equations (this is a standard approach)</p>
<div class="math notranslate nohighlight">
\[
\frac{dy}{dt} = v(t),
\]</div>
<p>with initial condition <span class="math notranslate nohighlight">\(y(t_0)=y_0\)</span> and</p>
<div class="math notranslate nohighlight">
\[
a(t) =\frac{dv}{dt}= -g +Dv^2(t),
\]</div>
<p>with initial condition <span class="math notranslate nohighlight">\(v(t_0)=v_0\)</span>.</p>
<p>Many of the algorithms for solving differential equations start with simple Taylor equations.
If we now Taylor expand <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(v\)</span> around a value <span class="math notranslate nohighlight">\(t+\Delta t\)</span> we have</p>
<div class="math notranslate nohighlight">
\[
y(t+\Delta t) = y(t)+\Delta t \frac{dy}{dt}+\frac{\Delta t^2}{2!} \frac{d^2y}{dt^2}+O(\Delta t^3),
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v(t+\Delta t) = v(t)+\Delta t \frac{dv}{dt}+\frac{\Delta t^2}{2!} \frac{d^2v}{dt^2}+O(\Delta t^3).
\]</div>
<p>Using the fact that <span class="math notranslate nohighlight">\(dy/dt = v\)</span> and <span class="math notranslate nohighlight">\(dv/dt=a\)</span> and keeping only terms up to <span class="math notranslate nohighlight">\(\Delta t\)</span> we have</p>
<div class="math notranslate nohighlight">
\[
y(t+\Delta t) = y(t)+\Delta t v(t)+O(\Delta t^2),
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v(t+\Delta t) = v(t)+\Delta t a(t)+O(\Delta t^2).
\]</div>
</div>
<div class="section" id="discretizing-our-equations">
<h2>Discretizing our equations<a class="headerlink" href="#discretizing-our-equations" title="Permalink to this headline">¶</a></h2>
<p>Using our discretized versions of the equations with for example
<span class="math notranslate nohighlight">\(y_{i}=y(t_i)\)</span> and <span class="math notranslate nohighlight">\(y_{i\pm 1}=y(t_i+\Delta t)\)</span>, we can rewrite the
above equations as (and truncating at <span class="math notranslate nohighlight">\(\Delta t\)</span>)</p>
<div class="math notranslate nohighlight">
\[
y_{i+1} = y_i+\Delta t v_i,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+\Delta t a_i.
\]</div>
<p>These are the famous Euler equations (forward Euler).</p>
<p>To solve these equations numerically we start at a time <span class="math notranslate nohighlight">\(t_0\)</span> and simply integrate up these equations to a final time <span class="math notranslate nohighlight">\(t_f\)</span>,
The step size <span class="math notranslate nohighlight">\(\Delta t\)</span> is an input  parameter in our code.
You can define it directly in the code below as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
</div>
<p>With a given final time <strong>tfinal</strong>  we can then find the number of integration points via the <strong>ceil</strong> function included in the <strong>math</strong> package of Python
as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define final time, assuming that initial time is zero</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">ceil</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<p>The <strong>ceil</strong> function returns the smallest integer not less than the input in say</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mf">21.15</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22
</pre></div>
</div>
</div>
</div>
<p>which in the case here is 22.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mf">21.75</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22
</pre></div>
</div>
</div>
</div>
<p>which also yields 22. The  <strong>floor</strong> function in the <strong>math</strong> package
is used to return the closest integer value which is less than or equal to the specified expression or value.
Compare the previous result to the usage of <strong>floor</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">floor</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">21.75</span>
<span class="nb">print</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>21
</pre></div>
</div>
</div>
</div>
<p>Alternatively, we can define ourselves the number of integration(mesh) points. In this case we could have</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">tinitial</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">DeltaT</span> <span class="o">=</span> <span class="p">(</span><span class="n">tfinal</span><span class="o">-</span><span class="n">tinitial</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DeltaT</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.05
</pre></div>
</div>
</div>
</div>
<p>Since we will set up one-dimensional arrays that contain the values of
various variables like time, position, velocity, acceleration etc, we
need to know the value of <span class="math notranslate nohighlight">\(n\)</span>, the number of data points (or
integration or mesh points).  With <span class="math notranslate nohighlight">\(n\)</span> we can initialize a given array
by setting all elelements to zero, as done here</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define array a</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="code-for-implementing-euler-s-method">
<h2>Code for implementing Euler’s method<a class="headerlink" href="#code-for-implementing-euler-s-method" title="Permalink to this headline">¶</a></h2>
<p>In the code here we implement this simple Eurler scheme choosing a value for <span class="math notranslate nohighlight">\(D=0.0245\)</span> m/s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>


<span class="n">g</span> <span class="o">=</span> <span class="mf">9.80655</span> <span class="c1">#m/s^2</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.00245</span> <span class="c1">#m/s</span>
<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># define scaling constant vT</span>
<span class="n">vT</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">g</span><span class="o">/</span><span class="n">D</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and y and we can compare our results with analytical ones</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">yanalytic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Initial conditions</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1">#m/s</span>
<span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1">#m</span>
<span class="n">yanalytic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Start integrating using Euler&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># expression for acceleration</span>
    <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">g</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1"># update velocity and position</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1"># update time to next time step and compute analytical answer</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="n">yanalytic</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">vT</span><span class="o">*</span><span class="n">vT</span><span class="o">/</span><span class="n">g</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">cosh</span><span class="p">(</span><span class="n">g</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">vT</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">):</span>
        <span class="k">break</span>
<span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">g</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;t[s]&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span>
        <span class="s1">&#39;y[m]&#39;</span><span class="p">:</span> <span class="n">y</span><span class="o">-</span><span class="n">yanalytic</span><span class="p">,</span>
        <span class="s1">&#39;v[m/s]&#39;</span><span class="p">:</span> <span class="n">v</span><span class="p">,</span>
        <span class="s1">&#39;a[m/s^2]&#39;</span><span class="p">:</span> <span class="n">a</span>
        <span class="p">}</span>
<span class="n">NewData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">NewData</span><span class="p">)</span>
<span class="c1">#finally we plot the data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">yanalytic</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y and exact&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;v[m/s]&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time[s]&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;a[m/s^2]&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EulerIntegration&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t[s]</th>
      <th>y[m]</th>
      <th>v[m/s]</th>
      <th>a[m/s^2]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-9.806550</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.1</td>
      <td>0.049031</td>
      <td>-0.980655</td>
      <td>-9.804194</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.2</td>
      <td>0.098034</td>
      <td>-1.961074</td>
      <td>-9.797128</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.3</td>
      <td>0.146963</td>
      <td>-2.940787</td>
      <td>-9.785362</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.4</td>
      <td>0.195770</td>
      <td>-3.919323</td>
      <td>-9.768915</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/chapter1_125_1.png" src="_images/chapter1_125_1.png" />
</div>
</div>
<p>Try different values for <span class="math notranslate nohighlight">\(\Delta t\)</span> and study the difference between the exact solution and the numerical solution.</p>
</div>
<div class="section" id="simple-extension-the-euler-cromer-method">
<h2>Simple extension, the Euler-Cromer method<a class="headerlink" href="#simple-extension-the-euler-cromer-method" title="Permalink to this headline">¶</a></h2>
<p>The Euler-Cromer method is a simple variant of the standard Euler
method. We use the newly updated velocity <span class="math notranslate nohighlight">\(v_{i+1}\)</span> as an input to the
new position, that is, instead of</p>
<div class="math notranslate nohighlight">
\[
y_{i+1} = y_i+\Delta t v_i,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+\Delta t a_i,
\]</div>
<p>we use now the newly calculate for <span class="math notranslate nohighlight">\(v_{i+1}\)</span> as input to <span class="math notranslate nohighlight">\(y_{i+1}\)</span>, that is
we compute first</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+\Delta t a_i,
\]</div>
<p>and then</p>
<div class="math notranslate nohighlight">
\[
y_{i+1} = y_i+\Delta t v_{i+1},
\]</div>
<p>Implementing the Euler-Cromer method yields a simple change to the previous code. We only need to change the following line in the loop over time
steps</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># more codes in between here</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># more code</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="python-practicalities-software-and-needed-installations">
<h2>Python practicalities, Software and needed installations<a class="headerlink" href="#python-practicalities-software-and-needed-installations" title="Permalink to this headline">¶</a></h2>
<p>We will make extensive use of Python as programming language and its
myriad of available libraries.  You will find
Jupyter notebooks invaluable in your work.</p>
<p>If you have Python installed (we strongly recommend Python3) and you feel
pretty familiar with installing different packages, we recommend that
you install the following Python packages via <strong>pip</strong> as</p>
<ol class="simple">
<li><p>pip install numpy scipy matplotlib ipython scikit-learn mglearn sympy pandas pillow</p></li>
</ol>
<p>For Python3, replace <strong>pip</strong> with <strong>pip3</strong>.</p>
<p>For OSX users we recommend, after having installed Xcode, to
install <strong>brew</strong>. Brew allows for a seamless installation of additional
software via for example</p>
<ol class="simple">
<li><p>brew install python3</p></li>
</ol>
<p>For Linux users, with its variety of distributions like for example the widely popular Ubuntu distribution,
you can use <strong>pip</strong> as well and simply install Python as</p>
<ol class="simple">
<li><p>sudo apt-get install python3  (or python for pyhton2.7)</p></li>
</ol>
<p>etc etc.</p>
</div>
<div class="section" id="python-installers">
<h2>Python installers<a class="headerlink" href="#python-installers" title="Permalink to this headline">¶</a></h2>
<p>If you don’t want to perform these operations separately and venture
into the hassle of exploring how to set up dependencies and paths, we
recommend two widely used distrubutions which set up all relevant
dependencies for Python, namely</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.anaconda.com/">Anaconda</a>,</p></li>
</ul>
<p>which is an open source
distribution of the Python and R programming languages for large-scale
data processing, predictive analytics, and scientific computing, that
aims to simplify package management and deployment. Package versions
are managed by the package management system <strong>conda</strong>.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.enthought.com/product/canopy/">Enthought canopy</a></p></li>
</ul>
<p>is a Python
distribution for scientific and analytic computing distribution and
analysis environment, available for free and under a commercial
license.</p>
<p>Furthermore, <a class="reference external" href="https://colab.research.google.com/notebooks/welcome.ipynb">Google’s Colab</a> is a free Jupyter notebook environment that requires
no setup and runs entirely in the cloud. Try it out!</p>
</div>
<div class="section" id="useful-python-libraries">
<h2>Useful Python libraries<a class="headerlink" href="#useful-python-libraries" title="Permalink to this headline">¶</a></h2>
<p>Here we list several useful Python libraries we strongly recommend (if you use anaconda many of these are already there)</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.numpy.org/">NumPy</a> is a highly popular library for large, multi-dimensional arrays and matrices, along with a large collection of high-level mathematical functions to operate on these arrays</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/">The pandas</a> library provides high-performance, easy-to-use data structures and data analysis tools</p></li>
<li><p><a class="reference external" href="http://xarray.pydata.org/en/stable/">Xarray</a> is a Python package that makes working with labelled multi-dimensional arrays simple, efficient, and fun!</p></li>
<li><p><a class="reference external" href="https://www.scipy.org/">Scipy</a> (pronounced “Sigh Pie”) is a Python-based ecosystem of open-source software for mathematics, science, and engineering.</p></li>
<li><p><a class="reference external" href="https://matplotlib.org/">Matplotlib</a> is a Python 2D plotting library which produces publication quality figures in a variety of hardcopy formats and interactive environments across platforms.</p></li>
<li><p><a class="reference external" href="https://github.com/HIPS/autograd">Autograd</a> can automatically differentiate native Python and Numpy code. It can handle a large subset of Python’s features, including loops, ifs, recursion and closures, and it can even take derivatives of derivatives of derivatives</p></li>
<li><p><a class="reference external" href="https://www.sympy.org/en/index.html">SymPy</a> is a Python library for symbolic mathematics.</p></li>
<li><p><a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a> has simple and efficient tools for machine learning, data mining and data analysis</p></li>
<li><p><a class="reference external" href="https://www.tensorflow.org/">TensorFlow</a> is a Python library for fast numerical computing created and released by Google</p></li>
<li><p><a class="reference external" href="https://keras.io/">Keras</a> is a high-level neural networks API, written in Python and capable of running on top of TensorFlow, CNTK, or Theano</p></li>
<li><p>And many more such as <a class="reference external" href="https://pytorch.org/">pytorch</a>,  <a class="reference external" href="https://pypi.org/project/Theano/">Theano</a> etc</p></li>
</ul>
<p>Your jupyter notebook can easily be
converted into a nicely rendered <strong>PDF</strong> file or a Latex file for
further processing. For example, convert to latex as</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    pycod jupyter nbconvert filename.ipynb --to latex 
</pre></div>
</div>
<p>And to add more versatility, the Python package <a class="reference external" href="http://www.sympy.org/en/index.html">SymPy</a> is a Python library for symbolic mathematics. It aims to become a full-featured computer algebra system (CAS)  and is entirely written in Python.</p>
</div>
<div class="section" id="numpy-examples-and-important-matrix-and-vector-handling-packages">
<h2>Numpy examples and Important Matrix and vector handling packages<a class="headerlink" href="#numpy-examples-and-important-matrix-and-vector-handling-packages" title="Permalink to this headline">¶</a></h2>
<p>There are several central software libraries for linear algebra and eigenvalue problems. Several of the more
popular ones have been wrapped into ofter software packages like those from the widely used text <strong>Numerical Recipes</strong>. The original source codes in many of the available packages are often taken from the widely used
software package LAPACK, which follows two other popular packages
developed in the 1970s, namely EISPACK and LINPACK.  We describe them shortly here.</p>
<ul class="simple">
<li><p>LINPACK: package for linear equations and least square problems.</p></li>
<li><p>LAPACK:package for solving symmetric, unsymmetric and generalized eigenvalue problems. From LAPACK’s website <a class="reference external" href="http://www.netlib.org">http://www.netlib.org</a> it is possible to download for free all source codes from this library. Both C/C++ and Fortran versions are available.</p></li>
<li><p>BLAS (I, II and III): (Basic Linear Algebra Subprograms) are routines that provide standard building blocks for performing basic vector and matrix operations. Blas I is vector operations, II vector-matrix operations and III matrix-matrix operations. Highly parallelized and efficient codes, all available for download from <a class="reference external" href="http://www.netlib.org">http://www.netlib.org</a>.</p></li>
</ul>
</div>
<div class="section" id="basic-matrix-features">
<h2>Basic Matrix Features<a class="headerlink" href="#basic-matrix-features" title="Permalink to this headline">¶</a></h2>
<p><strong>Matrix properties reminder.</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{A} =
      \begin{bmatrix} a_{11} &amp; a_{12} &amp; a_{13} &amp; a_{14} \\
                                 a_{21} &amp; a_{22} &amp; a_{23} &amp; a_{24} \\
                                   a_{31} &amp; a_{32} &amp; a_{33} &amp; a_{34} \\
                                  a_{41} &amp; a_{42} &amp; a_{43} &amp; a_{44}
             \end{bmatrix}\qquad
\mathbf{I} =
      \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\
                                 0 &amp; 1 &amp; 0 &amp; 0 \\
                                 0 &amp; 0 &amp; 1 &amp; 0 \\
                                 0 &amp; 0 &amp; 0 &amp; 1
             \end{bmatrix}
\end{split}\]</div>
<p>The inverse of a matrix is defined by</p>
<div class="math notranslate nohighlight">
\[
\mathbf{A}^{-1} \cdot \mathbf{A} = I
\]</div>
<table border="1">
<thead>
<tr><th align="center">              Relations               </th> <th align="center">      Name     </th> <th align="center">                            matrix elements                            </th> </tr>
</thead>
<tbody>
<tr><td align="center">   $A = A^{T}$                               </td> <td align="center">   symmetric          </td> <td align="center">   $a_{ij} = a_{ji}$                                                          </td> </tr>
<tr><td align="center">   $A = \left (A^{T} \right )^{-1}$          </td> <td align="center">   real orthogonal    </td> <td align="center">   $\sum_k a_{ik} a_{jk} = \sum_k a_{ki} a_{kj} = \delta_{ij}$                </td> </tr>
<tr><td align="center">   $A = A^{ * }$                             </td> <td align="center">   real matrix        </td> <td align="center">   $a_{ij} = a_{ij}^{ * }$                                                    </td> </tr>
<tr><td align="center">   $A = A^{\dagger}$                         </td> <td align="center">   hermitian          </td> <td align="center">   $a_{ij} = a_{ji}^{ * }$                                                    </td> </tr>
<tr><td align="center">   $A = \left (A^{\dagger} \right )^{-1}$    </td> <td align="center">   unitary            </td> <td align="center">   $\sum_k a_{ik} a_{jk}^{ * } = \sum_k a_{ki}^{ * } a_{kj} = \delta_{ij}$    </td> </tr>
</tbody>
</table>
<div class="section" id="some-famous-matrices">
<h3>Some famous Matrices<a class="headerlink" href="#some-famous-matrices" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Diagonal if <span class="math notranslate nohighlight">\(a_{ij}=0\)</span> for <span class="math notranslate nohighlight">\(i\ne j\)</span></p></li>
<li><p>Upper triangular if <span class="math notranslate nohighlight">\(a_{ij}=0\)</span> for <span class="math notranslate nohighlight">\(i &gt; j\)</span></p></li>
<li><p>Lower triangular if <span class="math notranslate nohighlight">\(a_{ij}=0\)</span> for <span class="math notranslate nohighlight">\(i &lt; j\)</span></p></li>
<li><p>Upper Hessenberg if <span class="math notranslate nohighlight">\(a_{ij}=0\)</span> for <span class="math notranslate nohighlight">\(i &gt; j+1\)</span></p></li>
<li><p>Lower Hessenberg if <span class="math notranslate nohighlight">\(a_{ij}=0\)</span> for <span class="math notranslate nohighlight">\(i &lt; j+1\)</span></p></li>
<li><p>Tridiagonal if <span class="math notranslate nohighlight">\(a_{ij}=0\)</span> for <span class="math notranslate nohighlight">\(|i -j| &gt; 1\)</span></p></li>
<li><p>Lower banded with bandwidth <span class="math notranslate nohighlight">\(p\)</span>: <span class="math notranslate nohighlight">\(a_{ij}=0\)</span> for <span class="math notranslate nohighlight">\(i &gt; j+p\)</span></p></li>
<li><p>Upper banded with bandwidth <span class="math notranslate nohighlight">\(p\)</span>: <span class="math notranslate nohighlight">\(a_{ij}=0\)</span> for <span class="math notranslate nohighlight">\(i &lt; j+p\)</span></p></li>
<li><p>Banded, block upper triangular, block lower triangular….</p></li>
</ul>
</div>
<div class="section" id="more-basic-matrix-features">
<h3>More Basic Matrix Features<a class="headerlink" href="#more-basic-matrix-features" title="Permalink to this headline">¶</a></h3>
<p><strong>Some Equivalent Statements.</strong></p>
<p>For an <span class="math notranslate nohighlight">\(N\times N\)</span> matrix  <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> the following properties are all equivalent</p>
<ul class="simple">
<li><p>If the inverse of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> exists, <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is nonsingular.</p></li>
<li><p>The equation <span class="math notranslate nohighlight">\(\mathbf{Ax}=0\)</span> implies <span class="math notranslate nohighlight">\(\mathbf{x}=0\)</span>.</p></li>
<li><p>The rows of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> form a basis of <span class="math notranslate nohighlight">\(R^N\)</span>.</p></li>
<li><p>The columns of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> form a basis of <span class="math notranslate nohighlight">\(R^N\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is a product of elementary matrices.</p></li>
<li><p><span class="math notranslate nohighlight">\(0\)</span> is not eigenvalue of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p></li>
</ul>
</div>
</div>
<div class="section" id="numpy-and-arrays">
<h2>Numpy and arrays<a class="headerlink" href="#numpy-and-arrays" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://www.numpy.org/">Numpy</a> provides an easy way to handle arrays in Python. The standard way to import this library is as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>Here follows a simple example where we set up an array of ten elements, all determined by random numbers drawn according to the normal distribution,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.22998073  0.34104556 -1.46726145 -1.36499028 -0.899849    1.21698173
  0.49069179  0.55513828 -0.72318002  0.64098642]
</pre></div>
</div>
</div>
</div>
<p>We defined a vector <span class="math notranslate nohighlight">\(x\)</span> with <span class="math notranslate nohighlight">\(n=10\)</span> elements with its values given by the Normal distribution <span class="math notranslate nohighlight">\(N(0,1)\)</span>.
Another alternative is to declare a vector as follows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1 2 3]
</pre></div>
</div>
</div>
</div>
<p>Here we have defined a vector with three elements, with <span class="math notranslate nohighlight">\(x_0=1\)</span>, <span class="math notranslate nohighlight">\(x_1=2\)</span> and <span class="math notranslate nohighlight">\(x_2=3\)</span>. Note that both Python and C++
start numbering array elements from <span class="math notranslate nohighlight">\(0\)</span> and on. This means that a vector with <span class="math notranslate nohighlight">\(n\)</span> elements has a sequence of entities <span class="math notranslate nohighlight">\(x_0, x_1, x_2, \dots, x_{n-1}\)</span>. We could also let (recommended) Numpy to compute the logarithms of a specific array as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.38629436 1.94591015 2.07944154]
</pre></div>
</div>
</div>
</div>
<p>In the last example we used Numpy’s unary function <span class="math notranslate nohighlight">\(np.log\)</span>. This function is
highly tuned to compute array elements since the code is vectorized
and does not require looping. We normaly recommend that you use the
Numpy intrinsic functions instead of the corresponding <strong>log</strong> function
from Python’s <strong>math</strong> module. The looping is done explicitely by the
<strong>np.log</strong> function. The alternative, and slower way to compute the
logarithms of a vector would be to write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1 1 2]
</pre></div>
</div>
</div>
</div>
<p>We note that our code is much longer already and we need to import the <strong>log</strong> function from the <strong>math</strong> module.
The attentive reader will also notice that the output is <span class="math notranslate nohighlight">\([1, 1, 2]\)</span>. Python interprets automagically our numbers as integers (like the <strong>automatic</strong> keyword in C++). To change this we could define our array elements to be double precision numbers as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.38629436 1.94591015 2.07944154]
</pre></div>
</div>
</div>
</div>
<p>or simply write them as double precision numbers (Python uses 64 bits as default for floating point type variables), that is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">  File</span><span class="nn"> &quot;&lt;ipython-input-21-f6d7a289d493&gt;&quot;</span><span class="gt">, line </span><span class="mi">3</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="o">^</span>
<span class="ne">SyntaxError</span>: invalid syntax
</pre></div>
</div>
</div>
</div>
<p>To check the number of bytes (remember that one byte contains eight bits for double precision variables), you can use simple use the <strong>itemsize</strong> functionality (the array <span class="math notranslate nohighlight">\(x\)</span> is actually an object which inherits the functionalities defined in Numpy) as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">itemsize</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="matrices-in-python">
<h2>Matrices in Python<a class="headerlink" href="#matrices-in-python" title="Permalink to this headline">¶</a></h2>
<p>Having defined vectors, we are now ready to try out matrices. We can
define a <span class="math notranslate nohighlight">\(3 \times 3 \)</span> real matrix <span class="math notranslate nohighlight">\(\hat{A}\)</span> as (recall that we user
lowercase letters for vectors and uppercase letters for matrices)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">]</span> <span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If we use the <strong>shape</strong> function we would get <span class="math notranslate nohighlight">\((3, 3)\)</span> as output, that is verifying that our matrix is a <span class="math notranslate nohighlight">\(3\times 3\)</span> matrix. We can slice the matrix and print for example the first column (Python organized matrix elements in a row-major order, see below) as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">]</span> <span class="p">]))</span>
<span class="c1"># print the first column, row-major order and elements start with 0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We can continue this was by printing out other columns or rows. The example here prints out the second column</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">]</span> <span class="p">]))</span>
<span class="c1"># print the first column, row-major order and elements start with 0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>
</pre></div>
</div>
</div>
</div>
<p>Numpy contains many other functionalities that allow us to slice, subdivide etc etc arrays. We strongly recommend that you look up the <a class="reference external" href="http://www.numpy.org/">Numpy website for more details</a>. Useful functions when defining a matrix are the <strong>np.zeros</strong> function which declares a matrix of a given dimension and sets all elements to zero</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1"># define a matrix of dimension 10 x 10 and set all elements to zero</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>or initializing all elements to</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1"># define a matrix of dimension 10 x 10 and set all elements to one</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>or as unitarily distributed random numbers (see the material on random number generators in the statistics part)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1"># define a matrix of dimension 10 x 10 and set all elements to random numbers with x \in [0, 1]</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="meet-the-pandas">
<h2>Meet the Pandas<a class="headerlink" href="#meet-the-pandas" title="Permalink to this headline">¶</a></h2>
<!-- dom:FIGURE: [fig/pandas.jpg, width=600 frac=0.8] -->
<!-- begin figure -->
<p></p>
<img src="fig/pandas.jpg" width=600>
<!-- end figure -->
<p>Another useful Python package is
<a class="reference external" href="https://pandas.pydata.org/">pandas</a>, which is an open source library
providing high-performance, easy-to-use data structures and data
analysis tools for Python. <strong>pandas</strong> stands for panel data, a term borrowed from econometrics and is an efficient library for data analysis with an emphasis on tabular data.
<strong>pandas</strong> has two major classes, the <strong>DataFrame</strong> class with two-dimensional data objects and tabular data organized in columns and the class <strong>Series</strong> with a focus on one-dimensional data objects. Both classes allow you to index data easily as we will see in the examples below.
<strong>pandas</strong> allows you also to perform mathematical operations on the data, spanning from simple reshapings of vectors and matrices to statistical operations.</p>
<p>The following simple example shows how we can, in an easy way make tables of our data. Here we define a data set which includes names, place of birth and date of birth, and displays the data in an easy to read way. We will see repeated use of <strong>pandas</strong>, in particular in connection with classification of data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;First Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Frodo&quot;</span><span class="p">,</span> <span class="s2">&quot;Bilbo&quot;</span><span class="p">,</span> <span class="s2">&quot;Aragorn II&quot;</span><span class="p">,</span> <span class="s2">&quot;Samwise&quot;</span><span class="p">],</span>
        <span class="s1">&#39;Last Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Baggins&quot;</span><span class="p">,</span> <span class="s2">&quot;Baggins&quot;</span><span class="p">,</span><span class="s2">&quot;Elessar&quot;</span><span class="p">,</span><span class="s2">&quot;Gamgee&quot;</span><span class="p">],</span>
        <span class="s1">&#39;Place of birth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Shire&quot;</span><span class="p">,</span> <span class="s2">&quot;Shire&quot;</span><span class="p">,</span> <span class="s2">&quot;Eriador&quot;</span><span class="p">,</span> <span class="s2">&quot;Shire&quot;</span><span class="p">],</span>
        <span class="s1">&#39;Date of Birth T.A.&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2968</span><span class="p">,</span> <span class="mi">2890</span><span class="p">,</span> <span class="mi">2931</span><span class="p">,</span> <span class="mi">2980</span><span class="p">]</span>
        <span class="p">}</span>
<span class="n">data_pandas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">data_pandas</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the above we have imported <strong>pandas</strong> with the shorthand <strong>pd</strong>, the latter has become the standard way we import <strong>pandas</strong>. We make then a list of various variables
and reorganize the above lists into a <strong>DataFrame</strong> and then print out  a neat table with specific column labels as <em>Name</em>, <em>place of birth</em> and <em>date of birth</em>.
Displaying these results, we see that the indices are given by the default numbers from zero to three.
<strong>pandas</strong> is extremely flexible and we can easily change the above indices by defining a new type of indexing as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_pandas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frodo&#39;</span><span class="p">,</span><span class="s1">&#39;Bilbo&#39;</span><span class="p">,</span><span class="s1">&#39;Aragorn&#39;</span><span class="p">,</span><span class="s1">&#39;Sam&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">data_pandas</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Thereafter we display the content of the row which begins with the index <strong>Aragorn</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">data_pandas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Aragorn&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We can easily append data to this, for example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_hobbit</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;First Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Peregrin&quot;</span><span class="p">],</span>
              <span class="s1">&#39;Last Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Took&quot;</span><span class="p">],</span>
              <span class="s1">&#39;Place of birth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Shire&quot;</span><span class="p">],</span>
              <span class="s1">&#39;Date of Birth T.A.&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2990</span><span class="p">]</span>
              <span class="p">}</span>
<span class="n">data_pandas</span><span class="o">=</span><span class="n">data_pandas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">new_hobbit</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Pippin&#39;</span><span class="p">]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">data_pandas</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here are other examples where we use the <strong>DataFrame</strong> functionality to handle arrays, now with more interesting features for us, namely numbers. We set up a matrix
of dimensionality <span class="math notranslate nohighlight">\(10\times 5\)</span> and compute the mean value and standard deviation of each column. Similarly, we can perform mathematial operations like squaring the matrix elements and many other operations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="c1"># setting up a 10 x 5 matrix</span>
<span class="n">rows</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">cols</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Thereafter we can select specific columns only and plot final results</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;First&#39;</span><span class="p">,</span> <span class="s1">&#39;Second&#39;</span><span class="p">,</span> <span class="s1">&#39;Third&#39;</span><span class="p">,</span> <span class="s1">&#39;Fourth&#39;</span><span class="p">,</span> <span class="s1">&#39;Fifth&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Second&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">plt</span><span class="p">,</span> <span class="n">mpl</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>

<span class="n">df</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">rot</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can produce a <span class="math notranslate nohighlight">\(4\times 4\)</span> matrix</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>and many other operations.</p>
<p>The <strong>Series</strong> class is another important class included in
<strong>pandas</strong>. You can view it as a specialization of <strong>DataFrame</strong> but where
we have just a single column of data. It shares many of the same features as _DataFrame. As with <strong>DataFrame</strong>,
most operations are vectorized, achieving thereby a high performance when dealing with computations of arrays, in particular labeled arrays.
As we will see below it leads also to a very concice code close to the mathematical operations we may be interested in.
For multidimensional arrays, we recommend strongly <a class="reference external" href="http://xarray.pydata.org/en/stable/">xarray</a>. <strong>xarray</strong> has much of the same flexibility as <strong>pandas</strong>, but allows for the extension to higher dimensions than two.</p>
</div>
</div>
<div class="section" id="basic-steps-of-scientific-investigations">
<h1>Basic Steps of Scientific Investigations<a class="headerlink" href="#basic-steps-of-scientific-investigations" title="Permalink to this headline">¶</a></h1>
<p>An overarching aim in this course is to give you a deeper
understanding of the scientific method. The problems we study will all
involve cases where we can apply classical mechanics. In our previous
material we already assumed that we had a model for the motion of an
object.  Alternatively we could have data from experiment (like Usain
Bolt’s 100m world record run in 2008).  Or we could have performed
ourselves an experiment and we want to understand which forces are at
play and whether these forces can be understood in terms of
fundamental forces.</p>
<p>Our first step consists in identifying the problem. What we sketch
here may include a mix of experiment and theoretical simulations, or
just experiment or only theory.</p>
<div class="section" id="identifying-our-system">
<h2>Identifying our System<a class="headerlink" href="#identifying-our-system" title="Permalink to this headline">¶</a></h2>
<p>Here we can ask questions like</p>
<ol class="simple">
<li><p>What kind of object is moving</p></li>
<li><p>What kind of data do we have</p></li>
<li><p>How do we measure position, velocity, acceleration etc</p></li>
<li><p>Which initial conditions influence our system</p></li>
<li><p>Other aspects which allow us to identify the system</p></li>
</ol>
</div>
<div class="section" id="defining-a-model">
<h2>Defining a Model<a class="headerlink" href="#defining-a-model" title="Permalink to this headline">¶</a></h2>
<p>With our eventual data and observations we would now like to develop a
model for the system. In the end we want obviously to be able to
understand which forces are at play and how they influence our
specific system. That is, can we extract some deeper insights about a
system?</p>
<p>We need then to</p>
<ol class="simple">
<li><p>Find the forces that act on our system</p></li>
<li><p>Introduce models for the forces</p></li>
<li><p>Identify the equations which can govern the system (Newton’s second law for example)</p></li>
<li><p>More elements we deem important for defining our model</p></li>
</ol>
</div>
<div class="section" id="solving-the-equations">
<h2>Solving the Equations<a class="headerlink" href="#solving-the-equations" title="Permalink to this headline">¶</a></h2>
<p>With the model at hand, we can then solve the equations. In classical mechanics we normally end up  with solving sets of coupled ordinary differential equations or partial differential equations.</p>
<ol class="simple">
<li><p>Using Newton’s second law we have equations of the type <span class="math notranslate nohighlight">\(\boldsymbol{F}=m\boldsymbol{a}=md\boldsymbol{v}/dt\)</span></p></li>
<li><p>We need to  define the initial conditions (typically the initial velocity and position as functions of time) and/or initial conditions and boundary conditions</p></li>
<li><p>The solution of the equations give us then the position, the velocity and other time-dependent quantities which may specify the motion of a given object.</p></li>
</ol>
<p>We are not yet done. With our lovely solvers, we need to start thinking.</p>
<p>Now it is time to ask the big questions. What do our results mean? Can we give a simple interpretation in terms of fundamental laws?  What do our results mean? Are they correct?
Thus, typical questions we may ask are</p>
<ol class="simple">
<li><p>Are our results for say <span class="math notranslate nohighlight">\(\boldsymbol{r}(t)\)</span> valid?  Do we trust what we did?  Can you validate and verify the correctness of your results?</p></li>
<li><p>Evaluate the answers and their implications</p></li>
<li><p>Compare with experimental data if possible. Does our model make sense?</p></li>
<li><p>and obviously many other questions.</p></li>
</ol>
<p>The analysis stage feeds back to the first stage. It may happen that
the data we had were not good enough, there could be large statistical
uncertainties. We may need to collect more data or perhaps we did a
sloppy job in identifying the degrees of freedom.</p>
<p>All these steps are essential elements in a scientific
enquiry. Hopefully, through a mix of numerical simulations, analytical
calculations and experiments we may gain a deeper insight about the
physics of a specific system.</p>
<p>Let us now remind ourselves of Newton’s laws, since these are the laws of motion we will study in this course.</p>
</div>
<div class="section" id="newton-s-laws">
<h2>Newton’s Laws<a class="headerlink" href="#newton-s-laws" title="Permalink to this headline">¶</a></h2>
<p>When analyzing a physical system we normally start with distinguishing between the object we are studying (we will label this in more general terms as our <strong>system</strong>) and how this system interacts with the environment (which often means everything else!)</p>
<p>In our investigations we will thus analyze a specific physics problem in terms of the system and the environment.
In doing so we need to identify the forces that act on the system and assume that the
forces acting on the system must have a source, an identifiable cause in
the environment.</p>
<p>A force acting on for example a falling object must be related to an interaction with something in the environment.
This also means that we do not consider internal forces. The latter are forces between
one part of the object and another part. In this course we will mainly focus on external forces.</p>
<p>Forces are either contact forces or long-range forces.</p>
<p>Contact forces, as evident from the name, are forces that occur at the contact between
the system and the environment. Well-known long-range forces are the gravitional force and the electromagnetic force.</p>
</div>
<div class="section" id="setting-up-a-model-for-forces-acting-on-an-object">
<h2>Setting up a model for forces acting on an object<a class="headerlink" href="#setting-up-a-model-for-forces-acting-on-an-object" title="Permalink to this headline">¶</a></h2>
<p>In order to set up the forces which act on an object, the following steps may be useful</p>
<ol class="simple">
<li><p>Divide the problem into system and environment.</p></li>
<li><p>Draw a figure of the object and everything in contact with the object.</p></li>
<li><p>Draw a closed curve around the system.</p></li>
<li><p>Find contact points—these are the points where contact forces may act.</p></li>
<li><p>Give names and symbols to all the contact forces.</p></li>
<li><p>Identify the long-range forces.</p></li>
<li><p>Make a drawing of the object. Draw the forces as arrows, vectors, starting from where the force is acting. The direction of the vector(s) indicates the (positive) direction of the force. Try to make the length of the arrow indicate the relative magnitude of the forces.</p></li>
<li><p>Draw in the axes of the coordinate system. It is often convenient to make one axis parallel to the direction of motion. When you choose the direction of the axis you also choose the positive direction for the axis.</p></li>
</ol>
</div>
<div class="section" id="newton-s-laws-the-second-one-first">
<h2>Newton’s Laws, the Second one first<a class="headerlink" href="#newton-s-laws-the-second-one-first" title="Permalink to this headline">¶</a></h2>
<p>Newton’s second law of motion: The force <span class="math notranslate nohighlight">\(\boldsymbol{F}\)</span> on an object of inertial mass <span class="math notranslate nohighlight">\(m\)</span>
is related to the acceleration a of the object through</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F} = m\boldsymbol{a},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{a}\)</span> is the acceleration.</p>
<p>Newton’s laws of motion are laws of nature that have been found by experimental
investigations and have been shown to hold up to continued experimental investigations.
Newton’s laws are valid over a wide range of length- and time-scales. We
use Newton’s laws of motion to describe everything from the motion of atoms to the
motion of galaxies.</p>
<p>The second law is a vector equation with the acceleration having the same
direction as the force. The acceleration is proportional to the force via the mass <span class="math notranslate nohighlight">\(m\)</span> of the system under study.</p>
<p>Newton’s second law introduces a new property of an object, the so-called
inertial mass <span class="math notranslate nohighlight">\(m\)</span>. We determine the inertial mass of an object by measuring the
acceleration for a given applied force.</p>
</div>
<div class="section" id="then-the-first-law">
<h2>Then the First Law<a class="headerlink" href="#then-the-first-law" title="Permalink to this headline">¶</a></h2>
<p>What happens if the net external force on a body is zero? Applying Newton’s second
law, we find:</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F} = 0 = m\boldsymbol{a},
\]</div>
<p>which gives using the definition of the acceleration</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{a} = \frac{d\boldsymbol{v}}{dt}=0.
\]</div>
<p>The acceleration is zero, which means that the velocity of the object is constant. This
is often referred to as Newton’s first law. An object in a state of uniform motion tends to remain in
that state unless an external force changes its state of motion.
Why do we need a separate law for this? Is it not simply a special case of Newton’s
second law? Yes, Newton’s first law can be deduced from the second law as we have
illustrated. However, the first law is often used for a different purpose: Newton’s
First Law tells us about the limit of applicability of Newton’s Second law. Newton’s
Second law can only be used in reference systems where the First law is obeyed. But
is not the First law always valid? No! The First law is only valid in reference systems
that are not accelerated. If you observe the motion of a ball from an accelerating
car, the ball will appear to accelerate even if there are no forces acting on it. We call
systems that are not accelerating inertial systems, and Newton’s first law is often
called the law of inertia. Newton’s first and second laws of motion are only valid in
inertial systems.</p>
<p>A system is an inertial system if it is not accelerated. It means that the reference system
must not be accelerating linearly or rotating. Unfortunately, this means that most
systems we know are not really inertial systems. For example, the surface of the
Earth is clearly not an inertial system, because the Earth is rotating. The Earth is also
not an inertial system, because it ismoving in a curved path around the Sun. However,
even if the surface of the Earth is not strictly an inertial system, it may be considered
to be approximately an inertial system for many laboratory-size experiments.</p>
</div>
<div class="section" id="and-finally-the-third-law">
<h2>And finally the Third Law<a class="headerlink" href="#and-finally-the-third-law" title="Permalink to this headline">¶</a></h2>
<p>If there is a force from object A on object B, there is also a force from object B on object A.
This fundamental principle of interactions is called Newton’s third law. We do not
know of any force that do not obey this law: All forces appear in pairs. Newton’s
third law is usually formulated as: For every action there is an equal and opposite
reaction.</p>
</div>
<div class="section" id="motion-of-a-single-object">
<h2>Motion of a Single Object<a class="headerlink" href="#motion-of-a-single-object" title="Permalink to this headline">¶</a></h2>
<p>Here we consider the motion of a single particle moving under
the influence of some set of forces.  We will consider some problems where
the force does not depend on the position. In that case Newton’s law
<span class="math notranslate nohighlight">\(m\dot{\boldsymbol{v}}=\boldsymbol{F}(\boldsymbol{v})\)</span> is a first-order differential
equation and one solves for <span class="math notranslate nohighlight">\(\boldsymbol{v}(t)\)</span>, then moves on to integrate
<span class="math notranslate nohighlight">\(\boldsymbol{v}\)</span> to get the position. In essentially all of these cases we cna find an analytical solution.</p>
</div>
<div class="section" id="air-resistance-in-one-dimension">
<h2>Air Resistance in One Dimension<a class="headerlink" href="#air-resistance-in-one-dimension" title="Permalink to this headline">¶</a></h2>
<p>Air resistance tends to scale as the square of the velocity. This is
in contrast to many problems chosen for textbooks, where it is linear
in the velocity. The choice of a linear dependence is motivated by
mathematical simplicity (it keeps the differential equation linear)
rather than by physics. One can see that the force should be quadratic
in velocity by considering the momentum imparted on the air
molecules. If an object sweeps through a volume <span class="math notranslate nohighlight">\(dV\)</span> of air in time
<span class="math notranslate nohighlight">\(dt\)</span>, the momentum imparted on the air is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto1"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
dP=\rho_m dV v,
\label{_auto1} \tag{1}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(v\)</span> is the velocity of the object and <span class="math notranslate nohighlight">\(\rho_m\)</span> is the mass
density of the air. If the molecules bounce back as opposed to stop
you would double the size of the term. The opposite value of the
momentum is imparted onto the object itself. Geometrically, the
differential volume is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto2"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
dV=Avdt,
\label{_auto2} \tag{2}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is the cross-sectional area and <span class="math notranslate nohighlight">\(vdt\)</span> is the distance the
object moved in time <span class="math notranslate nohighlight">\(dt\)</span>.</p>
</div>
<div class="section" id="resulting-acceleration">
<h2>Resulting Acceleration<a class="headerlink" href="#resulting-acceleration" title="Permalink to this headline">¶</a></h2>
<p>Plugging this into the expression above,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto3"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{dP}{dt}=-\rho_m A v^2.
\label{_auto3} \tag{3}
\end{equation}
\]</div>
<p>This is the force felt by the particle, and is opposite to its
direction of motion. Now, because air doesn’t stop when it hits an
object, but flows around the best it can, the actual force is reduced
by a dimensionless factor <span class="math notranslate nohighlight">\(c_W\)</span>, called the drag coefficient.</p>
<!-- Equation labels as ordinary links -->
<div id="_auto4"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
F_{\rm drag}=-c_W\rho_m Av^2,
\label{_auto4} \tag{4}
\end{equation}
\]</div>
<p>and the acceleration is</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\frac{dv}{dt}=-\frac{c_W\rho_mA}{m}v^2.
\end{eqnarray}
\]</div>
<p>For a particle with initial velocity <span class="math notranslate nohighlight">\(v_0\)</span>, one can separate the <span class="math notranslate nohighlight">\(dt\)</span>
to one side of the equation, and move everything with <span class="math notranslate nohighlight">\(v\)</span>s to the
other side. We did this in our discussion of simple motion and will not repeat it here.</p>
<p>On more general terms,
for many systems, e.g. an automobile, there are multiple sources of
resistance. In addition to wind resistance, where the force is
proportional to <span class="math notranslate nohighlight">\(v^2\)</span>, there are dissipative effects of the tires on
the pavement, and in the axel and drive train. These other forces can
have components that scale proportional to <span class="math notranslate nohighlight">\(v\)</span>, and components that
are independent of <span class="math notranslate nohighlight">\(v\)</span>. Those independent of <span class="math notranslate nohighlight">\(v\)</span>, e.g. the usual
<span class="math notranslate nohighlight">\(f=\mu_K N\)</span> frictional force you consider in your first Physics courses, only set in
once the object is actually moving. As speeds become higher, the <span class="math notranslate nohighlight">\(v^2\)</span>
components begin to dominate relative to the others. For automobiles
at freeway speeds, the <span class="math notranslate nohighlight">\(v^2\)</span> terms are largely responsible for the
loss of efficiency. To travel a distance <span class="math notranslate nohighlight">\(L\)</span> at fixed speed <span class="math notranslate nohighlight">\(v\)</span>, the
energy/work required to overcome the dissipative forces are <span class="math notranslate nohighlight">\(fL\)</span>,
which for a force of the form <span class="math notranslate nohighlight">\(f=\alpha v^n\)</span> becomes</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
W=\int dx~f=\alpha v^n L.
\end{eqnarray}
\]</div>
<p>For <span class="math notranslate nohighlight">\(n=0\)</span> the work is
independent of speed, but for the wind resistance, where <span class="math notranslate nohighlight">\(n=2\)</span>,
slowing down is essential if one wishes to reduce fuel consumption. It
is also important to consider that engines are designed to be most
efficient at a chosen range of power output. Thus, some cars will get
better mileage at higher speeds (They perform better at 50 mph than at
5 mph) despite the considerations mentioned above.</p>
</div>
<div class="section" id="going-ballistic-projectile-motion-or-a-softer-approach-falling-raindrops">
<h2>Going Ballistic, Projectile Motion or a Softer Approach, Falling Raindrops<a class="headerlink" href="#going-ballistic-projectile-motion-or-a-softer-approach-falling-raindrops" title="Permalink to this headline">¶</a></h2>
<p>As an example of Newton’s Laws we consider projectile motion (or a
falling raindrop or a ball we throw up in the air) with a drag force. Even though air resistance is
largely proportional to the square of the velocity, we will consider
the drag force to be linear to the velocity, <span class="math notranslate nohighlight">\(\boldsymbol{F}=-m\gamma\boldsymbol{v}\)</span>,
for the purposes of this exercise. The acceleration for a projectile moving upwards,
<span class="math notranslate nohighlight">\(\boldsymbol{a}=\boldsymbol{F}/m\)</span>, becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{dv_x}{dt}=-\gamma v_x,\\
\nonumber
\frac{dv_y}{dt}=-\gamma v_y-g,
\end{eqnarray}
\end{split}\]</div>
<p>and <span class="math notranslate nohighlight">\(\gamma\)</span> has dimensions of inverse time.</p>
<p>If you on the other hand have a falling raindrop, how do these equations change? See for example Figure 2.1 in Taylor.
Let us stay with a ball which is thrown up in the air at <span class="math notranslate nohighlight">\(t=0\)</span>.</p>
</div>
<div class="section" id="ways-of-solving-these-equations">
<h2>Ways of solving these equations<a class="headerlink" href="#ways-of-solving-these-equations" title="Permalink to this headline">¶</a></h2>
<p>We will go over two different ways to solve this equation. The first
by direct integration, and the second as a differential equation. To
do this by direct integration, one simply multiplies both sides of the
equations above by <span class="math notranslate nohighlight">\(dt\)</span>, then divide by the appropriate factors so
that the <span class="math notranslate nohighlight">\(v\)</span>s are all on one side of the equation and the <span class="math notranslate nohighlight">\(dt\)</span> is on
the other. For the <span class="math notranslate nohighlight">\(x\)</span> motion one finds an easily integrable equation,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{dv_x}{v_x}&amp;=&amp;-\gamma dt,\\
\nonumber
\int_{v_{0x}}^{v_{x}}\frac{dv_x}{v_x}&amp;=&amp;-\gamma\int_0^{t}dt,\\
\nonumber
\ln\left(\frac{v_{x}}{v_{0x}}\right)&amp;=&amp;-\gamma t,\\
\nonumber
v_{x}(t)&amp;=&amp;v_{0x}e^{-\gamma t}.
\end{eqnarray}
\end{split}\]</div>
<p>This is very much the result you would have written down
by inspection. For the <span class="math notranslate nohighlight">\(y\)</span>-component of the velocity,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{dv_y}{v_y+g/\gamma}&amp;=&amp;-\gamma dt\\
\nonumber
\ln\left(\frac{v_{y}+g/\gamma}{v_{0y}-g/\gamma}\right)&amp;=&amp;-\gamma t_f,\\
\nonumber
v_{fy}&amp;=&amp;-\frac{g}{\gamma}+\left(v_{0y}+\frac{g}{\gamma}\right)e^{-\gamma t}.
\end{eqnarray}
\end{split}\]</div>
<p>Whereas <span class="math notranslate nohighlight">\(v_x\)</span> starts at some value and decays
exponentially to zero, <span class="math notranslate nohighlight">\(v_y\)</span> decays exponentially to the terminal
velocity, <span class="math notranslate nohighlight">\(v_t=-g/\gamma\)</span>.</p>
</div>
<div class="section" id="solving-as-differential-equations">
<h2>Solving as differential equations<a class="headerlink" href="#solving-as-differential-equations" title="Permalink to this headline">¶</a></h2>
<p>Although this direct integration is simpler than the method we invoke
below, the method below will come in useful for some slightly more
difficult differential equations in the future. The differential
equation for <span class="math notranslate nohighlight">\(v_x\)</span> is straight-forward to solve. Because it is first
order there is one arbitrary constant, <span class="math notranslate nohighlight">\(A\)</span>, and by inspection the
solution is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto5"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_x=Ae^{-\gamma t}.
\label{_auto5} \tag{5}
\end{equation}
\]</div>
<p>The arbitrary constants for equations of motion are usually determined
by the initial conditions, or more generally boundary conditions. By
inspection <span class="math notranslate nohighlight">\(A=v_{0x}\)</span>, the initial <span class="math notranslate nohighlight">\(x\)</span> component of the velocity.</p>
</div>
<div class="section" id="differential-equations-contn">
<h2>Differential Equations, contn<a class="headerlink" href="#differential-equations-contn" title="Permalink to this headline">¶</a></h2>
<p>The differential equation for <span class="math notranslate nohighlight">\(v_y\)</span> is a bit more complicated due to
the presence of <span class="math notranslate nohighlight">\(g\)</span>. Differential equations where all the terms are
linearly proportional to a function, in this case <span class="math notranslate nohighlight">\(v_y\)</span>, or to
derivatives of the function, e.g., <span class="math notranslate nohighlight">\(v_y\)</span>, <span class="math notranslate nohighlight">\(dv_y/dt\)</span>,
<span class="math notranslate nohighlight">\(d^2v_y/dt^2\cdots\)</span>, are called linear differential equations. If
there are terms proportional to <span class="math notranslate nohighlight">\(v^2\)</span>, as would happen if the drag
force were proportional to the square of the velocity, the
differential equation is not longer linear. Because this expression
has only one derivative in <span class="math notranslate nohighlight">\(v\)</span> it is a first-order linear differential
equation. If a term were added proportional to <span class="math notranslate nohighlight">\(d^2v/dt^2\)</span> it would be
a second-order differential equation.  In this case we have a term
completely independent of <span class="math notranslate nohighlight">\(v\)</span>, the gravitational acceleration <span class="math notranslate nohighlight">\(g\)</span>, and
the usual strategy is to first rewrite the equation with all the
linear terms on one side of the equal sign,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto6"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{dv_y}{dt}+\gamma v_y=-g.
\label{_auto6} \tag{6}
\end{equation}
\]</div>
</div>
<div class="section" id="splitting-into-two-parts">
<h2>Splitting into two parts<a class="headerlink" href="#splitting-into-two-parts" title="Permalink to this headline">¶</a></h2>
<p>Now, the solution to the equation can be broken into two
parts. Because this is a first-order differential equation we know
that there will be one arbitrary constant. Physically, the arbitrary
constant will be determined by setting the initial velocity, though it
could be determined by setting the velocity at any given time. Like
most differential equations, solutions are not “solved”. Instead,
one guesses at a form, then shows the guess is correct. For these
types of equations, one first tries to find a single solution,
i.e. one with no arbitrary constants. This is called the {\it
particular} solution, <span class="math notranslate nohighlight">\(y_p(t)\)</span>, though it should really be called
“a” particular solution because there are an infinite number of such
solutions. One then finds a solution to the {\it homogenous} equation,
which is the equation with zero on the right-hand side,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto7"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{dv_{y,h}}{dt}+\gamma v_{y,h}=0.
\label{_auto7} \tag{7}
\end{equation}
\]</div>
<p>Homogenous solutions will have arbitrary constants.</p>
<p>The particular solution will solve the same equation as the original
general equation</p>
<!-- Equation labels as ordinary links -->
<div id="_auto8"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{dv_{y,p}}{dt}+\gamma v_{y,p}=-g.
\label{_auto8} \tag{8}
\end{equation}
\]</div>
<p>However, we don’t need find one with arbitrary constants. Hence, it is
called a <strong>particular</strong> solution.</p>
<p>The sum of the two,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto9"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_y=v_{y,p}+v_{y,h},
\label{_auto9} \tag{9}
\end{equation}
\]</div>
<p>is a solution of the total equation because of the linear nature of
the differential equation. One has now found a <em>general</em> solution
encompassing all solutions, because it both satisfies the general
equation (like the particular solution), and has an arbitrary constant
that can be adjusted to fit any initial condition (like the homogneous
solution). If the equation were not linear, e.g if there were a term
such as <span class="math notranslate nohighlight">\(v_y^2\)</span> or <span class="math notranslate nohighlight">\(v_y\dot{v}_y\)</span>, this technique would not work.</p>
</div>
<div class="section" id="more-details">
<h2>More details<a class="headerlink" href="#more-details" title="Permalink to this headline">¶</a></h2>
<p>Returning to the example above, the homogenous solution is the same as
that for <span class="math notranslate nohighlight">\(v_x\)</span>, because there was no gravitational acceleration in
that case,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto10"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_{y,h}=Be^{-\gamma t}.
\label{_auto10} \tag{10}
\end{equation}
\]</div>
<p>In this case a particular solution is one with constant velocity,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto11"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_{y,p}=-g/\gamma.
\label{_auto11} \tag{11}
\end{equation}
\]</div>
<p>Note that this is the terminal velocity of a particle falling from a
great height. The general solution is thus,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto12"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_y=Be^{-\gamma t}-g/\gamma,
\label{_auto12} \tag{12}
\end{equation}
\]</div>
<p>and one can find <span class="math notranslate nohighlight">\(B\)</span> from the initial velocity,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto13"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_{0y}=B-g/\gamma,~~~B=v_{0y}+g/\gamma.
\label{_auto13} \tag{13}
\end{equation}
\]</div>
<p>Plugging in the expression for <span class="math notranslate nohighlight">\(B\)</span> gives the <span class="math notranslate nohighlight">\(y\)</span> motion given the initial velocity,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto14"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_y=(v_{0y}+g/\gamma)e^{-\gamma t}-g/\gamma.
\label{_auto14} \tag{14}
\end{equation}
\]</div>
<p>It is easy to see that this solution has <span class="math notranslate nohighlight">\(v_y=v_{0y}\)</span> when <span class="math notranslate nohighlight">\(t=0\)</span> and
<span class="math notranslate nohighlight">\(v_y=-g/\gamma\)</span> when <span class="math notranslate nohighlight">\(t\rightarrow\infty\)</span>.</p>
<p>One can also integrate the two equations to find the coordinates <span class="math notranslate nohighlight">\(x\)</span>
and <span class="math notranslate nohighlight">\(y\)</span> as functions of <span class="math notranslate nohighlight">\(t\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
x&amp;=&amp;\int_0^t dt'~v_{0x}(t')=\frac{v_{0x}}{\gamma}\left(1-e^{-\gamma t}\right),\\
\nonumber
y&amp;=&amp;\int_0^t dt'~v_{0y}(t')=-\frac{gt}{\gamma}+\frac{v_{0y}+g/\gamma}{\gamma}\left(1-e^{-\gamma t}\right).
\end{eqnarray}
\end{split}\]</div>
<p>If the question was to find the position at a time <span class="math notranslate nohighlight">\(t\)</span>, we would be
finished. However, the more common goal in a projectile equation
problem is to find the range, i.e. the distance <span class="math notranslate nohighlight">\(x\)</span> at which <span class="math notranslate nohighlight">\(y\)</span>
returns to zero. For the case without a drag force this was much
simpler. The solution for the <span class="math notranslate nohighlight">\(y\)</span> coordinate would have been
<span class="math notranslate nohighlight">\(y=v_{0y}t-gt^2/2\)</span>. One would solve for <span class="math notranslate nohighlight">\(t\)</span> to make <span class="math notranslate nohighlight">\(y=0\)</span>, which would
be <span class="math notranslate nohighlight">\(t=2v_{0y}/g\)</span>, then plug that value for <span class="math notranslate nohighlight">\(t\)</span> into <span class="math notranslate nohighlight">\(x=v_{0x}t\)</span> to
find <span class="math notranslate nohighlight">\(x=2v_{0x}v_{0y}/g=v_0\sin(2\theta_0)/g\)</span>. One follows the same
steps here, except that the expression for <span class="math notranslate nohighlight">\(y(t)\)</span> is more
complicated. Searching for the time where <span class="math notranslate nohighlight">\(y=0\)</span>, and we get</p>
<!-- Equation labels as ordinary links -->
<div id="_auto15"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
0=-\frac{gt}{\gamma}+\frac{v_{0y}+g/\gamma}{\gamma}\left(1-e^{-\gamma t}\right).
\label{_auto15} \tag{15}
\end{equation}
\]</div>
<p>This cannot be inverted into a simple expression <span class="math notranslate nohighlight">\(t=\cdots\)</span>. Such
expressions are known as “transcendental equations”, and are not the
rare instance, but are the norm. In the days before computers, one
might plot the right-hand side of the above graphically as
a function of time, then find the point where it crosses zero.</p>
<p>Now, the most common way to solve for an equation of the above type
would be to apply Newton’s method numerically. This involves the
following algorithm for finding solutions of some equation <span class="math notranslate nohighlight">\(F(t)=0\)</span>.</p>
<ol class="simple">
<li><p>First guess a value for the time, <span class="math notranslate nohighlight">\(t_{\rm guess}\)</span>.</p></li>
<li><p>Calculate <span class="math notranslate nohighlight">\(F\)</span> and its derivative, <span class="math notranslate nohighlight">\(F(t_{\rm guess})\)</span> and <span class="math notranslate nohighlight">\(F'(t_{\rm guess})\)</span>.</p></li>
<li><p>Unless you guessed perfectly, <span class="math notranslate nohighlight">\(F\ne 0\)</span>, and assuming that <span class="math notranslate nohighlight">\(\Delta F\approx F'\Delta t\)</span>, one would choose</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta t=-F(t_{\rm guess})/F'(t_{\rm guess})\)</span>.</p></li>
<li><p>Now repeat step 1, but with <span class="math notranslate nohighlight">\(t_{\rm guess}\rightarrow t_{\rm guess}+\Delta t\)</span>.</p></li>
</ol>
<p>If the <span class="math notranslate nohighlight">\(F(t)\)</span> were perfectly linear in <span class="math notranslate nohighlight">\(t\)</span>, one would find <span class="math notranslate nohighlight">\(t\)</span> in one
step. Instead, one typically finds a value of <span class="math notranslate nohighlight">\(t\)</span> that is closer to
the final answer than <span class="math notranslate nohighlight">\(t_{\rm guess}\)</span>. One breaks the loop once one
finds <span class="math notranslate nohighlight">\(F\)</span> within some acceptable tolerance of zero. A program to do
this will be added shortly.</p>
</div>
<div class="section" id="motion-in-a-magnetic-field">
<h2>Motion in a Magnetic Field<a class="headerlink" href="#motion-in-a-magnetic-field" title="Permalink to this headline">¶</a></h2>
<p>Another example of a velocity-dependent force is magnetism,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\boldsymbol{F}&amp;=&amp;q\boldsymbol{v}\times\boldsymbol{B},\\
\nonumber
F_i&amp;=&amp;q\sum_{jk}\epsilon_{ijk}v_jB_k.
\end{eqnarray}
\end{split}\]</div>
<p>For a uniform field in the <span class="math notranslate nohighlight">\(z\)</span> direction <span class="math notranslate nohighlight">\(\boldsymbol{B}=B\hat{z}\)</span>, the force can only have <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> components,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
F_x&amp;=&amp;qBv_y\\
\nonumber
F_y&amp;=&amp;-qBv_x.
\end{eqnarray}
\end{split}\]</div>
<p>The differential equations are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\dot{v}_x&amp;=&amp;\omega_c v_y,\omega_c= qB/m\\
\nonumber
\dot{v}_y&amp;=&amp;-\omega_c v_x.
\end{eqnarray}
\end{split}\]</div>
<p>One can solve the equations by taking time derivatives of either equation, then substituting into the other equation,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\ddot{v}_x=\omega_c\dot{v_y}=-\omega_c^2v_x,\\
\nonumber
\ddot{v}_y&amp;=&amp;-\omega_c\dot{v}_x=-\omega_cv_y.
\end{eqnarray}
\end{split}\]</div>
<p>The solution to these equations can be seen by inspection,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
v_x&amp;=&amp;A\sin(\omega_ct+\phi),\\
\nonumber
v_y&amp;=&amp;A\cos(\omega_ct+\phi).
\end{eqnarray}
\end{split}\]</div>
<p>One can integrate the equations to find the positions as a function of time,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
x-x_0&amp;=&amp;\int_{x_0}^x dx=\int_0^t dt v(t)\\
\nonumber
&amp;=&amp;\frac{-A}{\omega_c}\cos(\omega_ct+\phi),\\
\nonumber
y-y_0&amp;=&amp;\frac{A}{\omega_c}\sin(\omega_ct+\phi).
\end{eqnarray}
\end{split}\]</div>
<p>The trajectory is a circle centered at <span class="math notranslate nohighlight">\(x_0,y_0\)</span> with amplitude <span class="math notranslate nohighlight">\(A\)</span> rotating in the clockwise direction.</p>
<p>The equations of motion for the <span class="math notranslate nohighlight">\(z\)</span> motion are</p>
<!-- Equation labels as ordinary links -->
<div id="_auto16"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\dot{v_z}=0,
\label{_auto16} \tag{16}
\end{equation}
\]</div>
<p>which leads to</p>
<!-- Equation labels as ordinary links -->
<div id="_auto17"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
z-z_0=V_zt.
\label{_auto17} \tag{17}
\end{equation}
\]</div>
<p>Added onto the circle, the motion is helical.</p>
<p>Note that the kinetic energy,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto18"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
T=\frac{1}{2}m(v_x^2+v_y^2+v_z^2)=\frac{1}{2}m(\omega_c^2A^2+V_z^2),
\label{_auto18} \tag{18}
\end{equation}
\]</div>
<p>is constant. This is because the force is perpendicular to the
velocity, so that in any differential time element <span class="math notranslate nohighlight">\(dt\)</span> the work done
on the particle <span class="math notranslate nohighlight">\(\boldsymbol{F}\cdot{dr}=dt\boldsymbol{F}\cdot{v}=0\)</span>.</p>
<p>One should think about the implications of a velocity dependent
force. Suppose one had a constant magnetic field in deep space. If a
particle came through with velocity <span class="math notranslate nohighlight">\(v_0\)</span>, it would undergo cyclotron
motion with radius <span class="math notranslate nohighlight">\(R=v_0/\omega_c\)</span>. However, if it were still its
motion would remain fixed. Now, suppose an observer looked at the
particle in one reference frame where the particle was moving, then
changed their velocity so that the particle’s velocity appeared to be
zero. The motion would change from circular to fixed. Is this
possible?</p>
<p>The solution to the puzzle above relies on understanding
relativity. Imagine that the first observer believes <span class="math notranslate nohighlight">\(\boldsymbol{B}\ne 0\)</span> and
that the electric field <span class="math notranslate nohighlight">\(\boldsymbol{E}=0\)</span>. If the observer then changes
reference frames by accelerating to a velocity <span class="math notranslate nohighlight">\(\boldsymbol{v}\)</span>, in the new
frame <span class="math notranslate nohighlight">\(\boldsymbol{B}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{E}\)</span> both change. If the observer moved to the
frame where the charge, originally moving with a small velocity <span class="math notranslate nohighlight">\(v\)</span>,
is now at rest, the new electric field is indeed <span class="math notranslate nohighlight">\(\boldsymbol{v}\times\boldsymbol{B}\)</span>,
which then leads to the same acceleration as one had before. If the
velocity is not small compared to the speed of light, additional
<span class="math notranslate nohighlight">\(\gamma\)</span> factors come into play,
<span class="math notranslate nohighlight">\(\gamma=1/\sqrt{1-(v/c)^2}\)</span>. Relativistic motion will not be
considered in this course.</p>
</div>
<div class="section" id="sliding-block-tied-to-a-wall">
<h2>Sliding Block tied to a Wall<a class="headerlink" href="#sliding-block-tied-to-a-wall" title="Permalink to this headline">¶</a></h2>
<p>Another classical case is that of simple harmonic oscillations, here represented by a block sliding on a horizontal frictionless surface. The block is tied to a wall with a spring. If the spring is not compressed or stretched too far, the force on the block at a given position <span class="math notranslate nohighlight">\(x\)</span> is</p>
<div class="math notranslate nohighlight">
\[
F=-kx.
\]</div>
<p>The negative sign means that the force acts to restore the object to an equilibrium position. Newton’s equation of motion for this idealized system is then</p>
<div class="math notranslate nohighlight">
\[
m\frac{d^2x}{dt^2}=-kx,
\]</div>
<p>or we could rephrase it as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:newton1"></div>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{dt^2}=-\frac{k}{m}x=-\omega_0^2x,
\label{eq:newton1} \tag{19}
\]</div>
<p>with the angular frequency <span class="math notranslate nohighlight">\(\omega_0^2=k/m\)</span>.</p>
<p>The above differential equation has the advantage that it can be solved  analytically with solutions on the form</p>
<div class="math notranslate nohighlight">
\[
x(t)=Acos(\omega_0t+\nu),
\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is the amplitude and <span class="math notranslate nohighlight">\(\nu\)</span> the phase constant.   This provides in turn an important test for the numerical
solution and the development of a program for more complicated cases which cannot be solved analytically.</p>
<p>With the position <span class="math notranslate nohighlight">\(x(t)\)</span> and the velocity  <span class="math notranslate nohighlight">\(v(t)=dx/dt\)</span> we can reformulate Newton’s equation in the following way</p>
<div class="math notranslate nohighlight">
\[
\frac{dx(t)}{dt}=v(t),
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dv(t)}{dt}=-\omega_0^2x(t).
\]</div>
<p>We are now going to solve these equations using first the standard forward Euler  method. Later we will try to improve upon this.</p>
<p>Before proceeding however, it is important to note that in addition to the exact solution, we have at least two further tests which can be used to check our solution.</p>
<p>Since functions like <span class="math notranslate nohighlight">\(cos\)</span> are periodic with a period <span class="math notranslate nohighlight">\(2\pi\)</span>, then the solution <span class="math notranslate nohighlight">\(x(t)\)</span> has also to be periodic. This means that</p>
<div class="math notranslate nohighlight">
\[
x(t+T)=x(t),
\]</div>
<p>with <span class="math notranslate nohighlight">\(T\)</span> the period defined as</p>
<div class="math notranslate nohighlight">
\[
T=\frac{2\pi}{\omega_0}=\frac{2\pi}{\sqrt{k/m}}.
\]</div>
<p>Observe that <span class="math notranslate nohighlight">\(T\)</span> depends only on <span class="math notranslate nohighlight">\(k/m\)</span> and not on the amplitude of the solution.</p>
<p>In addition to the periodicity test, the total energy has also to be conserved.</p>
<p>Suppose we choose the initial conditions</p>
<div class="math notranslate nohighlight">
\[
x(t=0)=1\hspace{0.1cm} \mathrm{m}\hspace{1cm} v(t=0)=0\hspace{0.1cm}\mathrm{m/s},
\]</div>
<p>meaning that block is at rest at <span class="math notranslate nohighlight">\(t=0\)</span> but with a potential energy</p>
<div class="math notranslate nohighlight">
\[
E_0=\frac{1}{2}kx(t=0)^2=\frac{1}{2}k.
\]</div>
<p>The total energy at any time <span class="math notranslate nohighlight">\(t\)</span> has however to be conserved, meaning that our solution has to fulfil the condition</p>
<div class="math notranslate nohighlight">
\[
E_0=\frac{1}{2}kx(t)^2+\frac{1}{2}mv(t)^2.
\]</div>
<p>We will derive this equation in our discussion on <a class="reference external" href="https://mhjensen.github.io/Physics321/doc/pub/energyconserv/html/energyconserv.html">energy conservation</a>.</p>
<p>An algorithm which implements these equations is included below.</p>
<ul class="simple">
<li><p>Choose the initial position and speed, with the most common choice <span class="math notranslate nohighlight">\(v(t=0)=0\)</span> and some fixed value for the position.</p></li>
<li><p>Choose the method you wish to employ in solving the problem.</p></li>
<li><p>Subdivide the time interval <span class="math notranslate nohighlight">\([t_i,t_f] \)</span> into a grid with step size</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
h=\frac{t_f-t_i}{N},
\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the number of mesh points.</p>
<ul class="simple">
<li><p>Calculate now the total energy given by</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
E_0=\frac{1}{2}kx(t=0)^2=\frac{1}{2}k.
\]</div>
<ul class="simple">
<li><p>Choose ODE solver to obtain <span class="math notranslate nohighlight">\(x_{i+1}\)</span> and <span class="math notranslate nohighlight">\(v_{i+1}\)</span> starting from the previous values <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(v_i\)</span>.</p></li>
<li><p>When we have computed <span class="math notranslate nohighlight">\(x(v)_{i+1}\)</span> we upgrade  <span class="math notranslate nohighlight">\(t_{i+1}=t_i+h\)</span>.</p></li>
<li><p>This iterative  process continues till we reach the maximum time <span class="math notranslate nohighlight">\(t_f\)</span>.</p></li>
<li><p>The results are checked against the exact solution. Furthermore, one has to check the stability of the numerical solution against the chosen number of mesh points <span class="math notranslate nohighlight">\(N\)</span>.</p></li>
</ul>
<p>The following python program ( code will be added shortly)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># This program solves Newtons equation for a block sliding on</span>
<span class="c1"># an horizontal frictionless surface.</span>
<span class="c1"># The block is tied to the wall with a spring, so N&#39;s eq takes the form:</span>
<span class="c1">#</span>
<span class="c1">#  m d^2x/dt^2 = - kx</span>
<span class="c1">#</span>
<span class="c1"># In order to make the solution dimless, we set k/m = 1.</span>
<span class="c1"># This results in two coupled diff. eq&#39;s that may be written as:</span>
<span class="c1">#</span>
<span class="c1">#  dx/dt = v</span>
<span class="c1">#  dv/dt = -x</span>
<span class="c1">#</span>
<span class="c1"># The user has to specify the initial velocity and position,</span>
<span class="c1"># and the number of steps. The time interval is fixed to</span>
<span class="c1"># t \in [0, 4\pi) (two periods)</span>
<span class="c1">#</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-classical-pendulum-and-scaling-the-equations">
<h2>The classical pendulum and scaling the equations<a class="headerlink" href="#the-classical-pendulum-and-scaling-the-equations" title="Permalink to this headline">¶</a></h2>
<p>The angular equation of motion of the pendulum is given by
Newton’s equation and with no external force it reads</p>
<!-- Equation labels as ordinary links -->
<div id="_auto19"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  ml\frac{d^2\theta}{dt^2}+mgsin(\theta)=0,
\label{_auto19} \tag{20}
\end{equation}
\]</div>
<p>with an angular velocity and acceleration given by</p>
<!-- Equation labels as ordinary links -->
<div id="_auto20"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
     v=l\frac{d\theta}{dt},
\label{_auto20} \tag{21}
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="_auto21"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
     a=l\frac{d^2\theta}{dt^2}.
\label{_auto21} \tag{22}
\end{equation}
\]</div>
</div>
<div class="section" id="more-on-the-pendulum">
<h2>More on the Pendulum<a class="headerlink" href="#more-on-the-pendulum" title="Permalink to this headline">¶</a></h2>
<p>We do however expect that the motion will gradually come to an end due a viscous drag torque acting on the pendulum.
In the presence of the drag, the above equation becomes</p>
<!-- Equation labels as ordinary links -->
<div id="eq:pend1"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   ml\frac{d^2\theta}{dt^2}+\nu\frac{d\theta}{dt}  +mgsin(\theta)=0, \label{eq:pend1} \tag{23}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu\)</span> is now a positive constant parameterizing the viscosity
of the medium in question. In order to maintain the motion against
viscosity, it is necessary to add some external driving force.
We choose here a periodic driving force. The last equation becomes then</p>
<!-- Equation labels as ordinary links -->
<div id="eq:pend2"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   ml\frac{d^2\theta}{dt^2}+\nu\frac{d\theta}{dt}  +mgsin(\theta)=Asin(\omega t), \label{eq:pend2} \tag{24}
\end{equation}
\]</div>
<p>with <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span> two constants representing the amplitude and
the angular frequency respectively. The latter is called the driving frequency.</p>
</div>
<div class="section" id="id1">
<h2>More on the Pendulum<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>We define</p>
<div class="math notranslate nohighlight">
\[
\omega_0=\sqrt{g/l},
\]</div>
<p>the so-called natural frequency and the new dimensionless quantities</p>
<div class="math notranslate nohighlight">
\[
\hat{t}=\omega_0t,
\]</div>
<p>with the dimensionless driving frequency</p>
<div class="math notranslate nohighlight">
\[
\hat{\omega}=\frac{\omega}{\omega_0},
\]</div>
<p>and introducing the quantity <span class="math notranslate nohighlight">\(Q\)</span>, called the <em>quality factor</em>,</p>
<div class="math notranslate nohighlight">
\[
Q=\frac{mg}{\omega_0\nu},
\]</div>
<p>and the dimensionless amplitude</p>
<div class="math notranslate nohighlight">
\[
\hat{A}=\frac{A}{mg}
\]</div>
<p>We have</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2\theta}{d\hat{t}^2}+\frac{1}{Q}\frac{d\theta}{d\hat{t}}  
     +sin(\theta)=\hat{A}cos(\hat{\omega}\hat{t}).
\]</div>
<p>This equation can in turn be recast in terms of two coupled first-order differential equations as follows</p>
<div class="math notranslate nohighlight">
\[
\frac{d\theta}{d\hat{t}}=\hat{v},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{d\hat{v}}{d\hat{t}}=-\frac{\hat{v}}{Q}-sin(\theta)+\hat{A}cos(\hat{\omega}\hat{t}).
\]</div>
<p>These are the equations to be solved.  The factor <span class="math notranslate nohighlight">\(Q\)</span> represents the number of oscillations of the undriven system that must occur before  its energy is significantly reduced due to the viscous drag. The  amplitude <span class="math notranslate nohighlight">\(\hat{A}\)</span> is measured in units of the maximum possible  gravitational torque while <span class="math notranslate nohighlight">\(\hat{\omega}\)</span> is the angular frequency of the external torque measured in units of the pendulum’s natural frequency.</p>
</div>
</div>
<div class="section" id="work-energy-momentum-and-conservation-laws">
<h1>Work, Energy, Momentum and Conservation laws<a class="headerlink" href="#work-energy-momentum-and-conservation-laws" title="Permalink to this headline">¶</a></h1>
<p>Energy conservation is most convenient as a strategy for addressing
problems where time does not appear. For example, a particle goes
from position <span class="math notranslate nohighlight">\(x_0\)</span> with speed <span class="math notranslate nohighlight">\(v_0\)</span>, to position <span class="math notranslate nohighlight">\(x_f\)</span>; what is its
new speed? However, it can also be applied to problems where time
does appear, such as in solving for the trajectory <span class="math notranslate nohighlight">\(x(t)\)</span>, or
equivalently <span class="math notranslate nohighlight">\(t(x)\)</span>.</p>
<p>More material to be added here.</p>
<div class="section" id="energy-conservation">
<h2>Energy Conservation<a class="headerlink" href="#energy-conservation" title="Permalink to this headline">¶</a></h2>
<p>Energy is conserved in the case where the potential energy, <span class="math notranslate nohighlight">\(V(\boldsymbol{r})\)</span>, depends only on position, and not on time. The force is determined by <span class="math notranslate nohighlight">\(V\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto22"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\boldsymbol{F}(\boldsymbol{r})=-\nabla V(\boldsymbol{r}).
\label{_auto22} \tag{25}
\end{equation}
\]</div>
<p>The net energy, <span class="math notranslate nohighlight">\(E=V+K\)</span> where <span class="math notranslate nohighlight">\(K\)</span> is the kinetic energy, is then conserved,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{d}{dt}(K+V)&amp;=&amp;\frac{d}{dt}\left(\frac{m}{2}(v_x^2+v_y^2+v_z^2)+V(\boldsymbol{r})\right)\\
\nonumber
&amp;=&amp;m\left(v_x\frac{dv_x}{dt}+v_y\frac{dv_y}{dt}+v_z\frac{dv_z}{dt}\right)
+\partial_xV\frac{dx}{dt}+\partial_yV\frac{dy}{dt}+\partial_zV\frac{dz}{dt}\\
\nonumber
&amp;=&amp;v_xF_x+v_yF_y+v_zF_z-F_xv_x-F_yv_y-F_zv_z=0.
\end{eqnarray}
\end{split}\]</div>
<p>The same proof can be written more compactly with vector notation,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{d}{dt}\left(\frac{m}{2}v^2+V(\boldsymbol{r})\right)
&amp;=&amp;m\boldsymbol{v}\cdot\dot{\boldsymbol{v}}+\nabla V(\boldsymbol{r})\cdot\dot{\boldsymbol{r}}\\
\nonumber
&amp;=&amp;\boldsymbol{v}\cdot\boldsymbol{F}-\boldsymbol{F}\cdot\boldsymbol{v}=0.
\end{eqnarray}
\end{split}\]</div>
<p>Inverting the expression for kinetic energy,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto23"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v=\sqrt{2K/m}=\sqrt{2(E-V)/m},
\label{_auto23} \tag{26}
\end{equation}
\]</div>
<p>allows one to solve for the one-dimensional trajectory <span class="math notranslate nohighlight">\(x(t)\)</span>, by finding <span class="math notranslate nohighlight">\(t(x)\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto24"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
t=\int_{x_0}^x \frac{dx'}{v(x')}=\int_{x_0}^x\frac{dx'}{\sqrt{2(E-V(x'))/m}}.
\label{_auto24} \tag{27}
\end{equation}
\]</div>
<p>Note this would be much more difficult in higher dimensions, because
you would have to determine which points, <span class="math notranslate nohighlight">\(x,y,z\)</span>, the particles might
reach in the trajectory, whereas in one dimension you can typically
tell by simply seeing whether the kinetic energy is positive at every
point between the old position and the new position.</p>
<p>Consider a simple harmonic oscillator potential, <span class="math notranslate nohighlight">\(V(x)=kx^2/2\)</span>, with a particle emitted from <span class="math notranslate nohighlight">\(x=0\)</span> with velocity <span class="math notranslate nohighlight">\(v_0\)</span>. Solve for the trajectory <span class="math notranslate nohighlight">\(t(x)\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
t&amp;=&amp;\int_{0}^x \frac{dx'}{\sqrt{2(E-kx^2/2)/m}}\\
\nonumber
&amp;=&amp;\sqrt{m/k}\int_0^x~\frac{dx'}{\sqrt{x_{\rm max}^2-x^{\prime 2}}},~~~x_{\rm max}^2=2E/k.
\end{eqnarray}
\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(E=mv_0^2/2\)</span> and <span class="math notranslate nohighlight">\(x_{\rm max}\)</span> is defined as the maximum
displacement before the particle turns around. This integral is done
by the substitution <span class="math notranslate nohighlight">\(\sin\theta=x/x_{\rm max}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
(k/m)^{1/2}t&amp;=&amp;\sin^{-1}(x/x_{\rm max}),\\
\nonumber
x&amp;=&amp;x_{\rm max}\sin\omega t,~~~\omega=\sqrt{k/m}.
\end{eqnarray}
\end{split}\]</div>
</div>
<div class="section" id="conservation-of-momentum">
<h2>Conservation of Momentum<a class="headerlink" href="#conservation-of-momentum" title="Permalink to this headline">¶</a></h2>
<p>Newton’s third law which we met earlier states that <strong>For every action there is an equal and opposite reaction</strong>, is more accurately stated as
<strong>If two bodies exert forces on each other, these forces are equal in magnitude and opposite in direction</strong>.</p>
<p>This means that for two bodies <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>, if the force on <span class="math notranslate nohighlight">\(i\)</span> due to <span class="math notranslate nohighlight">\(j\)</span> is called <span class="math notranslate nohighlight">\(\boldsymbol{F}_{ij}\)</span>, then</p>
<!-- Equation labels as ordinary links -->
<div id="_auto25"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\boldsymbol{F}_{ij}=-\boldsymbol{F}_{ji}. 
\label{_auto25} \tag{28}
\end{equation}
\]</div>
<p>Newton’s second law, <span class="math notranslate nohighlight">\(\boldsymbol{F}=m\boldsymbol{a}\)</span>, can be written for a particle <span class="math notranslate nohighlight">\(i\)</span> as</p>
<!-- Equation labels as ordinary links -->
<div id="_auto26"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\boldsymbol{F}_i=\sum_{j\ne i} \boldsymbol{F}_{ij}=m_i\boldsymbol{a}_i,
\label{_auto26} \tag{29}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{F}_i\)</span> (a single subscript) denotes the net force acting on <span class="math notranslate nohighlight">\(i\)</span>. Because the mass of <span class="math notranslate nohighlight">\(i\)</span> is fixed, one can see that</p>
<!-- Equation labels as ordinary links -->
<div id="_auto27"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\boldsymbol{F}_i=\frac{d}{dt}m_i\boldsymbol{v}_i=\sum_{j\ne i}\boldsymbol{F}_{ij}.
\label{_auto27} \tag{30}
\end{equation}
\]</div>
<p>Now, one can sum over all the particles and obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{d}{dt}\sum_i m_iv_i&amp;=&amp;\sum_{ij, i\ne j}\boldsymbol{F}_{ij}\\
\nonumber
&amp;=&amp;0.
\end{eqnarray}
\end{split}\]</div>
<p>The last step made use of the fact that for every term <span class="math notranslate nohighlight">\(ij\)</span>, there is
an equivalent term <span class="math notranslate nohighlight">\(ji\)</span> with opposite force. Because the momentum is
defined as <span class="math notranslate nohighlight">\(m\boldsymbol{v}\)</span>, for a system of particles,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto28"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d}{dt}\sum_im_i\boldsymbol{v}_i=0,~~{\rm for~isolated~particles}.
\label{_auto28} \tag{31}
\end{equation}
\]</div>
<p>By “isolated” one means that the only force acting on any particle <span class="math notranslate nohighlight">\(i\)</span>
are those originating from other particles in the sum, i.e. “no
external” forces. Thus, Newton’s third law leads to the conservation
of total momentum,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\boldsymbol{P}&amp;=&amp;\sum_i m_i\boldsymbol{v}_i,\\
\nonumber
\frac{d}{dt}\boldsymbol{P}&amp;=&amp;0.
\end{eqnarray}
\end{split}\]</div>
<p>Consider the rocket of mass <span class="math notranslate nohighlight">\(M\)</span> moving with velocity <span class="math notranslate nohighlight">\(v\)</span>. After a
brief instant, the velocity of the rocket is <span class="math notranslate nohighlight">\(v+\Delta v\)</span> and the mass
is <span class="math notranslate nohighlight">\(M-\Delta M\)</span>. Momentum conservation gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
Mv&amp;=&amp;(M-\Delta M)(v+\Delta v)+\Delta M(v-v_e)\\
0&amp;=&amp;-\Delta Mv+M\Delta v+\Delta M(v-v_e),\\
0&amp;=&amp;M\Delta v-\Delta Mv_e.
\end{eqnarray*}
\end{split}\]</div>
<p>In the second step we ignored the term <span class="math notranslate nohighlight">\(\Delta M\Delta v\)</span> because it is doubly small. The last equation gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\Delta v&amp;=&amp;\frac{v_e}{M}\Delta M,\\
\nonumber
\frac{dv}{dt}&amp;=&amp;\frac{v_e}{M}\frac{dM}{dt}.
\end{eqnarray}
\end{split}\]</div>
<p>Integrating the expression with lower limits <span class="math notranslate nohighlight">\(v_0=0\)</span> and <span class="math notranslate nohighlight">\(M_0\)</span>, one finds</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
v&amp;=&amp;v_e\int_{M_0}^M \frac{dM'}{M'}\\
v&amp;=&amp;-v_e\ln(M/M_0)\\
&amp;=&amp;-v_e\ln[(M_0-\alpha t)/M_0].
\end{eqnarray*}
\end{split}\]</div>
<p>Because the total momentum of an isolated system is constant, one can
also quickly see that the center of mass of an isolated system is also
constant. The center of mass is the average position of a set of
masses weighted by the mass,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto29"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\bar{x}=\frac{\sum_im_ix_i}{\sum_i m_i}.
\label{_auto29} \tag{32}
\end{equation}
\]</div>
<p>The rate of change of <span class="math notranslate nohighlight">\(\bar{x}\)</span> is</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\dot{\bar{x}}&amp;=&amp;\frac{1}{M}\sum_i m_i\dot{x}_i=\frac{1}{M}P_x.
\end{eqnarray}
\]</div>
<p>Thus if the total momentum is constant the center of mass moves at a
constant velocity, and if the total momentum is zero the center of
mass is fixed.</p>
</div>
<div class="section" id="conservation-of-angular-momentum">
<h2>Conservation of Angular Momentum<a class="headerlink" href="#conservation-of-angular-momentum" title="Permalink to this headline">¶</a></h2>
<p>Consider a case where the force always points radially,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto30"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\boldsymbol{F}(\boldsymbol{r})=F(r)\hat{r},
\label{_auto30} \tag{33}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{r}\)</span> is a unit vector pointing outward from the origin. The angular momentum is defined as</p>
<!-- Equation labels as ordinary links -->
<div id="_auto31"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\boldsymbol{L}=\boldsymbol{r}\times\boldsymbol{p}=m\boldsymbol{r}\times\boldsymbol{v}.
\label{_auto31} \tag{34}
\end{equation}
\]</div>
<p>The rate of change of the angular momentum is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{d\boldsymbol{L}}{dt}&amp;=&amp;m\boldsymbol{v}\times\boldsymbol{v}+m\boldsymbol{r}\times\dot{\boldsymbol{v}}\\
\nonumber
&amp;=&amp;m\boldsymbol{v}\times\boldsymbol{v}+\boldsymbol{r}\times{\boldsymbol{F}}=0.
\end{eqnarray}
\end{split}\]</div>
<p>The first term is zero because <span class="math notranslate nohighlight">\(\boldsymbol{v}\)</span> is parallel to itself, and the
second term is zero because <span class="math notranslate nohighlight">\(\boldsymbol{F}\)</span> is parallel to <span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span>.</p>
<p>As an aside, one can see from the Levi-Civita symbol that the cross
product of a vector with itself is zero. Here, we consider a vector</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\boldsymbol{V}&amp;=&amp;\boldsymbol{A}\times\boldsymbol{A},\\
\nonumber
V_i&amp;=&amp;(\boldsymbol{A}\times\boldsymbol{A})_i=\sum_{jk}\epsilon_{ijk}A_jA_k.
\end{eqnarray}
\end{split}\]</div>
<p>For any term <span class="math notranslate nohighlight">\(i\)</span>, there are two contributions. For example, for <span class="math notranslate nohighlight">\(i\)</span>
denoting the <span class="math notranslate nohighlight">\(x\)</span> direction, either <span class="math notranslate nohighlight">\(j\)</span> denotes the <span class="math notranslate nohighlight">\(y\)</span> direction and
<span class="math notranslate nohighlight">\(k\)</span> denotes the <span class="math notranslate nohighlight">\(z\)</span> direction, or vice versa, so</p>
<!-- Equation labels as ordinary links -->
<div id="_auto32"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
V_1=\epsilon_{123}A_2A_3+\epsilon_{132}A_3A_2.
\label{_auto32} \tag{35}
\end{equation}
\]</div>
<p>This is zero by the antisymmetry of <span class="math notranslate nohighlight">\(\epsilon\)</span> under permutations.</p>
<p>If the force is not radial, <span class="math notranslate nohighlight">\(\boldsymbol{r}\times\boldsymbol{F}\ne 0\)</span> as above, and angular momentum is no longer conserved,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto33"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d\boldsymbol{L}}{dt}=\boldsymbol{r}\times\boldsymbol{F}\equiv\boldsymbol{\tau},
\label{_auto33} \tag{36}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\tau}\)</span> is the torque.</p>
<p>For a system of isolated particles, one can write</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{d}{dt}\sum_i\boldsymbol{L}_i&amp;=&amp;\sum_{i\ne j}\boldsymbol{r}_i\times \boldsymbol{F}_{ij}\\
\nonumber
&amp;=&amp;\frac{1}{2}\sum_{i\ne j} \boldsymbol{r}_i\times \boldsymbol{F}_{ij}+\boldsymbol{r}_j\times\boldsymbol{F}_{ji}\\
\nonumber
&amp;=&amp;\frac{1}{2}\sum_{i\ne j} (\boldsymbol{r}_i-\boldsymbol{r}_j)\times\boldsymbol{F}_{ij}=0,
\end{eqnarray}
\end{split}\]</div>
<p>where the last step used Newton’s third law,
<span class="math notranslate nohighlight">\(\boldsymbol{F}_{ij}=-\boldsymbol{F}_{ji}\)</span>. If the forces between the particles are
radial, i.e. <span class="math notranslate nohighlight">\(\boldsymbol{F}_{ij} ~||~ (\boldsymbol{r}_i-\boldsymbol{r}_j)\)</span>, then each term in
the sum is zero and the net angular momentum is fixed. Otherwise, you
could imagine an isolated system that would start spinning
spontaneously.</p>
<p>One can write the torque about a given axis, which we will denote as <span class="math notranslate nohighlight">\(\hat{z}\)</span>, in polar coordinates, where</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
x&amp;=&amp;r\sin\theta\cos\phi,~~y=r\sin\theta\cos\phi,~~z=r\cos\theta,
\end{eqnarray}
\]</div>
<p>to find the <span class="math notranslate nohighlight">\(z\)</span> component of the torque,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\tau_z&amp;=&amp;xF_y-yF_x\\
\nonumber
&amp;=&amp;-r\sin\theta\left\{\cos\phi \partial_y-\sin\phi \partial_x\right\}V(x,y,z).
\end{eqnarray}
\end{split}\]</div>
<p>One can use the chain rule to write the partial derivative w.r.t. <span class="math notranslate nohighlight">\(\phi\)</span> (keeping <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span> fixed),</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\partial_\phi&amp;=&amp;\frac{\partial x}{\partial\phi}\partial_x+\frac{\partial_y}{\partial\phi}\partial_y
+\frac{\partial z}{\partial\phi}\partial_z\\
\nonumber
&amp;=&amp;-r\sin\theta\sin\phi\partial_x+\sin\theta\cos\phi\partial_y.
\end{eqnarray}
\end{split}\]</div>
<p>Combining the two equations,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\tau_z&amp;=&amp;-\partial_\phi V(r,\theta,\phi).
\end{eqnarray}
\]</div>
<p>Thus, if the potential is independent of the azimuthal angle <span class="math notranslate nohighlight">\(\phi\)</span>,
there is no torque about the <span class="math notranslate nohighlight">\(z\)</span> axis and <span class="math notranslate nohighlight">\(L_z\)</span> is conserved.</p>
</div>
<div class="section" id="symmetries-and-conservation-laws">
<h2>Symmetries and Conservation Laws<a class="headerlink" href="#symmetries-and-conservation-laws" title="Permalink to this headline">¶</a></h2>
<p>When we derived the conservation of energy, we assumed that the
potential depended only on position, not on time. If it depended
explicitly on time, one can quickly see that the energy would have
changed at a rate <span class="math notranslate nohighlight">\(\partial_tV(x,y,z,t)\)</span>. Note that if there is no
explicit dependence on time, i.e. <span class="math notranslate nohighlight">\(V(x,y,z)\)</span>, the potential energy can
depend on time through the variations of <span class="math notranslate nohighlight">\(x,y,z\)</span> with time. However,
that variation does not lead to energy non-conservation. Further, we
just saw that if a potential does not depend on the azimuthal angle
about some axis, <span class="math notranslate nohighlight">\(\phi\)</span>, that the angular momentum about that axis is
conserved.</p>
<p>Now, we relate momentum conservation to translational
invariance. Considering a system of particles with positions,
<span class="math notranslate nohighlight">\(\boldsymbol{r}_i\)</span>, if one changed the coordinate system by a translation by a
differential distance <span class="math notranslate nohighlight">\(\boldsymbol{\epsilon}\)</span>, the net potential would change
by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\delta V(\boldsymbol{r}_1,\boldsymbol{r}_2\cdots)&amp;=&amp;\sum_i \boldsymbol{\epsilon}\cdot\nabla_i V(\boldsymbol{r}_1,\boldsymbol{r}_2,\cdots)\\
\nonumber
&amp;=&amp;-\sum_i \boldsymbol{\epsilon}\cdot\boldsymbol{F}_i\\
\nonumber
&amp;=&amp;-\frac{d}{dt}\sum_i \boldsymbol{\epsilon}\cdot\boldsymbol{p}_i.
\end{eqnarray}
\end{split}\]</div>
<p>Thus, if the potential is unchanged by a translation of the coordinate
system, the total momentum is conserved. If the potential is
translationally invariant in a given direction, defined by a unit
vector, <span class="math notranslate nohighlight">\(\hat{\epsilon}\)</span> in the <span class="math notranslate nohighlight">\(\boldsymbol{\epsilon}\)</span> direction, one can see
that</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\hat{\epsilon}\cdot\nabla_i V(\boldsymbol{r}_i)&amp;=&amp;0.
\end{eqnarray}
\]</div>
<p>The component of the total momentum along that axis is conserved. This
is rather obvious for a single particle. If <span class="math notranslate nohighlight">\(V(\boldsymbol{r})\)</span> does not
depend on some coordinate <span class="math notranslate nohighlight">\(x\)</span>, then the force in the <span class="math notranslate nohighlight">\(x\)</span> direction is
<span class="math notranslate nohighlight">\(F_x=-\partial_xV=0\)</span>, and momentum along the <span class="math notranslate nohighlight">\(x\)</span> direction is
constant.</p>
<p>We showed how the total momentum of an isolated system of particle was conserved, even if the particles feel internal forces in all directions. In that case the potential energy could be written</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
V=\sum_{i,j\le i}V_{ij}(\boldsymbol{r}_i-\boldsymbol{r}_j).
\end{eqnarray}
\]</div>
<p>In this case, a translation leads to <span class="math notranslate nohighlight">\(\boldsymbol{r}_i\rightarrow
\boldsymbol{r}_i+\boldsymbol{\epsilon}\)</span>, with the translation equally affecting the
coordinates of each particle. Because the potential depends only on
the relative coordinates, <span class="math notranslate nohighlight">\(\delta V\)</span> is manifestly zero. If one were
to go through the exercise of calculating <span class="math notranslate nohighlight">\(\delta V\)</span> for small
<span class="math notranslate nohighlight">\(\boldsymbol{\epsilon}\)</span>, one would find that the term
<span class="math notranslate nohighlight">\(\nabla_i V(\boldsymbol{r}_i-\boldsymbol{r}_j)\)</span> would be canceled by the term
<span class="math notranslate nohighlight">\(\nabla_jV(\boldsymbol{r}_i-\boldsymbol{r}_j)\)</span>.</p>
<p>The relation between symmetries of the potential and conserved
quantities (also called constants of motion) is one of the most
profound concepts one should gain from this course. It plays a
critical role in all fields of physics. This is especially true in
quantum mechanics, where a quantity <span class="math notranslate nohighlight">\(A\)</span> is conserved if its operator
commutes with the Hamiltonian. For example if the momentum operator
<span class="math notranslate nohighlight">\(-i\hbar\partial_x\)</span> commutes with the Hamiltonian, momentum is
conserved, and clearly this operator commutes if the Hamiltonian
(which represents the total energy, not just the potential) does not
depend on <span class="math notranslate nohighlight">\(x\)</span>. Also in quantum mechanics the angular momentum operator
is <span class="math notranslate nohighlight">\(L_z=-i\hbar\partial_\phi\)</span>. In fact, if the potential is unchanged
by rotations about some axis, angular momentum about that axis is
conserved. We return to this concept, from a more formal perspective,
later in the course when Lagrangian mechanics is presented.</p>
</div>
<div class="section" id="bulding-a-code-for-the-earth-sun-system">
<h2>Bulding a code for the Earth-Sun system<a class="headerlink" href="#bulding-a-code-for-the-earth-sun-system" title="Permalink to this headline">¶</a></h2>
<p>We will now venture into a study of a system which is energy
conserving. The aim is to see if we (since it is not possible to solve
the general equations analytically) we can develop stable numerical
algorithms whose results we can trust!</p>
<p>We solve the equations of motion numerically. We will also compute
quantities like the energy numerically.</p>
<p>We start with a simpler case first, the Earth-Sun system  in two dimensions only.  The gravitational force <span class="math notranslate nohighlight">\(F_G\)</span> on the earth from the sun is</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}_G=-\frac{GM_{\odot}M_E}{r^3}\boldsymbol{r},
\]</div>
<p>where <span class="math notranslate nohighlight">\(G\)</span> is the gravitational constant,</p>
<div class="math notranslate nohighlight">
\[
M_E=6\times 10^{24}\mathrm{Kg},
\]</div>
<p>the mass of Earth,</p>
<div class="math notranslate nohighlight">
\[
M_{\odot}=2\times 10^{30}\mathrm{Kg},
\]</div>
<p>the mass of the Sun and</p>
<div class="math notranslate nohighlight">
\[
r=1.5\times 10^{11}\mathrm{m},
\]</div>
<p>is the distance between Earth and the Sun. The latter defines what we call an astronomical unit <strong>AU</strong>.
From Newton’s second law we have then for the <span class="math notranslate nohighlight">\(x\)</span> direction</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{dt^2}=-\frac{F_{x}}{M_E},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2y}{dt^2}=-\frac{F_{y}}{M_E},
\]</div>
<p>for the <span class="math notranslate nohighlight">\(y\)</span> direction.</p>
<p>Here we will use  that  <span class="math notranslate nohighlight">\(x=r\cos{(\theta)}\)</span>, <span class="math notranslate nohighlight">\(y=r\sin{(\theta)}\)</span> and</p>
<div class="math notranslate nohighlight">
\[
r = \sqrt{x^2+y^2}.
\]</div>
<p>We can rewrite</p>
<div class="math notranslate nohighlight">
\[
F_{x}=-\frac{GM_{\odot}M_E}{r^2}\cos{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}x,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
F_{y}=-\frac{GM_{\odot}M_E}{r^2}\sin{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}y,
\]</div>
<p>for the <span class="math notranslate nohighlight">\(y\)</span> direction.</p>
<p>We can rewrite these two equations</p>
<div class="math notranslate nohighlight">
\[
F_{x}=-\frac{GM_{\odot}M_E}{r^2}\cos{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}x,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
F_{y}=-\frac{GM_{\odot}M_E}{r^2}\sin{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}y,
\]</div>
<p>as four first-order coupled differential equations</p>
<p>1
5
8</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<p>1
5
9</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<p>1
6
0</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<div class="math notranslate nohighlight">
\[
\frac{dy}{dt}=v_y.
\]</div>
</div>
<div class="section" id="building-a-code-for-the-solar-system-final-coupled-equations">
<h2>Building a code for the solar system, final coupled equations<a class="headerlink" href="#building-a-code-for-the-solar-system-final-coupled-equations" title="Permalink to this headline">¶</a></h2>
<p>The four coupled differential equations</p>
<p>1
6
2</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<p>1
6
3</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<p>1
6
4</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<div class="math notranslate nohighlight">
\[
\frac{dy}{dt}=v_y,
\]</div>
<p>can be turned into dimensionless equations or we can introduce astronomical units with <span class="math notranslate nohighlight">\(1\)</span> AU = <span class="math notranslate nohighlight">\(1.5\times 10^{11}\)</span>.</p>
<p>Using the equations from circular motion (with <span class="math notranslate nohighlight">\(r =1\mathrm{AU}\)</span>)</p>
<div class="math notranslate nohighlight">
\[
\frac{M_E v^2}{r} = F = \frac{GM_{\odot}M_E}{r^2},
\]</div>
<p>we have</p>
<div class="math notranslate nohighlight">
\[
GM_{\odot}=v^2r,
\]</div>
<p>and using that the velocity of Earth (assuming circular motion) is
<span class="math notranslate nohighlight">\(v = 2\pi r/\mathrm{yr}=2\pi\mathrm{AU}/\mathrm{yr}\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[
GM_{\odot}= v^2r = 4\pi^2 \frac{(\mathrm{AU})^3}{\mathrm{yr}^2}.
\]</div>
</div>
<div class="section" id="building-a-code-for-the-solar-system-discretized-equations">
<h2>Building a code for the solar system, discretized equations<a class="headerlink" href="#building-a-code-for-the-solar-system-discretized-equations" title="Permalink to this headline">¶</a></h2>
<p>The four coupled differential equations can then be discretized using Euler’s method as (with step length <span class="math notranslate nohighlight">\(h\)</span>)</p>
<p>1
6
9</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<p>1
7
0</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<p>1
7
1</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<div class="math notranslate nohighlight">
\[
y_{i+1}=y_i+hv_{y,i},
\]</div>
</div>
<div class="section" id="code-example-with-euler-s-method">
<h2>Code Example with Euler’s Method<a class="headerlink" href="#code-example-with-euler-s-method" title="Permalink to this headline">¶</a></h2>
<p>The code here implements Euler’s method for the Earth-Sun system using a more compact way of representing the vectors. Alternatively, you could have spelled out all the variables <span class="math notranslate nohighlight">\(v_x\)</span>, <span class="math notranslate nohighlight">\(v_y\)</span>, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> as one-dimensional arrays.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>


<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># in years</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">Fourpi2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span>
<span class="c1"># Start integrating using Euler&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">Fourpi2</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using Euler&#39;s forward method</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="c1">#ax.set_xlim(0, tfinal)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;y[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EarthSunEuler&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="problems-with-euler-s-method">
<h2>Problems with Euler’s Method<a class="headerlink" href="#problems-with-euler-s-method" title="Permalink to this headline">¶</a></h2>
<p>We notice here that Euler’s method doesn’t give a stable orbit. It
means that we cannot trust Euler’s method. In a deeper way, as we will
see in homework 5, Euler’s method does not conserve energy. It is an
example of an integrator which is not
<a class="reference external" href="https://en.wikipedia.org/wiki/Symplectic_integrator">symplectic</a>.</p>
<p>Here we present thus two methods, which with simple changes allow us to avoid these pitfalls. The simplest possible extension is the so-called Euler-Cromer method.
The changes we need to make to our code are indeed marginal here.
We need simply to replace</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>in the above code with the velocity at the new time <span class="math notranslate nohighlight">\(t_{i+1}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>By this simple caveat we get stable orbits.
Below we derive the Euler-Cromer method as well as one of the most utlized algorithms for sovling the above type of problems, the so-called Velocity-Verlet method.</p>
</div>
<div class="section" id="deriving-the-euler-cromer-method">
<h2>Deriving the Euler-Cromer Method<a class="headerlink" href="#deriving-the-euler-cromer-method" title="Permalink to this headline">¶</a></h2>
<p>Let us repeat Euler’s method.
We have a differential equation</p>
<!-- Equation labels as ordinary links -->
<div id="_auto34"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
y'(t_i)=f(t_i,y_i)   
\label{_auto34} \tag{37}
\end{equation}
\]</div>
<p>and if we truncate at the first derivative, we have from the Taylor expansion</p>
<!-- Equation labels as ordinary links -->
<div id="eq:euler"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
y_{i+1}=y(t_i) + (\Delta t) f(t_i,y_i) + O(\Delta t^2), \label{eq:euler} \tag{38}
\end{equation}
\]</div>
<p>which when complemented with <span class="math notranslate nohighlight">\(t_{i+1}=t_i+\Delta t\)</span> forms
the algorithm for the well-known Euler method.
Note that at every step we make an approximation error
of the order of <span class="math notranslate nohighlight">\(O(\Delta t^2)\)</span>, however the total error is the sum over all
steps <span class="math notranslate nohighlight">\(N=(b-a)/(\Delta t)\)</span> for <span class="math notranslate nohighlight">\(t\in [a,b]\)</span>, yielding thus a global error which goes like
<span class="math notranslate nohighlight">\(NO(\Delta t^2)\approx O(\Delta t)\)</span>.</p>
<p>To make Euler’s method more precise we can obviously
decrease <span class="math notranslate nohighlight">\(\Delta t\)</span> (increase <span class="math notranslate nohighlight">\(N\)</span>), but this can lead to loss of numerical precision.
Euler’s method is not recommended for precision calculation,
although it is handy to use in order to get a first
view on how a solution may look like.</p>
<p>Euler’s method is asymmetric in time, since it uses information about the derivative at the beginning
of the time interval. This means that we evaluate the position at <span class="math notranslate nohighlight">\(y_1\)</span> using the velocity
at <span class="math notranslate nohighlight">\(v_0\)</span>. A simple variation is to determine <span class="math notranslate nohighlight">\(x_{n+1}\)</span> using the velocity at
<span class="math notranslate nohighlight">\(v_{n+1}\)</span>, that is (in a slightly more generalized form)</p>
<!-- Equation labels as ordinary links -->
<div id="_auto35"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
y_{n+1}=y_{n}+ v_{n+1}+O(\Delta t^2)
\label{_auto35} \tag{39}
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="_auto36"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_{n+1}=v_{n}+(\Delta t) a_{n}+O(\Delta t^2).
\label{_auto36} \tag{40}
\end{equation}
\]</div>
<p>The acceleration <span class="math notranslate nohighlight">\(a_n\)</span> is a function of <span class="math notranslate nohighlight">\(a_n(y_n, v_n, t_n)\)</span> and needs to be evaluated
as well. This is the Euler-Cromer method.</p>
<p><strong>Exercise</strong>: go back to the above code with Euler’s method and add the Euler-Cromer method.</p>
</div>
<div class="section" id="deriving-the-velocity-verlet-method">
<h2>Deriving the Velocity-Verlet Method<a class="headerlink" href="#deriving-the-velocity-verlet-method" title="Permalink to this headline">¶</a></h2>
<p>Let us stay with <span class="math notranslate nohighlight">\(x\)</span> (position) and <span class="math notranslate nohighlight">\(v\)</span> (velocity) as the quantities we are interested in.</p>
<p>We have the Taylor expansion for the position given by</p>
<div class="math notranslate nohighlight">
\[
x_{i+1} = x_i+(\Delta t)v_i+\frac{(\Delta t)^2}{2}a_i+O((\Delta t)^3).
\]</div>
<p>The corresponding expansion for the velocity is</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+(\Delta t)a_i+\frac{(\Delta t)^2}{2}v^{(2)}_i+O((\Delta t)^3).
\]</div>
<p>Via Newton’s second law we have normally an analytical expression for the derivative of the velocity, namely</p>
<div class="math notranslate nohighlight">
\[
a_i= \frac{d^2 x}{dt^2}\vert_{i}=\frac{d v}{dt}\vert_{i}= \frac{F(x_i,v_i,t_i)}{m}.
\]</div>
<p>If we add to this the corresponding expansion for the derivative of the velocity</p>
<div class="math notranslate nohighlight">
\[
v^{(1)}_{i+1} = a_{i+1}= a_i+(\Delta t)v^{(2)}_i+O((\Delta t)^2)=a_i+(\Delta t)v^{(2)}_i+O((\Delta t)^2),
\]</div>
<p>and retain only terms up to the second derivative of the velocity since our error goes as <span class="math notranslate nohighlight">\(O(h^3)\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[
(\Delta t)v^{(2)}_i\approx a_{i+1}-a_i.
\]</div>
<p>We can then rewrite the Taylor expansion for the velocity as</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+\frac{(\Delta t)}{2}\left( a_{i+1}+a_{i}\right)+O((\Delta t)^3).
\]</div>
</div>
<div class="section" id="the-velocity-verlet-method">
<h2>The velocity Verlet method<a class="headerlink" href="#the-velocity-verlet-method" title="Permalink to this headline">¶</a></h2>
<p>Our final equations for the position and the velocity become then</p>
<div class="math notranslate nohighlight">
\[
x_{i+1} = x_i+(\Delta t)v_i+\frac{(\Delta t)^2}{2}a_{i}+O((\Delta t)^3),
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+\frac{(\Delta t)}{2}\left(a_{i+1}+a_{i}\right)+O((\Delta t)^3).
\]</div>
<p>Note well that the term <span class="math notranslate nohighlight">\(a_{i+1}\)</span> depends on the position at <span class="math notranslate nohighlight">\(x_{i+1}\)</span>. This means that you need to calculate
the position at the updated time <span class="math notranslate nohighlight">\(t_{i+1}\)</span> before the computing the next velocity.  Note also that the derivative of the velocity at the time
<span class="math notranslate nohighlight">\(t_i\)</span> used in the updating of the position can be reused in the calculation of the velocity update as well.</p>
</div>
<div class="section" id="adding-the-velocity-verlet-method">
<h2>Adding the Velocity-Verlet Method<a class="headerlink" href="#adding-the-velocity-verlet-method" title="Permalink to this headline">¶</a></h2>
<p>We can now easily add the Verlet method to our original code as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">Fourpi2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up forces, air resistance FD, note now that we need the norm of the vecto</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">Fourpi2</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;y[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EarthSunVV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>You can easily generalize the calculation of the forces by defining a function
which takes in as input the various variables. We leave this as a challenge to you.</p>
</div>
<div class="section" id="studying-energy-conservation">
<h2>Studying Energy Conservation<a class="headerlink" href="#studying-energy-conservation" title="Permalink to this headline">¶</a></h2>
<p>In order to study the conservation of energy, we will need to perform
a numerical integration, unless we can integrate analytically. Here we
present the Trapezoidal rule as a the simplest possible approximation.</p>
</div>
<div class="section" id="numerical-integration">
<h2>Numerical Integration<a class="headerlink" href="#numerical-integration" title="Permalink to this headline">¶</a></h2>
<p>It is also useful to consider methods to integrate numerically.
Let us consider the following case.
We have  classical electron which moves in the <span class="math notranslate nohighlight">\(x\)</span>-direction along a surface. The force from the surface is</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}(x)=-F_0\sin{(\frac{2\pi x}{b})}\boldsymbol{e}_x.
\]</div>
<p>The constant <span class="math notranslate nohighlight">\(b\)</span> represents the distance between atoms at the surface of the material, <span class="math notranslate nohighlight">\(F_0\)</span> is a constant and <span class="math notranslate nohighlight">\(x\)</span> is the position of the electron.
Using the work-energy theorem we can find the work <span class="math notranslate nohighlight">\(W\)</span> done when moving an electron from a position <span class="math notranslate nohighlight">\(x_0\)</span> to a final position <span class="math notranslate nohighlight">\(x\)</span> through the
integral</p>
<div class="math notranslate nohighlight">
\[
W=-\int_{x_0}^x \boldsymbol{F}(x')dx' =  \int_{x_0}^x F_0\sin{(\frac{2\pi x'}{b})} dx',
\]</div>
<p>which results in</p>
<div class="math notranslate nohighlight">
\[
W=\frac{F_0b}{2\pi}\left[\cos{(\frac{2\pi x}{b})}-\cos{(\frac{2\pi x_0}{b})}\right].
\]</div>
</div>
<div class="section" id="id2">
<h2>Numerical Integration<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>There are several numerical algorithms for finding an integral
numerically. The more familiar ones like the rectangular rule or the
trapezoidal rule have simple geometric interpretations.</p>
<p>Let us look at the mathematical details of what are called equal-step methods, also known as Newton-Cotes quadrature.</p>
</div>
<div class="section" id="newton-cotes-quadrature-or-equal-step-methods">
<h2>Newton-Cotes Quadrature or equal-step methods<a class="headerlink" href="#newton-cotes-quadrature-or-equal-step-methods" title="Permalink to this headline">¶</a></h2>
<p>The integral</p>
<!-- Equation labels as ordinary links -->
<div id="eq:integraldef"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   I=\int_a^bf(x) dx
\label{eq:integraldef} \tag{41}
\end{equation}
\]</div>
<p>has a very simple meaning. The integral is the
area enscribed by the function <span class="math notranslate nohighlight">\(f(x)\)</span> starting from <span class="math notranslate nohighlight">\(x=a\)</span> to  <span class="math notranslate nohighlight">\(x=b\)</span>. It is subdivided in several smaller areas whose evaluation is to  be approximated by different techniques. The areas under the curve can for example  be approximated by rectangular boxes or trapezoids.</p>
</div>
<div class="section" id="basic-philosophy-of-equal-step-methods">
<h2>Basic philosophy of equal-step methods<a class="headerlink" href="#basic-philosophy-of-equal-step-methods" title="Permalink to this headline">¶</a></h2>
<p>In considering equal step  methods, our basic approach is that of approximating
a function <span class="math notranslate nohighlight">\(f(x)\)</span> with a polynomial of at most
degree <span class="math notranslate nohighlight">\(N-1\)</span>, given <span class="math notranslate nohighlight">\(N\)</span> integration points. If our polynomial is of degree <span class="math notranslate nohighlight">\(1\)</span>,
the function will be approximated with <span class="math notranslate nohighlight">\(f(x)\approx a_0+a_1x\)</span>.</p>
<p>The algorithm for these integration methods  is rather simple, and the number of approximations perhaps  unlimited!</p>
<ul class="simple">
<li><p>Choose a step size <span class="math notranslate nohighlight">\(h=(b-a)/N\)</span>  where <span class="math notranslate nohighlight">\(N\)</span> is the number of steps and <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> the lower and upper limits of integration.</p></li>
<li><p>With a given step length we rewrite the integral as</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\int_a^bf(x) dx= \int_a^{a+h}f(x)dx + \int_{a+h}^{a+2h}f(x)dx+\dots \int_{b-h}^{b}f(x)dx.
\]</div>
<ul class="simple">
<li><p>The strategy then is to find a reliable polynomial approximation   for <span class="math notranslate nohighlight">\(f(x)\)</span> in the various intervals.  Choosing a given approximation for  <span class="math notranslate nohighlight">\(f(x)\)</span>, we obtain a specific approximation to the  integral.</p></li>
<li><p>With this approximation to <span class="math notranslate nohighlight">\(f(x)\)</span> we perform the integration by computing the integrals over all subintervals.</p></li>
</ul>
<p>One possible strategy then is to find a reliable polynomial expansion for <span class="math notranslate nohighlight">\(f(x)\)</span> in the smaller
subintervals. Consider for example evaluating</p>
<div class="math notranslate nohighlight">
\[
\int_a^{a+2h}f(x)dx,
\]</div>
<p>which we rewrite as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:hhint"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\int_a^{a+2h}f(x)dx=\int_{x_0-h}^{x_0+h}f(x)dx.
\label{eq:hhint} \tag{42}
\end{equation}
\]</div>
<p>We have chosen a midpoint <span class="math notranslate nohighlight">\(x_0\)</span> and have defined <span class="math notranslate nohighlight">\(x_0=a+h\)</span>.</p>
</div>
<div class="section" id="the-rectangle-method">
<h2>The rectangle method<a class="headerlink" href="#the-rectangle-method" title="Permalink to this headline">¶</a></h2>
<p>A very simple approach is the so-called midpoint or rectangle method.
In this case the integration area is split in a given number of rectangles with length <span class="math notranslate nohighlight">\(h\)</span> and height given by the mid-point value of the function.  This gives the following simple rule for approximating an integral</p>
<!-- Equation labels as ordinary links -->
<div id="eq:rectangle"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
I=\int_a^bf(x) dx \approx  h\sum_{i=1}^N f(x_{i-1/2}), 
\label{eq:rectangle} \tag{43}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(f(x_{i-1/2})\)</span> is the midpoint value of <span class="math notranslate nohighlight">\(f\)</span> for a given rectangle. We will discuss its truncation
error below.  It is easy to implement this algorithm,  as shown below</p>
<p>The correct mathematical expression for the local error for the rectangular rule <span class="math notranslate nohighlight">\(R_i(h)\)</span> for element <span class="math notranslate nohighlight">\(i\)</span> is</p>
<div class="math notranslate nohighlight">
\[
\int_{-h}^hf(x)dx - R_i(h)=-\frac{h^3}{24}f^{(2)}(\xi),
\]</div>
<p>and the global error reads</p>
<div class="math notranslate nohighlight">
\[
\int_a^bf(x)dx -R_h(f)=-\frac{b-a}{24}h^2f^{(2)}(\xi),
\]</div>
<p>where <span class="math notranslate nohighlight">\(R_h\)</span> is the result obtained with rectangular rule and <span class="math notranslate nohighlight">\(\xi \in [a,b]\)</span>.</p>
<p>We go back to our simple example above and set <span class="math notranslate nohighlight">\(F_0=b=1\)</span> and choose <span class="math notranslate nohighlight">\(x_0=0\)</span> and <span class="math notranslate nohighlight">\(x=1/2\)</span>, and have</p>
<div class="math notranslate nohighlight">
\[
W=\frac{1}{\pi}.
\]</div>
<p>The code here computes the integral using the rectangle rule and <span class="math notranslate nohighlight">\(n=100\)</span> integration points we have a relative error of
<span class="math notranslate nohighlight">\(10^{-5}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">integrate</span>
<span class="c1"># function for the Rectangular rule                                                                                        </span>
<span class="k">def</span> <span class="nf">Rectangular</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
   <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
       <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">h</span>
       <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">h</span><span class="o">*</span><span class="n">s</span>
<span class="c1"># function to integrate</span>
<span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># define integration limits and integration points                                                                         </span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">Exact</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">pi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Relative error= &quot;</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span> <span class="p">(</span><span class="n">Rectangular</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">function</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="n">Exact</span><span class="p">)</span><span class="o">/</span><span class="n">Exact</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-trapezoidal-rule">
<h2>The trapezoidal rule<a class="headerlink" href="#the-trapezoidal-rule" title="Permalink to this headline">¶</a></h2>
<p>The other integral gives</p>
<div class="math notranslate nohighlight">
\[
\int_{x_0-h}^{x_0}f(x)dx=\frac{h}{2}\left(f(x_0) + f(x_0-h)\right)+O(h^3),
\]</div>
<p>and adding up we obtain</p>
<!-- Equation labels as ordinary links -->
<div id="eq:trapez"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   \int_{x_0-h}^{x_0+h}f(x)dx=\frac{h}{2}\left(f(x_0+h) + 2f(x_0) + f(x_0-h)\right)+O(h^3),
\label{eq:trapez} \tag{44}
\end{equation}
\]</div>
<p>which is the well-known trapezoidal rule.  Concerning the error in the approximation made,
<span class="math notranslate nohighlight">\(O(h^3)=O((b-a)^3/N^3)\)</span>, you should  note
that this is the local error.  Since we are splitting the integral from
<span class="math notranslate nohighlight">\(a\)</span> to <span class="math notranslate nohighlight">\(b\)</span> in <span class="math notranslate nohighlight">\(N\)</span> pieces, we will have to perform approximately <span class="math notranslate nohighlight">\(N\)</span>
such operations.</p>
<p>This means that the <em>global error</em> goes like <span class="math notranslate nohighlight">\(\approx O(h^2)\)</span>.
The trapezoidal reads then</p>
<!-- Equation labels as ordinary links -->
<div id="eq:trapez1"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   I=\int_a^bf(x) dx=h\left(f(a)/2 + f(a+h) +f(a+2h)+
                          \dots +f(b-h)+ f_{b}/2\right),
\label{eq:trapez1} \tag{45}
\end{equation}
\]</div>
<p>with a global error which goes like <span class="math notranslate nohighlight">\(O(h^2)\)</span>.</p>
<p>Hereafter we use the shorthand notations <span class="math notranslate nohighlight">\(f_{-h}=f(x_0-h)\)</span>, <span class="math notranslate nohighlight">\(f_{0}=f(x_0)\)</span>
and <span class="math notranslate nohighlight">\(f_{h}=f(x_0+h)\)</span>.</p>
<p>The correct mathematical expression for the local error for the trapezoidal rule is</p>
<div class="math notranslate nohighlight">
\[
\int_a^bf(x)dx -\frac{b-a}{2}\left[f(a)+f(b)\right]=-\frac{h^3}{12}f^{(2)}(\xi),
\]</div>
<p>and the global error reads</p>
<div class="math notranslate nohighlight">
\[
\int_a^bf(x)dx -T_h(f)=-\frac{b-a}{12}h^2f^{(2)}(\xi),
\]</div>
<p>where <span class="math notranslate nohighlight">\(T_h\)</span> is the trapezoidal result and <span class="math notranslate nohighlight">\(\xi \in [a,b]\)</span>.</p>
</div>
<div class="section" id="algorithm-for-the-trapezoidal-rule">
<h2>Algorithm for the trapezoidal rule<a class="headerlink" href="#algorithm-for-the-trapezoidal-rule" title="Permalink to this headline">¶</a></h2>
<p>The trapezoidal rule is easy to  implement numerically
through the following simple algorithm</p>
<ul class="simple">
<li><p>Choose the number of mesh points and fix the step length.</p></li>
<li><p>calculate <span class="math notranslate nohighlight">\(f(a)\)</span> and <span class="math notranslate nohighlight">\(f(b)\)</span> and multiply with <span class="math notranslate nohighlight">\(h/2\)</span>.</p></li>
<li><p>Perform a loop over <span class="math notranslate nohighlight">\(n=1\)</span> to <span class="math notranslate nohighlight">\(n-1\)</span> (<span class="math notranslate nohighlight">\(f(a)\)</span> and <span class="math notranslate nohighlight">\(f(b)\)</span> are known) and sum up  the terms <span class="math notranslate nohighlight">\(f(a+h) +f(a+2h)+f(a+3h)+\dots +f(b-h)\)</span>. Each step in the loop  corresponds to a given value <span class="math notranslate nohighlight">\(a+nh\)</span>.</p></li>
<li><p>Multiply the final result by <span class="math notranslate nohighlight">\(h\)</span> and add <span class="math notranslate nohighlight">\(hf(a)/2\)</span> and <span class="math notranslate nohighlight">\(hf(b)/2\)</span>.</p></li>
</ul>
<p>We use the same function and integrate now using the trapoezoidal rule.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">integrate</span>
<span class="c1"># function for the trapezoidal rule</span>
<span class="k">def</span> <span class="nf">Trapez</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
   <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="n">x</span> <span class="o">=</span> <span class="n">a</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
       <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">h</span>
       <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
   <span class="n">s</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="o">+</span><span class="n">s</span>
   <span class="k">return</span> <span class="n">h</span><span class="o">*</span><span class="n">s</span>
<span class="c1"># function to integrate</span>
<span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># define integration limits and integration points                                                                         </span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">Exact</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">pi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Relative error= &quot;</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span> <span class="p">(</span><span class="n">Trapez</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">function</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="n">Exact</span><span class="p">)</span><span class="o">/</span><span class="n">Exact</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="simpsons-rule">
<h2>Simpsons’ rule<a class="headerlink" href="#simpsons-rule" title="Permalink to this headline">¶</a></h2>
<p>Instead of using the above first-order polynomials
approximations for <span class="math notranslate nohighlight">\(f\)</span>, we attempt at using a second-order polynomials.
In this case we need three points in order to define a second-order
polynomial approximation</p>
<div class="math notranslate nohighlight">
\[
f(x) \approx P_2(x)=a_0+a_1x+a_2x^2.
\]</div>
<p>Using again Lagrange’s interpolation formula we have</p>
<div class="math notranslate nohighlight">
\[
P_2(x)=\frac{(x-x_0)(x-x_1)}{(x_2-x_0)(x_2-x_1)}y_2+
            \frac{(x-x_0)(x-x_2)}{(x_1-x_0)(x_1-x_2)}y_1+
            \frac{(x-x_1)(x-x_2)}{(x_0-x_1)(x_0-x_2)}y_0.
\]</div>
<p>Inserting this formula in the integral of Eq.  (<a class="reference external" href="#eq:hhint">42</a>) we obtain</p>
<div class="math notranslate nohighlight">
\[
\int_{-h}^{+h}f(x)dx=\frac{h}{3}\left(f_h + 4f_0 + f_{-h}\right)+O(h^5),
\]</div>
<p>which is Simpson’s rule.</p>
<p>Note that the improved accuracy in the evaluation of
the derivatives gives a better error approximation, <span class="math notranslate nohighlight">\(O(h^5)\)</span> vs.\ <span class="math notranslate nohighlight">\(O(h^3)\)</span> .
But this is again the <em>local error approximation</em>.
Using Simpson’s rule we can easily compute
the integral     of Eq.  (<a class="reference external" href="#eq:integraldef">41</a>) to be</p>
<!-- Equation labels as ordinary links -->
<div id="eq:simpson"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   I=\int_a^bf(x) dx=\frac{h}{3}\left(f(a) + 4f(a+h) +2f(a+2h)+
                          \dots +4f(b-h)+ f_{b}\right),
\label{eq:simpson} \tag{46}
\end{equation}
\]</div>
<p>with a global error which goes like <span class="math notranslate nohighlight">\(O(h^4)\)</span>.</p>
<p>More formal expressions for the local and global errors are for the local error</p>
<div class="math notranslate nohighlight">
\[
\int_a^bf(x)dx -\frac{b-a}{6}\left[f(a)+4f((a+b)/2)+f(b)\right]=-\frac{h^5}{90}f^{(4)}(\xi),
\]</div>
<p>and for the global error</p>
<div class="math notranslate nohighlight">
\[
\int_a^bf(x)dx -S_h(f)=-\frac{b-a}{180}h^4f^{(4)}(\xi).
\]</div>
<p>with <span class="math notranslate nohighlight">\(\xi\in[a,b]\)</span> and <span class="math notranslate nohighlight">\(S_h\)</span> the results obtained with Simpson’s method.</p>
</div>
<div class="section" id="algorithm-for-simpson-s-rule">
<h2>Algorithm for Simpson’s rule<a class="headerlink" href="#algorithm-for-simpson-s-rule" title="Permalink to this headline">¶</a></h2>
<p>The method
can easily be implemented numerically through the following simple algorithm</p>
<ul class="simple">
<li><p>Choose the number of mesh points and fix the step.</p></li>
<li><p>calculate <span class="math notranslate nohighlight">\(f(a)\)</span> and <span class="math notranslate nohighlight">\(f(b)\)</span></p></li>
<li><p>Perform a loop over <span class="math notranslate nohighlight">\(n=1\)</span> to <span class="math notranslate nohighlight">\(n-1\)</span> (<span class="math notranslate nohighlight">\(f(a)\)</span> and <span class="math notranslate nohighlight">\(f(b)\)</span> are known) and sum up   the terms <span class="math notranslate nohighlight">\(4f(a+h) +2f(a+2h)+4f(a+3h)+\dots +4f(b-h)\)</span>. Each step in the loop  corresponds to a given value <span class="math notranslate nohighlight">\(a+nh\)</span>. Odd values of <span class="math notranslate nohighlight">\(n\)</span> give <span class="math notranslate nohighlight">\(4\)</span> as factor  while even values yield <span class="math notranslate nohighlight">\(2\)</span> as factor.</p></li>
<li><p>Multiply the final result by <span class="math notranslate nohighlight">\(\frac{h}{3}\)</span>.</p></li>
</ul>
</div>
<div class="section" id="code-example">
<h2>Code example<a class="headerlink" href="#code-example" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">integrate</span>
<span class="c1"># function for the trapezoidal rule                                                                                        </span>
<span class="k">def</span> <span class="nf">Simpson</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
   <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="nb">sum</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
       <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
   <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
   <span class="k">return</span> <span class="nb">sum</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mf">3.0</span>
<span class="c1"># function to integrate                                                                                                    </span>
<span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># define integration limits and integration points                                                                         </span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">Exact</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">pi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Relative error= &quot;</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span> <span class="p">(</span><span class="n">Simpson</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">function</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="n">Exact</span><span class="p">)</span><span class="o">/</span><span class="n">Exact</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We see that Simpson’s rule gives a much better estimation of the relative error with the same amount of points as we had for the Rectangle rule and the Trapezoidal rule.</p>
</div>
</div>
<div class="section" id="harmonic-oscillations">
<h1>Harmonic Oscillations<a class="headerlink" href="#harmonic-oscillations" title="Permalink to this headline">¶</a></h1>
<p>The harmonic oscillator is omnipresent in physics. Although you may think
of this as being related to springs, it, or an equivalent
mathematical representation, appears in just about any problem where a
mode is sitting near its potential energy minimum. At that point,
<span class="math notranslate nohighlight">\(\partial_x V(x)=0\)</span>, and the first non-zero term (aside from a
constant) in the potential energy is that of a harmonic oscillator. In
a solid, sound modes (phonons) are built on a picture of coupled
harmonic oscillators, and in relativistic field theory the fundamental
interactions are also built on coupled oscillators positioned
infinitesimally close to one another in space. The phenomena of a
resonance of an oscillator driven at a fixed frequency plays out
repeatedly in atomic, nuclear and high-energy physics, when quantum
mechanically the evolution of a state oscillates according to
<span class="math notranslate nohighlight">\(e^{-iEt}\)</span> and exciting discrete quantum states has very similar
mathematics as exciting discrete states of an oscillator.</p>
<p>The potential energy for a single particle as a function of its position <span class="math notranslate nohighlight">\(x\)</span> can be written as a Taylor expansion about some point <span class="math notranslate nohighlight">\(x_0\)</span></p>
<!-- Equation labels as ordinary links -->
<div id="_auto37"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
V(x)=V(x_0)+(x-x_0)\left.\partial_xV(x)\right|_{x_0}+\frac{1}{2}(x-x_0)^2\left.\partial_x^2V(x)\right|_{x_0}
+\frac{1}{3!}\left.\partial_x^3V(x)\right|_{x_0}+\cdots
\label{_auto37} \tag{47}
\end{equation}
\]</div>
<p>If the position <span class="math notranslate nohighlight">\(x_0\)</span> is at the minimum of the resonance, the first two non-zero terms of the potential are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
V(x)&amp;\approx&amp; V(x_0)+\frac{1}{2}(x-x_0)^2\left.\partial_x^2V(x)\right|_{x_0},\\
\nonumber
&amp;=&amp;V(x_0)+\frac{1}{2}k(x-x_0)^2,~~~~k\equiv \left.\partial_x^2V(x)\right|_{x_0},\\
\nonumber
F&amp;=&amp;-\partial_xV(x)=-k(x-x_0).
\end{eqnarray}
\end{split}\]</div>
<p>Put into Newton’s 2nd law (assuming <span class="math notranslate nohighlight">\(x_0=0\)</span>),</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
m\ddot{x}&amp;=&amp;-kx,\\
x&amp;=&amp;A\cos(\omega_0 t-\phi),~~~\omega_0=\sqrt{k/m}.
\end{eqnarray}
\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> are arbitrary. Equivalently, one could have
written this as <span class="math notranslate nohighlight">\(A\cos(\omega_0 t)+B\sin(\omega_0 t)\)</span>, or as the real
part of <span class="math notranslate nohighlight">\(Ae^{i\omega_0 t}\)</span>. In this last case <span class="math notranslate nohighlight">\(A\)</span> could be an
arbitrary complex constant. Thus, there are 2 arbitrary constants
(either <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> or <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>, or the real and imaginary part
of one complex constant. This is the expectation for a second order
differential equation, and also agrees with the physical expectation
that if you know a particle’s initial velocity and position you should
be able to define its future motion, and that those two arbitrary
conditions should translate to two arbitrary constants.</p>
<p>A key feature of harmonic motion is that the system repeats itself
after a time <span class="math notranslate nohighlight">\(T=1/f\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the frequency, and <span class="math notranslate nohighlight">\(\omega=2\pi f\)</span>
is the angular frequency. The period of the motion is independent of
the amplitude. However, this independence is only exact when one can
neglect higher terms of the potential, <span class="math notranslate nohighlight">\(x^3, x^4\cdots\)</span>. Once can
neglect these terms for sufficiently small amplitudes, and for larger
amplitudes the motion is no longer purely sinusoidal, and even though
the motion repeats itself, the time for repeating the motion is no
longer independent of the amplitude.</p>
<p>One can also calculate the velocity and the kinetic energy as a function of time,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\dot{x}&amp;=&amp;-\omega_0A\sin(\omega_0 t-\phi),\\
\nonumber
K&amp;=&amp;\frac{1}{2}m\dot{x}^2=\frac{m\omega_0^2A^2}{2}\sin^2(\omega_0t-\phi),\\
\nonumber
&amp;=&amp;\frac{k}{2}A^2\sin^2(\omega_0t-\phi).
\end{eqnarray}
\end{split}\]</div>
<p>The total energy is then</p>
<!-- Equation labels as ordinary links -->
<div id="_auto38"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
E=K+V=\frac{1}{2}m\dot{x}^2+\frac{1}{2}kx^2=\frac{1}{2}kA^2.
\label{_auto38} \tag{48}
\end{equation}
\]</div>
<p>The total energy then goes as the square of the amplitude.</p>
<p>A pendulum is an example of a harmonic oscillator. By expanding the
kinetic and potential energies for small angles find the frequency for
a pendulum of length <span class="math notranslate nohighlight">\(L\)</span> with all the mass <span class="math notranslate nohighlight">\(m\)</span> centered at the end by
writing the eq.s of motion in the form of a harmonic oscillator.</p>
<p>The potential energy and kinetic energies are (for <span class="math notranslate nohighlight">\(x\)</span> being the displacement)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
V&amp;=&amp;mgL(1-\cos\theta)\approx mgL\frac{x^2}{2L^2},\\
K&amp;=&amp;\frac{1}{2}mL^2\dot{\theta}^2\approx \frac{m}{2}\dot{x}^2.
\end{eqnarray*}
\end{split}\]</div>
<p>For small <span class="math notranslate nohighlight">\(x\)</span> Newton’s 2nd law becomes</p>
<div class="math notranslate nohighlight">
\[
m\ddot{x}=-\frac{mg}{L}x,
\]</div>
<p>and the spring constant would appear to be <span class="math notranslate nohighlight">\(k=mg/L\)</span>, which makes the
frequency equal to <span class="math notranslate nohighlight">\(\omega_0=\sqrt{g/L}\)</span>. Note that the frequency is
independent of the mass.</p>
<div class="section" id="damped-oscillators">
<h2>Damped Oscillators<a class="headerlink" href="#damped-oscillators" title="Permalink to this headline">¶</a></h2>
<p>We consider only the case where the damping force is proportional to
the velocity. This is counter to dragging friction, where the force is
proportional in strength to the normal force and independent of
velocity, and is also inconsistent with wind resistance, where the
magnitude of the drag force is proportional the square of the
velocity. Rolling resistance does seem to be mainly proportional to
the velocity. However, the main motivation for considering damping
forces proportional to the velocity is that the math is more
friendly. This is because the differential equation is linear,
i.e. each term is of order <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(\dot{x}\)</span>, <span class="math notranslate nohighlight">\(\ddot{x}\cdots\)</span>, or even
terms with no mention of <span class="math notranslate nohighlight">\(x\)</span>, and there are no terms such as <span class="math notranslate nohighlight">\(x^2\)</span> or
<span class="math notranslate nohighlight">\(x\ddot{x}\)</span>. The equations of motion for a spring with damping force
<span class="math notranslate nohighlight">\(-b\dot{x}\)</span> are</p>
<!-- Equation labels as ordinary links -->
<div id="_auto39"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
m\ddot{x}+b\dot{x}+kx=0.
\label{_auto39} \tag{49}
\end{equation}
\]</div>
<p>Just to make the solution a bit less messy, we rewrite this equation as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:dampeddiffyq"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:dampeddiffyq} \tag{50}
\ddot{x}+2\beta\dot{x}+\omega_0^2x=0,~~~~\beta\equiv b/2m,~\omega_0\equiv\sqrt{k/m}.
\end{equation}
\]</div>
<p>Both <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span> have dimensions of inverse time. To find solutions (see appendix C in the text) you must make an educated guess at the form of the solution. To do this, first realize that the solution will need an arbitrary normalization <span class="math notranslate nohighlight">\(A\)</span> because the equation is linear. Secondly, realize that if the form is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto40"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x=Ae^{rt}
\label{_auto40} \tag{51}
\end{equation}
\]</div>
<p>that each derivative simply brings out an extra power of <span class="math notranslate nohighlight">\(r\)</span>. This
means that the <span class="math notranslate nohighlight">\(Ae^{rt}\)</span> factors out and one can simply solve for an
equation for <span class="math notranslate nohighlight">\(r\)</span>. Plugging this form into Eq. (<a class="reference external" href="#eq:dampeddiffyq">50</a>),</p>
<!-- Equation labels as ordinary links -->
<div id="_auto41"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
r^2+2\beta r+\omega_0^2=0.
\label{_auto41} \tag{52}
\end{equation}
\]</div>
<p>Because this is a quadratic equation there will be two solutions,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto42"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
r=-\beta\pm\sqrt{\beta^2-\omega_0^2}.
\label{_auto42} \tag{53}
\end{equation}
\]</div>
<p>We refer to the two solutions as <span class="math notranslate nohighlight">\(r_1\)</span> and <span class="math notranslate nohighlight">\(r_2\)</span> corresponding to the
<span class="math notranslate nohighlight">\(+\)</span> and <span class="math notranslate nohighlight">\(-\)</span> roots. As expected, there should be two arbitrary
constants involved in the solution,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto43"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x=A_1e^{r_1t}+A_2e^{r_2t},
\label{_auto43} \tag{54}
\end{equation}
\]</div>
<p>where the coefficients <span class="math notranslate nohighlight">\(A_1\)</span> and <span class="math notranslate nohighlight">\(A_2\)</span> are determined by initial
conditions.</p>
<p>The roots listed above, <span class="math notranslate nohighlight">\(\sqrt{\omega_0^2-\beta_0^2}\)</span>, will be
imaginary if the damping is small and <span class="math notranslate nohighlight">\(\beta&lt;\omega_0\)</span>. In that case,
<span class="math notranslate nohighlight">\(r\)</span> is complex and the factor <span class="math notranslate nohighlight">\(e{rt}\)</span> will have some oscillatory
behavior. If the roots are real, there will only be exponentially
decaying solutions. There are three cases:</p>
<div class="section" id="underdamped-beta-omega-0">
<h3>Underdamped: <span class="math notranslate nohighlight">\(\beta&lt;\omega_0\)</span><a class="headerlink" href="#underdamped-beta-omega-0" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
x&amp;=&amp;A_1e^{-\beta t}e^{i\omega't}+A_2e^{-\beta t}e^{-i\omega't},~~\omega'\equiv\sqrt{\omega_0^2-\beta^2}\\
\nonumber
&amp;=&amp;(A_1+A_2)e^{-\beta t}\cos\omega't+i(A_1-A_2)e^{-\beta t}\sin\omega't.
\end{eqnarray}
\end{split}\]</div>
<p>Here we have made use of the identity
<span class="math notranslate nohighlight">\(e^{i\omega't}=\cos\omega't+i\sin\omega't\)</span>. Because the constants are
arbitrary, and because the real and imaginary parts are both solutions
individually, we can simply consider the real part of the solution
alone:</p>
<!-- Equation labels as ordinary links -->
<div id="eq:homogsolution"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:homogsolution} \tag{55}
x&amp;=&amp;B_1e^{-\beta t}\cos\omega't+B_2e^{-\beta t}\sin\omega't,\\
\nonumber 
\omega'&amp;\equiv&amp;\sqrt{\omega_0^2-\beta^2}.
\end{eqnarray}
\end{split}\]</div>
</div>
<div class="section" id="critical-dampling-beta-omega-0">
<h3>Critical dampling: <span class="math notranslate nohighlight">\(\beta=\omega_0\)</span><a class="headerlink" href="#critical-dampling-beta-omega-0" title="Permalink to this headline">¶</a></h3>
<p>In this case the two terms involving <span class="math notranslate nohighlight">\(r_1\)</span> and <span class="math notranslate nohighlight">\(r_2\)</span> are identical
because <span class="math notranslate nohighlight">\(\omega'=0\)</span>. Because we need to arbitrary constants, there
needs to be another solution. This is found by simply guessing, or by
taking the limit of <span class="math notranslate nohighlight">\(\omega'\rightarrow 0\)</span> from the underdamped
solution. The solution is then</p>
<!-- Equation labels as ordinary links -->
<div id="eq:criticallydamped"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:criticallydamped} \tag{56}
x=Ae^{-\beta t}+Bte^{-\beta t}.
\end{equation}
\]</div>
<p>The critically damped solution is interesting because the solution
approaches zero quickly, but does not oscillate. For a problem with
zero initial velocity, the solution never crosses zero. This is a good
choice for designing shock absorbers or swinging doors.</p>
</div>
<div class="section" id="overdamped-beta-omega-0">
<h3>Overdamped: <span class="math notranslate nohighlight">\(\beta&gt;\omega_0\)</span><a class="headerlink" href="#overdamped-beta-omega-0" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
x&amp;=&amp;A_1\exp{-(\beta+\sqrt{\beta^2-\omega_0^2})t}+A_2\exp{-(\beta-\sqrt{\beta^2-\omega_0^2})t}
\end{eqnarray}
\]</div>
<p>This solution will also never pass the origin more than once, and then
only if the initial velocity is strong and initially toward zero.</p>
<p>Given <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(\omega_0\)</span>, find <span class="math notranslate nohighlight">\(x(t)\)</span> for a particle whose
initial position is <span class="math notranslate nohighlight">\(x=0\)</span> and has initial velocity <span class="math notranslate nohighlight">\(v_0\)</span> (assuming an
underdamped solution).</p>
<p>The solution is of the form,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
x&amp;=&amp;e^{-\beta t}\left[A_1\cos(\omega' t)+A_2\sin\omega't\right],\\
\dot{x}&amp;=&amp;-\beta x+\omega'e^{-\beta t}\left[-A_1\sin\omega't+A_2\cos\omega't\right].\\
\omega'&amp;\equiv&amp;\sqrt{\omega_0^2-\beta^2},~~~\beta\equiv b/2m.
\end{eqnarray*}
\end{split}\]</div>
<p>From the initial conditions, <span class="math notranslate nohighlight">\(A_1=0\)</span> because <span class="math notranslate nohighlight">\(x(0)=0\)</span> and <span class="math notranslate nohighlight">\(\omega'A_2=v_0\)</span>. So</p>
<div class="math notranslate nohighlight">
\[
x=\frac{v_0}{\omega'}e^{-\beta t}\sin\omega't.
\]</div>
<p>Here we study first the case without additional friction term and scale our equation
in terms of a dimensionless time <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
<p>Let us remind ourselves about the differential equation we want to solve (the general case with damping due to friction)</p>
<div class="math notranslate nohighlight">
\[
m\frac{d^2x}{dt^2} + b\frac{dx}{dt}+kx(t) =0.
\]</div>
<p>We divide by <span class="math notranslate nohighlight">\(m\)</span> and introduce <span class="math notranslate nohighlight">\(\omega_0^2=\sqrt{k/m}\)</span> and obtain</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{dt^2} + \frac{b}{m}\frac{dx}{dt}+\omega_0^2x(t) =0.
\]</div>
<p>Thereafter we introduce a dimensionless time <span class="math notranslate nohighlight">\(\tau = t\omega_0\)</span> (check
that the dimensionality is correct) and rewrite our equation as</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{d\tau^2} + \frac{b}{m\omega_0}\frac{dx}{d\tau}+x(\tau) =0,
\]</div>
<p>which gives us</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{d\tau^2} + \frac{b}{m\omega_0}\frac{dx}{d\tau}+x(\tau) =0.
\]</div>
<p>We then define <span class="math notranslate nohighlight">\(\gamma = b/(2m\omega_0)\)</span> and rewrite our equations as</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{d\tau^2} + 2\gamma\frac{dx}{d\tau}+x(\tau) =0.
\]</div>
<p>This is the equation we will code below. The first version employs the Euler-Cromer method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>


<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">plt</span><span class="p">,</span> <span class="n">mpl</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>

<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># in years</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Initial conditions as simple one-dimensional arrays of time</span>
<span class="n">x0</span> <span class="o">=</span>  <span class="mf">1.0</span> 
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="c1"># Start integrating using Euler-Cromer&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1"># update velocity, time and position</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="c1">#ax.set_xlim(0, tfinal)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t[s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;BlockEulerCromer&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>When setting up the value of <span class="math notranslate nohighlight">\(\gamma\)</span> we see that for <span class="math notranslate nohighlight">\(\gamma=0\)</span> we get the simple oscillatory motion with no damping.
Choosing <span class="math notranslate nohighlight">\(\gamma &lt; 1\)</span> leads to the classical underdamped case with oscillatory motion, but where the motion comes to an end.</p>
<p>Choosing <span class="math notranslate nohighlight">\(\gamma =1\)</span> leads to what normally is called critical damping and <span class="math notranslate nohighlight">\(\gamma&gt; 1\)</span> leads to critical overdamping.
Try it out and try also to change the initial position and velocity. Setting <span class="math notranslate nohighlight">\(\gamma=1\)</span>
yields a situation, as discussed above, where the solution approaches quickly zero and does not oscillate. With zero initial velocity it will never cross zero.</p>
</div>
</div>
<div class="section" id="sinusoidally-driven-oscillators">
<h2>Sinusoidally Driven Oscillators<a class="headerlink" href="#sinusoidally-driven-oscillators" title="Permalink to this headline">¶</a></h2>
<p>Here, we consider the force</p>
<!-- Equation labels as ordinary links -->
<div id="_auto44"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
F=-kx-b\dot{x}+F_0\cos\omega t,
\label{_auto44} \tag{57}
\end{equation}
\]</div>
<p>which leads to the differential equation</p>
<!-- Equation labels as ordinary links -->
<div id="eq:drivenosc"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:drivenosc} \tag{58}
\ddot{x}+2\beta\dot{x}+\omega_0^2x=(F_0/m)\cos\omega t.
\end{equation}
\]</div>
<p>Consider a single solution with no arbitrary constants, which we will
call a {\it particular solution}, <span class="math notranslate nohighlight">\(x_p(t)\)</span>. It should be emphasized
that this is {\bf A} particular solution, because there exists an
infinite number of such solutions because the general solution should
have two arbitrary constants. Now consider solutions to the same
equation without the driving term, which include two arbitrary
constants. These are called either {\it homogenous solutions} or {\it
complementary solutions}, and were given in the previous section,
e.g. Eq. (<a class="reference external" href="#eq:homogsolution">55</a>) for the underdamped case. The
homogenous solution already incorporates the two arbitrary constants,
so any sum of a homogenous solution and a particular solution will
represent the {\it general solution} of the equation. The general
solution incorporates the two arbitrary constants <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> to
accommodate the two initial conditions. One could have picked a
different particular solution, i.e. the original particular solution
plus any homogenous solution with the arbitrary constants <span class="math notranslate nohighlight">\(A_p\)</span> and
<span class="math notranslate nohighlight">\(B_p\)</span> chosen at will. When one adds in the homogenous solution, which
has adjustable constants with arbitrary constants <span class="math notranslate nohighlight">\(A'\)</span> and <span class="math notranslate nohighlight">\(B'\)</span>, to
the new particular solution, one can get the same general solution by
simply adjusting the new constants such that <span class="math notranslate nohighlight">\(A'+A_p=A\)</span> and
<span class="math notranslate nohighlight">\(B'+B_p=B\)</span>. Thus, the choice of <span class="math notranslate nohighlight">\(A_p\)</span> and <span class="math notranslate nohighlight">\(B_p\)</span> are irrelevant, and
when choosing the particular solution it is best to make the simplest
choice possible.</p>
<p>To find a particular solution, one first guesses at the form,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:partform"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:partform} \tag{59}
x_p(t)=D\cos(\omega t-\delta),
\end{equation}
\]</div>
<p>and rewrite the differential equation as</p>
<!-- Equation labels as ordinary links -->
<div id="_auto45"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
D\left\{-\omega^2\cos(\omega t-\delta)-2\beta\omega\sin(\omega t-\delta)+\omega_0^2\cos(\omega t-\delta)\right\}=\frac{F_0}{m}\cos(\omega t).
\label{_auto45} \tag{60}
\end{equation}
\]</div>
<p>One can now use angle addition formulas to get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
D\left\{(-\omega^2\cos\delta+2\beta\omega\sin\delta+\omega_0^2\cos\delta)\cos(\omega t)\right.&amp;&amp;\\
\nonumber
\left.+(-\omega^2\sin\delta-2\beta\omega\cos\delta+\omega_0^2\sin\delta)\sin(\omega t)\right\}
&amp;=&amp;\frac{F_0}{m}\cos(\omega t).
\end{eqnarray}
\end{split}\]</div>
<p>Both the <span class="math notranslate nohighlight">\(\cos\)</span> and <span class="math notranslate nohighlight">\(\sin\)</span> terms need to equate if the expression is to hold at all times. Thus, this becomes two equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
D\left\{-\omega^2\cos\delta+2\beta\omega\sin\delta+\omega_0^2\cos\delta\right\}&amp;=&amp;\frac{F_0}{m}\\
\nonumber
-\omega^2\sin\delta-2\beta\omega\cos\delta+\omega_0^2\sin\delta&amp;=&amp;0.
\end{eqnarray}
\end{split}\]</div>
<p>After dividing by <span class="math notranslate nohighlight">\(\cos\delta\)</span>, the lower expression leads to</p>
<!-- Equation labels as ordinary links -->
<div id="_auto46"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\tan\delta=\frac{2\beta\omega}{\omega_0^2-\omega^2}.
\label{_auto46} \tag{61}
\end{equation}
\]</div>
<p>Using the identities <span class="math notranslate nohighlight">\(\tan^2+1=\csc^2\)</span> and <span class="math notranslate nohighlight">\(\sin^2+\cos^2=1\)</span>, one can also express <span class="math notranslate nohighlight">\(\sin\delta\)</span> and <span class="math notranslate nohighlight">\(\cos\delta\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\sin\delta&amp;=&amp;\frac{2\beta\omega}{\sqrt{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}},\\
\nonumber
\cos\delta&amp;=&amp;\frac{(\omega_0^2-\omega^2)}{\sqrt{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}}
\end{eqnarray}
\end{split}\]</div>
<p>Inserting the expressions for <span class="math notranslate nohighlight">\(\cos\delta\)</span> and <span class="math notranslate nohighlight">\(\sin\delta\)</span> into the expression for <span class="math notranslate nohighlight">\(D\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:Ddrive"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:Ddrive} \tag{62}
D=\frac{F_0/m}{\sqrt{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}}.
\end{equation}
\]</div>
<p>For a given initial condition, e.g. initial displacement and velocity,
one must add the homogenous solution then solve for the two arbitrary
constants. However, because the homogenous solutions decay with time
as <span class="math notranslate nohighlight">\(e^{-\beta t}\)</span>, the particular solution is all that remains at
large times, and is therefore the steady state solution. Because the
arbitrary constants are all in the homogenous solution, all memory of
the initial conditions are lost at large times, <span class="math notranslate nohighlight">\(t&gt;&gt;1/\beta\)</span>.</p>
<p>The amplitude of the motion, <span class="math notranslate nohighlight">\(D\)</span>, is linearly proportional to the
driving force (<span class="math notranslate nohighlight">\(F_0/m\)</span>), but also depends on the driving frequency
<span class="math notranslate nohighlight">\(\omega\)</span>. For small <span class="math notranslate nohighlight">\(\beta\)</span> the maximum will occur at
<span class="math notranslate nohighlight">\(\omega=\omega_0\)</span>. This is referred to as a resonance. In the limit
<span class="math notranslate nohighlight">\(\beta\rightarrow 0\)</span> the amplitude at resonance approaches infinity.</p>
</div>
<div class="section" id="alternative-derivation-for-driven-oscillators">
<h2>Alternative Derivation for Driven Oscillators<a class="headerlink" href="#alternative-derivation-for-driven-oscillators" title="Permalink to this headline">¶</a></h2>
<p>Here, we derive the same expressions as in Equations (<a class="reference external" href="#eq:partform">59</a>) and (<a class="reference external" href="#eq:Ddrive">62</a>) but express the driving forces as</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
F(t)&amp;=&amp;F_0e^{i\omega t},
\end{eqnarray}
\]</div>
<p>rather than as <span class="math notranslate nohighlight">\(F_0\cos\omega t\)</span>. The real part of <span class="math notranslate nohighlight">\(F\)</span> is the same as before. For the differential equation,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:compdrive"></div>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\label{eq:compdrive} \tag{63}
\ddot{x}+2\beta\dot{x}+\omega_0^2x&amp;=&amp;\frac{F_0}{m}e^{i\omega t},
\end{eqnarray}
\]</div>
<p>one can treat <span class="math notranslate nohighlight">\(x(t)\)</span> as an imaginary function. Because the operations
<span class="math notranslate nohighlight">\(d^2/dt^2\)</span> and <span class="math notranslate nohighlight">\(d/dt\)</span> are real and thus do not mix the real and
imaginary parts of <span class="math notranslate nohighlight">\(x(t)\)</span>, Eq. (<a class="reference external" href="#eq:compdrive">63</a>) is effectively 2
equations. Because <span class="math notranslate nohighlight">\(e^{\omega t}=\cos\omega t+i\sin\omega t\)</span>, the real
part of the solution for <span class="math notranslate nohighlight">\(x(t)\)</span> gives the solution for a driving force
<span class="math notranslate nohighlight">\(F_0\cos\omega t\)</span>, and the imaginary part of <span class="math notranslate nohighlight">\(x\)</span> corresponds to the
case where the driving force is <span class="math notranslate nohighlight">\(F_0\sin\omega t\)</span>. It is rather easy
to solve for the complex <span class="math notranslate nohighlight">\(x\)</span> in this case, and by taking the real part
of the solution, one finds the answer for the <span class="math notranslate nohighlight">\(\cos\omega t\)</span> driving
force.</p>
<p>We assume a simple form for the particular solution</p>
<!-- Equation labels as ordinary links -->
<div id="_auto47"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x_p=De^{i\omega t},
\label{_auto47} \tag{64}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(D\)</span> is a complex constant.</p>
<p>From Eq. (<a class="reference external" href="#eq:compdrive">63</a>) one inserts the form for <span class="math notranslate nohighlight">\(x_p\)</span> above to get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
D\left\{-\omega^2+2i\beta\omega+\omega_0^2\right\}e^{i\omega t}=(F_0/m)e^{i\omega t},\\
\nonumber
D=\frac{F_0/m}{(\omega_0^2-\omega^2)+2i\beta\omega}.
\end{eqnarray}
\end{split}\]</div>
<p>The norm and phase for <span class="math notranslate nohighlight">\(D=|D|e^{-i\delta}\)</span> can be read by inspection,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto48"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
|D|=\frac{F_0/m}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}},~~~~\tan\delta=\frac{2\beta\omega}{\omega_0^2-\omega^2}.
\label{_auto48} \tag{65}
\end{equation}
\]</div>
<p>This is the same expression for <span class="math notranslate nohighlight">\(\delta\)</span> as before. One then finds <span class="math notranslate nohighlight">\(x_p(t)\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:fastdriven1"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:fastdriven1} \tag{66}
x_p(t)&amp;=&amp;\Re\frac{(F_0/m)e^{i\omega t-i\delta}}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}\\
\nonumber
&amp;=&amp;\frac{(F_0/m)\cos(\omega t-\delta)}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}.
\end{eqnarray}
\end{split}\]</div>
<p>This is the same answer as before.
If one wished to solve for the case where <span class="math notranslate nohighlight">\(F(t)= F_0\sin\omega t\)</span>, the imaginary part of the solution would work</p>
<!-- Equation labels as ordinary links -->
<div id="eq:fastdriven2"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:fastdriven2} \tag{67}
x_p(t)&amp;=&amp;\Im\frac{(F_0/m)e^{i\omega t-i\delta}}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}\\
\nonumber
&amp;=&amp;\frac{(F_0/m)\sin(\omega t-\delta)}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}.
\end{eqnarray}
\end{split}\]</div>
<p>Consider the damped and driven harmonic oscillator worked out above. Given <span class="math notranslate nohighlight">\(F_0, m,\beta\)</span> and <span class="math notranslate nohighlight">\(\omega_0\)</span>, solve for the complete solution <span class="math notranslate nohighlight">\(x(t)\)</span> for the case where <span class="math notranslate nohighlight">\(F=F_0\sin\omega t\)</span> with initial conditions <span class="math notranslate nohighlight">\(x(t=0)=0\)</span> and <span class="math notranslate nohighlight">\(v(t=0)=0\)</span>. Assume the underdamped case.</p>
<p>The general solution including the arbitrary constants includes both the homogenous and particular solutions,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
x(t)&amp;=&amp;\frac{F_0}{m}\frac{\sin(\omega t-\delta)}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}
+A\cos\omega't e^{-\beta t}+B\sin\omega't e^{-\beta t}.
\end{eqnarray*}
\]</div>
<p>The quantities <span class="math notranslate nohighlight">\(\delta\)</span> and <span class="math notranslate nohighlight">\(\omega'\)</span> are given earlier in the
section, <span class="math notranslate nohighlight">\(\omega'=\sqrt{\omega_0^2-\beta^2},
\delta=\tan^{-1}(2\beta\omega/(\omega_0^2-\omega^2)\)</span>. Here, solving
the problem means finding the arbitrary constants <span class="math notranslate nohighlight">\(A\)</span> and
<span class="math notranslate nohighlight">\(B\)</span>. Satisfying the initial conditions for the initial position and
velocity:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
x(t=0)=0&amp;=&amp;-\eta\sin\delta+A,\\
v(t=0)=0&amp;=&amp;\omega\eta\cos\delta-\beta A+\omega'B,\\
\eta&amp;\equiv&amp;\frac{F_0}{m}\frac{1}{\sqrt{(\omega_0^2-\omega^2)^2+4\beta^2\omega^2}}.
\end{eqnarray*}
\end{split}\]</div>
<p>The problem is now reduced to 2 equations and 2 unknowns, <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>. The solution is</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
A&amp;=&amp; \eta\sin\delta ,~~~B=\frac{-\omega\eta\cos\delta+\beta\eta\sin\delta}{\omega'}.
\end{eqnarray}
\]</div>
</div>
<div class="section" id="resonance-widths-the-q-factor">
<h2>Resonance Widths; the <span class="math notranslate nohighlight">\(Q\)</span> factor<a class="headerlink" href="#resonance-widths-the-q-factor" title="Permalink to this headline">¶</a></h2>
<p>From the previous two sections, the particular solution for a driving force, <span class="math notranslate nohighlight">\(F=F_0\cos\omega t\)</span>, is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
x_p(t)&amp;=&amp;\frac{F_0/m}{\sqrt{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}}\cos(\omega_t-\delta),\\
\nonumber
\delta&amp;=&amp;\tan^{-1}\left(\frac{2\beta\omega}{\omega_0^2-\omega^2}\right).
\end{eqnarray}
\end{split}\]</div>
<p>If one fixes the driving frequency <span class="math notranslate nohighlight">\(\omega\)</span> and adjusts the
fundamental frequency <span class="math notranslate nohighlight">\(\omega_0=\sqrt{k/m}\)</span>, the maximum amplitude
occurs when <span class="math notranslate nohighlight">\(\omega_0=\omega\)</span> because that is when the term from the
denominator <span class="math notranslate nohighlight">\((\omega_0^2-\omega^2)^2+4\omega^2\beta^2\)</span> is at a
minimum. This is akin to dialing into a radio station. However, if one
fixes <span class="math notranslate nohighlight">\(\omega_0\)</span> and adjusts the driving frequency one minimize with
respect to <span class="math notranslate nohighlight">\(\omega\)</span>, e.g. set</p>
<!-- Equation labels as ordinary links -->
<div id="_auto49"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d}{d\omega}\left[(\omega_0^2-\omega^2)^2+4\omega^2\beta^2\right]=0,
\label{_auto49} \tag{68}
\end{equation}
\]</div>
<p>and one finds that the maximum amplitude occurs when
<span class="math notranslate nohighlight">\(\omega=\sqrt{\omega_0^2-2\beta^2}\)</span>. If <span class="math notranslate nohighlight">\(\beta\)</span> is small relative to
<span class="math notranslate nohighlight">\(\omega_0\)</span>, one can simply state that the maximum amplitude is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto50"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x_{\rm max}\approx\frac{F_0}{2m\beta \omega_0}.
\label{_auto50} \tag{69}
\end{equation}
\]</div>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\frac{4\omega^2\beta^2}{(\omega_0^2-\omega^2)^2+4\omega^2\beta^2}=\frac{1}{2}.
\end{eqnarray}
\]</div>
<p>For small damping this occurs when <span class="math notranslate nohighlight">\(\omega=\omega_0\pm \beta\)</span>, so the <span class="math notranslate nohighlight">\(FWHM\approx 2\beta\)</span>. For the purposes of tuning to a specific frequency, one wants the width to be as small as possible. The ratio of <span class="math notranslate nohighlight">\(\omega_0\)</span> to <span class="math notranslate nohighlight">\(FWHM\)</span> is known as the {\it quality} factor, or <span class="math notranslate nohighlight">\(Q\)</span> factor,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto51"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
Q\equiv \frac{\omega_0}{2\beta}.
\label{_auto51} \tag{70}
\end{equation}
\]</div>
</div>
<div class="section" id="numerical-studies-of-driven-oscillations">
<h2>Numerical Studies of Driven Oscillations<a class="headerlink" href="#numerical-studies-of-driven-oscillations" title="Permalink to this headline">¶</a></h2>
<p>Solving the problem of driven oscillations numerically gives us much
more flexibility to study different types of driving forces. We can
reuse our earlier code by simply adding a driving force. If we stay in
the <span class="math notranslate nohighlight">\(x\)</span>-direction only this can be easily done by adding a term
<span class="math notranslate nohighlight">\(F_{\mathrm{ext}}(x,t)\)</span>. Note that we have kept it rather general
here, allowing for both a spatial and a temporal dependence.</p>
<p>Before we dive into the code, we need to briefly remind ourselves
about the equations we started with for the case with damping, namely</p>
<div class="math notranslate nohighlight">
\[
m\frac{d^2x}{dt^2} + b\frac{dx}{dt}+kx(t) =0,
\]</div>
<p>with no external force applied to the system.</p>
<p>Let us now for simplicty assume that our external force is given by</p>
<div class="math notranslate nohighlight">
\[
F_{\mathrm{ext}}(t) = F_0\cos{(\omega t)},
\]</div>
<p>where <span class="math notranslate nohighlight">\(F_0\)</span> is a constant (what is its dimension?) and <span class="math notranslate nohighlight">\(\omega\)</span> is the frequency of the applied external driving force.
<strong>Small question:</strong> would you expect energy to be conserved now?</p>
<p>Introducing the external force into our lovely differential equation
and dividing by <span class="math notranslate nohighlight">\(m\)</span> and introducing <span class="math notranslate nohighlight">\(\omega_0^2=\sqrt{k/m}\)</span> we have</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{dt^2} + \frac{b}{m}\frac{dx}{dt}+\omega_0^2x(t) =\frac{F_0}{m}\cos{(\omega t)},
\]</div>
<p>Thereafter we introduce a dimensionless time <span class="math notranslate nohighlight">\(\tau = t\omega_0\)</span>
and a dimensionless frequency <span class="math notranslate nohighlight">\(\tilde{\omega}=\omega/\omega_0\)</span>. We have then</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{d\tau^2} + \frac{b}{m\omega_0}\frac{dx}{d\tau}+x(\tau) =\frac{F_0}{m\omega_0^2}\cos{(\tilde{\omega}\tau)},
\]</div>
<p>Introducing a new amplitude <span class="math notranslate nohighlight">\(\tilde{F} =F_0/(m\omega_0^2)\)</span> (check dimensionality again) we have</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{d\tau^2} + \frac{b}{m\omega_0}\frac{dx}{d\tau}+x(\tau) =\tilde{F}\cos{(\tilde{\omega}\tau)}.
\]</div>
<p>Our final step, as we did in the case of various types of damping, is
to define <span class="math notranslate nohighlight">\(\gamma = b/(2m\omega_0)\)</span> and rewrite our equations as</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{d\tau^2} + 2\gamma\frac{dx}{d\tau}+x(\tau) =\tilde{F}\cos{(\tilde{\omega}\tau)}.
\]</div>
<p>This is the equation we will code below using the Euler-Cromer method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># in years</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Initial conditions as one-dimensional arrays of time</span>
<span class="n">x0</span> <span class="o">=</span>  <span class="mf">1.0</span> 
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">Omegatilde</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">Ftilde</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Start integrating using Euler-Cromer&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">Ftilde</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">Omegatilde</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t[s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;ForcedBlockEulerCromer&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>In the above example we have focused on the Euler-Cromer method. This
method has a local truncation error which is proportional to <span class="math notranslate nohighlight">\(\Delta t^2\)</span>
and thereby a global error which is proportional to <span class="math notranslate nohighlight">\(\Delta t\)</span>.
We can improve this by using the Runge-Kutta family of
methods. The widely popular Runge-Kutta to fourth order or just <strong>RK4</strong>
has indeed a much better truncation error. The RK4 method has a global
error which is proportional to <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<p>Let us revisit this method and see how we can implement it for the above example.</p>
</div>
<div class="section" id="differential-equations-runge-kutta-methods">
<h2>Differential Equations, Runge-Kutta methods<a class="headerlink" href="#differential-equations-runge-kutta-methods" title="Permalink to this headline">¶</a></h2>
<p>Runge-Kutta (RK) methods are based on Taylor expansion formulae, but yield
in general better algorithms for solutions of an ordinary differential equation.
The basic philosophy is that it provides an intermediate step in the computation of <span class="math notranslate nohighlight">\(y_{i+1}\)</span>.</p>
<p>To see this, consider first the following definitions</p>
<!-- Equation labels as ordinary links -->
<div id="_auto52"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{dy}{dt}=f(t,y),  
\label{_auto52} \tag{71}
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="_auto53"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
y(t)=\int f(t,y) dt,  
\label{_auto53} \tag{72}
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="_auto54"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
y_{i+1}=y_i+ \int_{t_i}^{t_{i+1}} f(t,y) dt.
\label{_auto54} \tag{73}
\end{equation}
\]</div>
<p>To demonstrate the philosophy behind RK methods, let us consider
the second-order RK method, RK2.
The first approximation consists in Taylor expanding <span class="math notranslate nohighlight">\(f(t,y)\)</span>
around the center of the integration interval <span class="math notranslate nohighlight">\(t_i\)</span> to <span class="math notranslate nohighlight">\(t_{i+1}\)</span>,
that is, at <span class="math notranslate nohighlight">\(t_i+h/2\)</span>, <span class="math notranslate nohighlight">\(h\)</span> being the step.
Using the midpoint formula for an integral,
defining <span class="math notranslate nohighlight">\(y(t_i+h/2) = y_{i+1/2}\)</span> and<br />
<span class="math notranslate nohighlight">\(t_i+h/2 = t_{i+1/2}\)</span>, we obtain</p>
<!-- Equation labels as ordinary links -->
<div id="_auto55"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\int_{t_i}^{t_{i+1}} f(t,y) dt \approx hf(t_{i+1/2},y_{i+1/2}) +O(h^3).
\label{_auto55} \tag{74}
\end{equation}
\]</div>
<p>This means in turn that we have</p>
<!-- Equation labels as ordinary links -->
<div id="_auto56"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
y_{i+1}=y_i + hf(t_{i+1/2},y_{i+1/2}) +O(h^3).
\label{_auto56} \tag{75}
\end{equation}
\]</div>
<p>However, we do not know the value of   <span class="math notranslate nohighlight">\(y_{i+1/2}\)</span>. Here comes thus the next approximation, namely, we use Euler’s
method to approximate <span class="math notranslate nohighlight">\(y_{i+1/2}\)</span>. We have then</p>
<!-- Equation labels as ordinary links -->
<div id="_auto57"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
y_{(i+1/2)}=y_i + \frac{h}{2}\frac{dy}{dt}=y(t_i) + \frac{h}{2}f(t_i,y_i).
\label{_auto57} \tag{76}
\end{equation}
\]</div>
<p>This means that we can define the following algorithm for
the second-order Runge-Kutta method, RK2.</p>
<p>2
6
7</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<!-- Equation labels as ordinary links -->
<div id="_auto59"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
k_2=hf(t_{i+1/2},y_i+k_1/2),
\label{_auto59} \tag{78}
\end{equation}
\]</div>
<p>with the final value</p>
<!-- Equation labels as ordinary links -->
<div id="_auto60"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
y_{i+i}\approx y_i + k_2 +O(h^3). 
\label{_auto60} \tag{79}
\end{equation}
\]</div>
<p>The difference between the previous one-step methods
is that we now need an intermediate step in our evaluation,
namely <span class="math notranslate nohighlight">\(t_i+h/2 = t_{(i+1/2)}\)</span> where we evaluate the derivative <span class="math notranslate nohighlight">\(f\)</span>.
This involves more operations, but the gain is a better stability
in the solution.</p>
<p>The fourth-order Runge-Kutta, RK4, has the following algorithm</p>
<p>2
7
0</p>
<p>&lt;
&lt;
&lt;
!
!
M
A
T
H
_
B
L
O
C
K</p>
<div class="math notranslate nohighlight">
\[
k_3=hf(t_i+h/2,y_i+k_2/2)\hspace{0.5cm}   k_4=hf(t_i+h,y_i+k_3)
\]</div>
<p>with the final result</p>
<div class="math notranslate nohighlight">
\[
y_{i+1}=y_i +\frac{1}{6}\left( k_1 +2k_2+2k_3+k_4\right).
\]</div>
<p>Thus, the algorithm consists in first calculating <span class="math notranslate nohighlight">\(k_1\)</span>
with <span class="math notranslate nohighlight">\(t_i\)</span>, <span class="math notranslate nohighlight">\(y_1\)</span> and <span class="math notranslate nohighlight">\(f\)</span> as inputs. Thereafter, we increase the step
size by <span class="math notranslate nohighlight">\(h/2\)</span> and calculate <span class="math notranslate nohighlight">\(k_2\)</span>, then <span class="math notranslate nohighlight">\(k_3\)</span> and finally <span class="math notranslate nohighlight">\(k_4\)</span>. The global error goes as <span class="math notranslate nohighlight">\(O(h^4)\)</span>.</p>
<p>However, at this stage, if we keep adding different methods in our
main program, the code will quickly become messy and ugly. Before we
proceed thus, we will now introduce functions that enbody the various
methods for solving differential equations. This means that we can
separate out these methods in own functions and files (and later as classes and more
generic functions) and simply call them when needed. Similarly, we
could easily encapsulate various forces or other quantities of
interest in terms of functions. To see this, let us bring up the code
we developed above for the simple sliding block, but now only with the simple forward Euler method. We introduce
two functions, one for the simple Euler method and one for the
force.</p>
<p>Note that here the forward Euler method does not know the specific force function to be called.
It receives just an input the name. We can easily change the force by adding another function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ForwardEuler</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Force</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">SpringForce</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
<span class="c1">#   note here that we have divided by mass and we return the acceleration</span>
    <span class="k">return</span>  <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="n">v</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="n">Ftilde</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">Omegatilde</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>It is easy to add a new method like the Euler-Cromer</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ForwardEulerCromer</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Force</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">Force</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
</pre></div>
</div>
</div>
</div>
<p>and the Velocity Verlet method (be careful with time-dependence here, it is not an ideal method for non-conservative forces))</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">VelocityVerlet</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Force</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">Force</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">a</span>
        <span class="n">anew</span> <span class="o">=</span> <span class="n">Force</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
        <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we can now add the Runge-Kutta2 method via a new function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">RK2</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Force</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="c1"># Setting up k1</span>
        <span class="n">k1x</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">k1v</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="c1"># Setting up k2</span>
        <span class="n">vv</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k1v</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k1x</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">k2x</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">vv</span>
        <span class="n">k2v</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">DeltaT</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># Final result</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k2x</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k2v</span>
	<span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">DeltaT</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we can now add the Runge-Kutta2 method via a new function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">RK4</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Force</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="c1"># Setting up k1</span>
        <span class="n">k1x</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">k1v</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="c1"># Setting up k2</span>
        <span class="n">vv</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k1v</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k1x</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">k2x</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">vv</span>
        <span class="n">k2v</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">DeltaT</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># Setting up k3</span>
        <span class="n">vv</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k2v</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k2x</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">k3x</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">vv</span>
        <span class="n">k3v</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">DeltaT</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># Setting up k4</span>
        <span class="n">vv</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k3v</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k3x</span>
        <span class="n">k4x</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">vv</span>
        <span class="n">k4v</span> <span class="o">=</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">Force</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># Final result</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">k1x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k2x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k3x</span><span class="o">+</span><span class="n">k4x</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">k1v</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k2v</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k3v</span><span class="o">+</span><span class="n">k4v</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span>
        <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
</pre></div>
</div>
</div>
</div>
<p>The Runge-Kutta family of methods are particularly useful when we have a time-dependent acceleration.
If we have forces which depend only the spatial degrees of freedom (no velocity and/or time-dependence), then energy conserving methods like the Velocity Verlet or the Euler-Cromer method are preferred. As soon as we introduce an explicit time-dependence and/or add dissipitave forces like friction or air resistance, then methods like the family of Runge-Kutta methods are well suited for this.
The code below uses the Runge-Kutta4 methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># in years</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Initial conditions (can change to more than one dim)</span>
<span class="n">x0</span> <span class="o">=</span>  <span class="mf">1.0</span> 
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">Omegatilde</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">Ftilde</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Start integrating using Euler&#39;s method</span>
<span class="c1"># Note that we define the force function as a SpringForce</span>
<span class="n">RK4</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">SpringForce</span><span class="p">)</span>

<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t[s]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;ForcedBlockRK4&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="principle-of-superposition-and-periodic-forces-fourier-transforms">
<h2>Principle of Superposition and Periodic Forces (Fourier Transforms)<a class="headerlink" href="#principle-of-superposition-and-periodic-forces-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>If one has several driving forces, <span class="math notranslate nohighlight">\(F(t)=\sum_n F_n(t)\)</span>, one can find
the particular solution to each <span class="math notranslate nohighlight">\(F_n\)</span>, <span class="math notranslate nohighlight">\(x_{pn}(t)\)</span>, and the particular
solution for the entire driving force is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto61"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x_p(t)=\sum_nx_{pn}(t).
\label{_auto61} \tag{80}
\end{equation}
\]</div>
<p>This is known as the principal of superposition. It only applies when
the homogenous equation is linear. If there were an anharmonic term
such as <span class="math notranslate nohighlight">\(x^3\)</span> in the homogenous equation, then when one summed various
solutions, <span class="math notranslate nohighlight">\(x=(\sum_n x_n)^2\)</span>, one would get cross
terms. Superposition is especially useful when <span class="math notranslate nohighlight">\(F(t)\)</span> can be written
as a sum of sinusoidal terms, because the solutions for each
sinusoidal (sine or cosine)  term is analytic, as we saw above.</p>
<p>Driving forces are often periodic, even when they are not
sinusoidal. Periodicity implies that for some time <span class="math notranslate nohighlight">\(\tau\)</span></p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
F(t+\tau)=F(t). 
\end{eqnarray}
\]</div>
<p>One example of a non-sinusoidal periodic force is a square wave. Many
components in electric circuits are non-linear, e.g. diodes, which
makes many wave forms non-sinusoidal even when the circuits are being
driven by purely sinusoidal sources.</p>
<p>The code here shows a typical example of such a square wave generated using the functionality included in the <strong>scipy</strong> Python package. We have used a period of <span class="math notranslate nohighlight">\(\tau=0.2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># number of points                                                                                       </span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="c1"># start and final times                                                                                  </span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">tn</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Period                                                                                                 </span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">SqrSignal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">SqrSignal</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">+</span><span class="n">signal</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">SqrSignal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>For the sinusoidal example studied in the previous subsections the
period is <span class="math notranslate nohighlight">\(\tau=2\pi/\omega\)</span>. However, higher harmonics can also
satisfy the periodicity requirement. In general, any force that
satisfies the periodicity requirement can be expressed as a sum over
harmonics,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto62"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
F(t)=\frac{f_0}{2}+\sum_{n&gt;0} f_n\cos(2n\pi t/\tau)+g_n\sin(2n\pi t/\tau).
\label{_auto62} \tag{81}
\end{equation}
\]</div>
<p>From the previous subsection, one can write down the answer for
<span class="math notranslate nohighlight">\(x_{pn}(t)\)</span>, by substituting <span class="math notranslate nohighlight">\(f_n/m\)</span> or <span class="math notranslate nohighlight">\(g_n/m\)</span> for <span class="math notranslate nohighlight">\(F_0/m\)</span> into Eq.s
(<a class="reference external" href="#eq:fastdriven1">66</a>) or (<a class="reference external" href="#eq:fastdriven2">67</a>) respectively. By
writing each factor <span class="math notranslate nohighlight">\(2n\pi t/\tau\)</span> as <span class="math notranslate nohighlight">\(n\omega t\)</span>, with <span class="math notranslate nohighlight">\(\omega\equiv
2\pi/\tau\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:fourierdef1"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:fourierdef1} \tag{82}
F(t)=\frac{f_0}{2}+\sum_{n&gt;0}f_n\cos(n\omega t)+g_n\sin(n\omega t).
\end{equation}
\]</div>
<p>The solutions for <span class="math notranslate nohighlight">\(x(t)\)</span> then come from replacing <span class="math notranslate nohighlight">\(\omega\)</span> with
<span class="math notranslate nohighlight">\(n\omega\)</span> for each term in the particular solution in Equations
(<a class="reference external" href="#eq:partform">59</a>) and (<a class="reference external" href="#eq:Ddrive">62</a>),</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
x_p(t)&amp;=&amp;\frac{f_0}{2k}+\sum_{n&gt;0} \alpha_n\cos(n\omega t-\delta_n)+\beta_n\sin(n\omega t-\delta_n),\\
\nonumber
\alpha_n&amp;=&amp;\frac{f_n/m}{\sqrt{((n\omega)^2-\omega_0^2)+4\beta^2n^2\omega^2}},\\
\nonumber
\beta_n&amp;=&amp;\frac{g_n/m}{\sqrt{((n\omega)^2-\omega_0^2)+4\beta^2n^2\omega^2}},\\
\nonumber
\delta_n&amp;=&amp;\tan^{-1}\left(\frac{2\beta n\omega}{\omega_0^2-n^2\omega^2}\right).
\end{eqnarray}
\end{split}\]</div>
<p>Because the forces have been applied for a long time, any non-zero
damping eliminates the homogenous parts of the solution, so one need
only consider the particular solution for each <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>The problem will considered solved if one can find expressions for the
coefficients <span class="math notranslate nohighlight">\(f_n\)</span> and <span class="math notranslate nohighlight">\(g_n\)</span>, even though the solutions are expressed
as an infinite sum. The coefficients can be extracted from the
function <span class="math notranslate nohighlight">\(F(t)\)</span> by</p>
<!-- Equation labels as ordinary links -->
<div id="eq:fourierdef2"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:fourierdef2} \tag{83}
f_n&amp;=&amp;\frac{2}{\tau}\int_{-\tau/2}^{\tau/2} dt~F(t)\cos(2n\pi t/\tau),\\
\nonumber
g_n&amp;=&amp;\frac{2}{\tau}\int_{-\tau/2}^{\tau/2} dt~F(t)\sin(2n\pi t/\tau).
\end{eqnarray}
\end{split}\]</div>
<p>To check the consistency of these expressions and to verify
Eq. (<a class="reference external" href="#eq:fourierdef2">83</a>), one can insert the expansion of <span class="math notranslate nohighlight">\(F(t)\)</span> in
Eq. (<a class="reference external" href="#eq:fourierdef1">82</a>) into the expression for the coefficients in
Eq. (<a class="reference external" href="#eq:fourierdef2">83</a>) and see whether</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
f_n&amp;=?&amp;\frac{2}{\tau}\int_{-\tau/2}^{\tau/2} dt~\left\{
\frac{f_0}{2}+\sum_{m&gt;0}f_m\cos(m\omega t)+g_m\sin(m\omega t)
\right\}\cos(n\omega t).
\end{eqnarray}
\]</div>
<p>Immediately, one can throw away all the terms with <span class="math notranslate nohighlight">\(g_m\)</span> because they
convolute an even and an odd function. The term with <span class="math notranslate nohighlight">\(f_0/2\)</span>
disappears because <span class="math notranslate nohighlight">\(\cos(n\omega t)\)</span> is equally positive and negative
over the interval and will integrate to zero. For all the terms
<span class="math notranslate nohighlight">\(f_m\cos(m\omega t)\)</span> appearing in the sum, one can use angle addition
formulas to see that <span class="math notranslate nohighlight">\(\cos(m\omega t)\cos(n\omega
t)=(1/2)(\cos[(m+n)\omega t]+\cos[(m-n)\omega t]\)</span>. This will integrate
to zero unless <span class="math notranslate nohighlight">\(m=n\)</span>. In that case the <span class="math notranslate nohighlight">\(m=n\)</span> term gives</p>
<!-- Equation labels as ordinary links -->
<div id="_auto63"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\int_{-\tau/2}^{\tau/2}dt~\cos^2(m\omega t)=\frac{\tau}{2},
\label{_auto63} \tag{84}
\end{equation}
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
f_n&amp;=?&amp;\frac{2}{\tau}\int_{-\tau/2}^{\tau/2} dt~f_n/2\\
\nonumber
&amp;=&amp;f_n~\checkmark.
\end{eqnarray}
\end{split}\]</div>
<p>The same method can be used to check for the consistency of <span class="math notranslate nohighlight">\(g_n\)</span>.</p>
<p>Consider the driving force:</p>
<!-- Equation labels as ordinary links -->
<div id="_auto64"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
F(t)=At/\tau,~~-\tau/2&lt;t&lt;\tau/2,~~~F(t+\tau)=F(t).
\label{_auto64} \tag{85}
\end{equation}
\]</div>
<p>Find the Fourier coefficients <span class="math notranslate nohighlight">\(f_n\)</span> and <span class="math notranslate nohighlight">\(g_n\)</span> for all <span class="math notranslate nohighlight">\(n\)</span> using Eq. (<a class="reference external" href="#eq:fourierdef2">83</a>).</p>
<p>Only the odd coefficients enter by symmetry, i.e. <span class="math notranslate nohighlight">\(f_n=0\)</span>. One can find <span class="math notranslate nohighlight">\(g_n\)</span> integrating by parts,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:fouriersolution"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:fouriersolution} \tag{86}
g_n&amp;=&amp;\frac{2}{\tau}\int_{-\tau/2}^{\tau/2}dt~\sin(n\omega t) \frac{At}{\tau}\\
\nonumber
u&amp;=&amp;t,~dv=\sin(n\omega t)dt,~v=-\cos(n\omega t)/(n\omega),\\
\nonumber
g_n&amp;=&amp;\frac{-2A}{n\omega \tau^2}\int_{-\tau/2}^{\tau/2}dt~\cos(n\omega t)
+\left.2A\frac{-t\cos(n\omega t)}{n\omega\tau^2}\right|_{-\tau/2}^{\tau/2}.
\end{eqnarray}
\end{split}\]</div>
<p>The first term is zero because <span class="math notranslate nohighlight">\(\cos(n\omega t)\)</span> will be equally
positive and negative over the interval. Using the fact that
<span class="math notranslate nohighlight">\(\omega\tau=2\pi\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
g_n&amp;=&amp;-\frac{2A}{2n\pi}\cos(n\omega\tau/2)\\
\nonumber
&amp;=&amp;-\frac{A}{n\pi}\cos(n\pi)\\
\nonumber
&amp;=&amp;\frac{A}{n\pi}(-1)^{n+1}.
\end{eqnarray}
\end{split}\]</div>
</div>
<div class="section" id="fourier-series">
<h2>Fourier Series<a class="headerlink" href="#fourier-series" title="Permalink to this headline">¶</a></h2>
<p>More text will come here, chpater 5.7-5.8 of Taylor are discussed
during the lectures. The code here uses the Fourier series discussed
in chapter 5.7 for a square wave signal. The equations for the
coefficients are are discussed in Taylor section 5.7, see Example
5.4. The code here visualizes the various approximations given by
Fourier series compared with a square wave with period <span class="math notranslate nohighlight">\(T=0.2\)</span>, witth
<span class="math notranslate nohighlight">\(0.1\)</span> and max value <span class="math notranslate nohighlight">\(F=2\)</span>. We see that when we increase the number of
components in the Fourier series, the Fourier series approximation gets closes and closes to the square wave signal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># number of points                                                                                       </span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="c1"># start and final times                                                                                  </span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">tn</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Period                                                                                                 </span>
<span class="n">T</span> <span class="o">=</span><span class="mf">0.2</span>
<span class="c1"># Max value of square signal                                                                             </span>
<span class="n">Fmax</span><span class="o">=</span> <span class="mf">2.0</span>
<span class="c1"># Width of signal                                                                                        </span>
<span class="n">Width</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">SqrSignal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">FourierSeriesSignal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">SqrSignal</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">+</span><span class="n">signal</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Width</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
<span class="n">a0</span> <span class="o">=</span> <span class="n">Fmax</span><span class="o">*</span><span class="n">Width</span><span class="o">/</span><span class="n">T</span>
<span class="n">FourierSeriesSignal</span> <span class="o">=</span> <span class="n">a0</span>
<span class="n">Factor</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">Fmax</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">500</span><span class="p">):</span>
    <span class="n">FourierSeriesSignal</span> <span class="o">+=</span> <span class="n">Factor</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="n">Width</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">SqrSignal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">FourierSeriesSignal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="solving-differential-equations-with-fouries-series">
<h2>Solving differential equations with Fouries series<a class="headerlink" href="#solving-differential-equations-with-fouries-series" title="Permalink to this headline">¶</a></h2>
<p>The material here was discussed during the lecture of February 19 and 21.
It is also covered by Taylor in section 5.8.</p>
<p>Consider a particle at rest in the bottom of an underdamped harmonic
oscillator, that then feels a sudden impulse, or change in momentum,
<span class="math notranslate nohighlight">\(I=F\Delta t\)</span> at <span class="math notranslate nohighlight">\(t=0\)</span>. This increases the velocity immediately by an
amount <span class="math notranslate nohighlight">\(v_0=I/m\)</span> while not changing the position. One can then solve
the trajectory by solving Eq. (<a class="reference external" href="#eq:homogsolution">55</a>) with initial
conditions <span class="math notranslate nohighlight">\(v_0=I/m\)</span> and <span class="math notranslate nohighlight">\(x_0=0\)</span>. This gives</p>
<!-- Equation labels as ordinary links -->
<div id="_auto65"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x(t)=\frac{I}{m\omega'}e^{-\beta t}\sin\omega't, ~~t&gt;0.
\label{_auto65} \tag{87}
\end{equation}
\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\omega'=\sqrt{\omega_0^2-\beta^2}\)</span>. For an impulse <span class="math notranslate nohighlight">\(I_i\)</span> that
occurs at time <span class="math notranslate nohighlight">\(t_i\)</span> the trajectory would be</p>
<!-- Equation labels as ordinary links -->
<div id="_auto66"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x(t)=\frac{I_i}{m\omega'}e^{-\beta (t-t_i)}\sin[\omega'(t-t_i)] \Theta(t-t_i),
\label{_auto66} \tag{88}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\Theta(t-t_i)\)</span> is a step function, i.e. <span class="math notranslate nohighlight">\(\Theta(x)\)</span> is zero for
<span class="math notranslate nohighlight">\(x&lt;0\)</span> and unity for <span class="math notranslate nohighlight">\(x&gt;0\)</span>. If there were several impulses linear
superposition tells us that we can sum over each contribution,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto67"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x(t)=\sum_i\frac{I_i}{m\omega'}e^{-\beta(t-t_i)}\sin[\omega'(t-t_i)]\Theta(t-t_i)
\label{_auto67} \tag{89}
\end{equation}
\]</div>
<p>Now one can consider a series of impulses at times separated by
<span class="math notranslate nohighlight">\(\Delta t\)</span>, where each impulse is given by <span class="math notranslate nohighlight">\(F_i\Delta t\)</span>. The sum
above now becomes an integral,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:Greeny"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}\label{eq:Greeny} \tag{90}
x(t)&amp;=&amp;\int_{-\infty}^\infty dt'~F(t')\frac{e^{-\beta(t-t')}\sin[\omega'(t-t')]}{m\omega'}\Theta(t-t')\\
\nonumber
&amp;=&amp;\int_{-\infty}^\infty dt'~F(t')G(t-t'),\\
\nonumber
G(\Delta t)&amp;=&amp;\frac{e^{-\beta\Delta t}\sin[\omega' \Delta t]}{m\omega'}\Theta(\Delta t)
\end{eqnarray}
\end{split}\]</div>
<p>The quantity
<span class="math notranslate nohighlight">\(e^{-\beta(t-t')}\sin[\omega'(t-t')]/m\omega'\Theta(t-t')\)</span> is called a
Green’s function, <span class="math notranslate nohighlight">\(G(t-t')\)</span>. It describes the response at <span class="math notranslate nohighlight">\(t\)</span> due to a
force applied at a time <span class="math notranslate nohighlight">\(t'\)</span>, and is a function of <span class="math notranslate nohighlight">\(t-t'\)</span>. The step
function ensures that the response does not occur before the force is
applied. One should remember that the form for <span class="math notranslate nohighlight">\(G\)</span> would change if the
oscillator were either critically- or over-damped.</p>
<p>When performing the integral in Eq. (<a class="reference external" href="#eq:Greeny">90</a>) one can use
angle addition formulas to factor out the part with the <span class="math notranslate nohighlight">\(t'\)</span>
dependence in the integrand,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:Greeny2"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:Greeny2} \tag{91}
x(t)&amp;=&amp;\frac{1}{m\omega'}e^{-\beta t}\left[I_c(t)\sin(\omega't)-I_s(t)\cos(\omega't)\right],\\
\nonumber
I_c(t)&amp;\equiv&amp;\int_{-\infty}^t dt'~F(t')e^{\beta t'}\cos(\omega't'),\\
\nonumber
I_s(t)&amp;\equiv&amp;\int_{-\infty}^t dt'~F(t')e^{\beta t'}\sin(\omega't').
\end{eqnarray}
\end{split}\]</div>
<p>If the time <span class="math notranslate nohighlight">\(t\)</span> is beyond any time at which the force acts,
<span class="math notranslate nohighlight">\(F(t'&gt;t)=0\)</span>, the coefficients <span class="math notranslate nohighlight">\(I_c\)</span> and <span class="math notranslate nohighlight">\(I_s\)</span> become independent of
<span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>Consider an undamped oscillator (<span class="math notranslate nohighlight">\(\beta\rightarrow 0\)</span>), with
characteristic frequency <span class="math notranslate nohighlight">\(\omega_0\)</span> and mass <span class="math notranslate nohighlight">\(m\)</span>, that is at rest
until it feels a force described by a Gaussian form,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
F(t)&amp;=&amp;F_0 \exp\left\{\frac{-t^2}{2\tau^2}\right\}.
\end{eqnarray*}
\]</div>
<p>For large times (<span class="math notranslate nohighlight">\(t&gt;&gt;\tau\)</span>), where the force has died off, find
<span class="math notranslate nohighlight">\(x(t)\)</span>.\ Solve for the coefficients <span class="math notranslate nohighlight">\(I_c\)</span> and <span class="math notranslate nohighlight">\(I_s\)</span> in
Eq. (<a class="reference external" href="#eq:Greeny2">91</a>). Because the Gaussian is an even function,
<span class="math notranslate nohighlight">\(I_s=0\)</span>, and one need only solve for <span class="math notranslate nohighlight">\(I_c\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
I_c&amp;=&amp;F_0\int_{-\infty}^\infty dt'~e^{-t^{\prime 2}/(2\tau^2)}\cos(\omega_0 t')\\
&amp;=&amp;\Re F_0 \int_{-\infty}^\infty dt'~e^{-t^{\prime 2}/(2\tau^2)}e^{i\omega_0 t'}\\
&amp;=&amp;\Re F_0 \int_{-\infty}^\infty dt'~e^{-(t'-i\omega_0\tau^2)^2/(2\tau^2)}e^{-\omega_0^2\tau^2/2}\\
&amp;=&amp;F_0\tau \sqrt{2\pi} e^{-\omega_0^2\tau^2/2}.
\end{eqnarray*}
\end{split}\]</div>
<p>The third step involved completing the square, and the final step used the fact that the integral</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
\int_{-\infty}^\infty dx~e^{-x^2/2}&amp;=&amp;\sqrt{2\pi}.
\end{eqnarray*}
\]</div>
<p>To see that this integral is true, consider the square of the integral, which you can change to polar coordinates,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
I&amp;=&amp;\int_{-\infty}^\infty dx~e^{-x^2/2}\\
I^2&amp;=&amp;\int_{-\infty}^\infty dxdy~e^{-(x^2+y^2)/2}\\
&amp;=&amp;2\pi\int_0^\infty rdr~e^{-r^2/2}\\
&amp;=&amp;2\pi.
\end{eqnarray*}
\end{split}\]</div>
<p>Finally, the expression for <span class="math notranslate nohighlight">\(x\)</span> from Eq. (<a class="reference external" href="#eq:Greeny2">91</a>) is</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
x(t&gt;&gt;\tau)&amp;=&amp;\frac{F_0\tau}{m\omega_0} \sqrt{2\pi} e^{-\omega_0^2\tau^2/2}\sin(\omega_0t).
\end{eqnarray*}
\]</div>
</div>
<div class="section" id="id3">
<h2>The classical pendulum and scaling the equations<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Let us end our discussion of oscillations with another classical case, the pendulum.</p>
<p>The angular equation of motion of the pendulum is given by
Newton’s equation and with no external force it reads</p>
<!-- Equation labels as ordinary links -->
<div id="_auto68"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  ml\frac{d^2\theta}{dt^2}+mgsin(\theta)=0,
\label{_auto68} \tag{92}
\end{equation}
\]</div>
<p>with an angular velocity and acceleration given by</p>
<!-- Equation labels as ordinary links -->
<div id="_auto69"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
     v=l\frac{d\theta}{dt},
\label{_auto69} \tag{93}
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="_auto70"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
     a=l\frac{d^2\theta}{dt^2}.
\label{_auto70} \tag{94}
\end{equation}
\]</div>
<p>We do however expect that the motion will gradually come to an end due a viscous drag torque acting on the pendulum.
In the presence of the drag, the above equation becomes</p>
<!-- Equation labels as ordinary links -->
<div id="_auto71"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   ml\frac{d^2\theta}{dt^2}+\nu\frac{d\theta}{dt}  +mgsin(\theta)=0, 
\label{_auto71} \tag{95}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu\)</span> is now a positive constant parameterizing the viscosity
of the medium in question. In order to maintain the motion against
viscosity, it is necessary to add some external driving force.
We choose here a periodic driving force. The last equation becomes then</p>
<!-- Equation labels as ordinary links -->
<div id="_auto72"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   ml\frac{d^2\theta}{dt^2}+\nu\frac{d\theta}{dt}  +mgsin(\theta)=Asin(\omega t), 
\label{_auto72} \tag{96}
\end{equation}
\]</div>
<p>with <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span> two constants representing the amplitude and
the angular frequency respectively. The latter is called the driving frequency.</p>
<p>We define</p>
<div class="math notranslate nohighlight">
\[
\omega_0=\sqrt{g/l},
\]</div>
<p>the so-called natural frequency and the new dimensionless quantities</p>
<div class="math notranslate nohighlight">
\[
\hat{t}=\omega_0t,
\]</div>
<p>with the dimensionless driving frequency</p>
<div class="math notranslate nohighlight">
\[
\hat{\omega}=\frac{\omega}{\omega_0},
\]</div>
<p>and introducing the quantity <span class="math notranslate nohighlight">\(Q\)</span>, called the <em>quality factor</em>,</p>
<div class="math notranslate nohighlight">
\[
Q=\frac{mg}{\omega_0\nu},
\]</div>
<p>and the dimensionless amplitude</p>
<div class="math notranslate nohighlight">
\[
\hat{A}=\frac{A}{mg}
\]</div>
<p>We have</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2\theta}{d\hat{t}^2}+\frac{1}{Q}\frac{d\theta}{d\hat{t}}  
     +sin(\theta)=\hat{A}cos(\hat{\omega}\hat{t}).
\]</div>
<p>This equation can in turn be recast in terms of two coupled first-order differential equations as follows</p>
<div class="math notranslate nohighlight">
\[
\frac{d\theta}{d\hat{t}}=\hat{v},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{d\hat{v}}{d\hat{t}}=-\frac{\hat{v}}{Q}-sin(\theta)+\hat{A}cos(\hat{\omega}\hat{t}).
\]</div>
<p>These are the equations to be solved.  The factor <span class="math notranslate nohighlight">\(Q\)</span> represents the
number of oscillations of the undriven system that must occur before
its energy is significantly reduced due to the viscous drag. The
amplitude <span class="math notranslate nohighlight">\(\hat{A}\)</span> is measured in units of the maximum possible
gravitational torque while <span class="math notranslate nohighlight">\(\hat{\omega}\)</span> is the angular frequency of
the external torque measured in units of the pendulum’s natural
frequency.</p>
</div>
</div>
<div class="section" id="gravity-and-central-forces">
<h1>Gravity and Central Forces<a class="headerlink" href="#gravity-and-central-forces" title="Permalink to this headline">¶</a></h1>
<p>The gravitational potential energy and forces involving two masses <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
U_{ab}&amp;=&amp;-\frac{Gm_am_b}{|\boldsymbol{r}_a-\boldsymbol{r}_b|},\\
\nonumber
F_{ba}&amp;=&amp;-\frac{Gm_am_b}{|\boldsymbol{r}_a-\boldsymbol{r}_b|^2}\hat{r}_{ab},\\
\nonumber
\hat{r}_{ab}&amp;=&amp;\frac{\boldsymbol{r}_b-\boldsymbol{r}_a}{|\boldsymbol{r}_a-\boldsymbol{r}_b|}.
\end{eqnarray}
\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(G=6.67\times 10^{-11}\)</span> Nm<span class="math notranslate nohighlight">\(^2\)</span>/kg<span class="math notranslate nohighlight">\(^2\)</span>, and <span class="math notranslate nohighlight">\(F_{ba}\)</span> is the force
on <span class="math notranslate nohighlight">\(b\)</span> due to <span class="math notranslate nohighlight">\(a\)</span>. By inspection, one can see that the force on <span class="math notranslate nohighlight">\(b\)</span>
due to <span class="math notranslate nohighlight">\(a\)</span> and the force on <span class="math notranslate nohighlight">\(a\)</span> due to <span class="math notranslate nohighlight">\(b\)</span> are equal and opposite. The
net potential energy for a large number of masses would be</p>
<!-- Equation labels as ordinary links -->
<div id="_auto73"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
U=\sum_{a&lt;b}U_{ab}=\frac{1}{2}\sum_{a\ne b}U_{ab}.
\label{_auto73} \tag{97}
\end{equation}
\]</div>
<div class="section" id="relative-and-center-of-mass-motion">
<h2>Relative and Center of Mass Motion<a class="headerlink" href="#relative-and-center-of-mass-motion" title="Permalink to this headline">¶</a></h2>
<p>Thus far, we have considered the trajectory as if the force is
centered around a fixed point. For two bodies interacting only with
one another, both masses circulate around the center of mass. One
might think that solutions would become more complex when both
particles move, but we will see here that the problem can be reduced
to one with a single body moving according to a fixed force by
expressing the trajectories for <span class="math notranslate nohighlight">\(\boldsymbol{r}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}_2\)</span> into the
center-of-mass coordinate <span class="math notranslate nohighlight">\(\boldsymbol{R}_{\rm cm}\)</span> and the relative
coordinate <span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\boldsymbol{R}_{\rm cm}&amp;\equiv&amp;\frac{m_1\boldsymbol{r}_1+m_2\boldsymbol{r}_2}{m_1+m_2},\\
\nonumber
\boldsymbol{r}&amp;\equiv&amp;\boldsymbol{r}_1-\boldsymbol{r_2}.
\end{eqnarray}
\end{split}\]</div>
<p>Here, we assume the two particles interact only with one another, so
<span class="math notranslate nohighlight">\(\boldsymbol{F}_{12}=-\boldsymbol{F}_{21}\)</span> (where <span class="math notranslate nohighlight">\(\boldsymbol{F}_{ij}\)</span> is the force on <span class="math notranslate nohighlight">\(i\)</span>
due to <span class="math notranslate nohighlight">\(j\)</span>. The equations of motion then become</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\ddot{\boldsymbol{R}}_{\rm cm}&amp;=&amp;\frac{1}{m_1+m_2}\left\{m_1\ddot{\boldsymbol{r}}_1+m_2\ddot{\boldsymbol{r}}_2\right\}\\
\nonumber
&amp;=&amp;\frac{1}{m_1+m_2}\left\{\boldsymbol{F}_{12}+\boldsymbol{F}_{21}\right\}=0.\\
\ddot{\boldsymbol{r}}&amp;=&amp;\ddot{\boldsymbol{r}}_1-\ddot{\boldsymbol{r}}_2=\left(\frac{\boldsymbol{F}_{12}}{m_1}-\frac{\boldsymbol{F}_{21}}{m_2}\right)\\
\nonumber
&amp;=&amp;\left(\frac{1}{m_1}+\frac{1}{m_2}\right)\boldsymbol{F}_{12}.
\end{eqnarray}
\end{split}\]</div>
<p>The first expression simply states that the center of mass coordinate
<span class="math notranslate nohighlight">\(\boldsymbol{R}_{\rm cm}\)</span> moves at a fixed velocity. The second expression
can be rewritten in terms of the reduced mass <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\mu \ddot{\boldsymbol{r}}&amp;=&amp;\boldsymbol{F}_{12},\\
\frac{1}{\mu}&amp;=&amp;\frac{1}{m_1}+\frac{1}{m_2},~~~~\mu=\frac{m_1m_2}{m_1+m_2}.
\end{eqnarray}
\end{split}\]</div>
<p>Thus, one can treat the trajectory as a one-body problem where the
reduced mass is <span class="math notranslate nohighlight">\(\mu\)</span>, and a second trivial problem for the center of
mass. The reduced mass is especially convenient when one is
considering gravitational problems because then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\mu \ddot{r}&amp;=&amp;-\frac{Gm_1m_2}{r^2}\hat{r}\\
\nonumber
&amp;=&amp;-\frac{GM\mu}{r^2}\hat{r},~~~M\equiv m_1+m_2.
\end{eqnarray}
\end{split}\]</div>
<p>For the gravitational problem, the reduced mass then falls out and the
trajectory depends only on the total mass <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>The kinetic energy and momenta also have analogues in center-of-mass
coordinates. The total and relative momenta are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\boldsymbol{P}&amp;\equiv&amp;\boldsymbol{p}_1+\boldsymbol{p}_2=M\dot{\boldsymbol{R}}_{\rm cm},\\
\nonumber
\boldsymbol{q}&amp;\equiv&amp;\mu\dot{\boldsymbol{r}}.
\end{eqnarray}
\end{split}\]</div>
<p>With these definitions, a little algebra shows that the kinetic energy becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
T&amp;=&amp;\frac{1}{2}m_1|\boldsymbol{v}_1|^2+\frac{1}{2}m_2|\boldsymbol{v}_2|^2\\
\nonumber
&amp;=&amp;\frac{1}{2}M|\dot{\boldsymbol{R}}_{\rm cm}|^2
+\frac{1}{2}\mu|\dot{\boldsymbol{r}}|^2\\
\nonumber
&amp;=&amp;\frac{P^2}{2M}+\frac{q^2}{2\mu}.
\end{eqnarray}
\end{split}\]</div>
<p>The standard strategy is to transform into the center of mass frame,
then treat the problem as one of a single particle of mass <span class="math notranslate nohighlight">\(\mu\)</span>
undergoing a force <span class="math notranslate nohighlight">\(\boldsymbol{F}_{12}\)</span>. Scattering angles can also be
expressed in this frame, then transformed into the lab frame. In
practice, one sees examples in the literature where <span class="math notranslate nohighlight">\(d\sigma/d\Omega\)</span>
expressed in both the “center-of-mass” and in the “laboratory”
frame.</p>
</div>
<div class="section" id="deriving-elliptical-orbits">
<h2>Deriving Elliptical Orbits<a class="headerlink" href="#deriving-elliptical-orbits" title="Permalink to this headline">¶</a></h2>
<p>Kepler’s laws state that a gravitational orbit should be an ellipse
with the source of the gravitational field at one focus. Deriving this
is surprisingly messy. To do this, we first use angular momentum
conservation to transform the equations of motion so that it is in
terms of <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span> instead of <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(t\)</span>. The overall strategy
is to</p>
<ol class="simple">
<li><p>Find equations of motion for <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(t\)</span> with no angle (<span class="math notranslate nohighlight">\(\theta\)</span>) mentioned, i.e. <span class="math notranslate nohighlight">\(d^2r/dt^2=\cdots\)</span>. Angular momentum conservation will be used, and the equation will involve the angular momentum <span class="math notranslate nohighlight">\(L\)</span>.</p></li>
<li><p>Use angular momentum conservation to find an expression for <span class="math notranslate nohighlight">\(\dot{\theta}\)</span> in terms of <span class="math notranslate nohighlight">\(r\)</span>.</p></li>
<li><p>Use the chain rule to convert the equations of motions for <span class="math notranslate nohighlight">\(r\)</span>, an expression involving <span class="math notranslate nohighlight">\(r,\dot{r}\)</span> and <span class="math notranslate nohighlight">\(\ddot{r}\)</span>, to one involving <span class="math notranslate nohighlight">\(r,dr/d\theta\)</span> and <span class="math notranslate nohighlight">\(d^2r/d\theta^2\)</span>. This is quitecomplicated because the expressions will also involve a substitution <span class="math notranslate nohighlight">\(u=1/r\)</span> so that one finds an expression in terms of <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span>.</p></li>
<li><p>Once <span class="math notranslate nohighlight">\(u(\theta)\)</span> is found, you need to show that this can be converted to the familiar form for an ellipse.</p></li>
</ol>
<p>The equations of motion give</p>
<!-- Equation labels as ordinary links -->
<div id="eq:radialeqofmotion"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:radialeqofmotion} \tag{98}
\frac{d}{dt}r^2&amp;=&amp;\frac{d}{dt}(x^2+y^2)=2x\dot{x}+2y\dot{y}=2r\dot{r},\\
\nonumber
\dot{r}&amp;=&amp;\frac{x}{r}\dot{x}+\frac{y}{r}\dot{y},\\
\nonumber
\ddot{r}&amp;=&amp;\frac{x}{r}\ddot{x}+\frac{y}{r}\ddot{y}
+\frac{\dot{x}^2+\dot{y}^2}{r}
-\frac{\dot{r}^2}{r}.
\end{eqnarray}
\end{split}\]</div>
<p>Recognizing that the numerator of the third term is the velocity squared, and that it can be written in polar coordinates,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto74"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v^2=\dot{x}^2+\dot{y}^2=\dot{r}^2+r^2\dot{\theta}^2,
\label{_auto74} \tag{99}
\end{equation}
\]</div>
<p>one can write <span class="math notranslate nohighlight">\(\ddot{r}\)</span> as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:radialeqofmotion2"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:radialeqofmotion2} \tag{100}
\ddot{r}&amp;=&amp;\frac{F_x\cos\theta+F_y\sin\theta}{m}+\frac{\dot{r}^2+r^2\dot{\theta}^2}{r}-\frac{\dot{r}^2}{r}\\
\nonumber
&amp;=&amp;\frac{F}{m}+\frac{r^2\dot{\theta}^2}{r}\\
\nonumber
m\ddot{r}&amp;=&amp;F+\frac{L^2}{mr^3}.
\end{eqnarray}
\end{split}\]</div>
<p>This derivation used the fact that the force was radial,
<span class="math notranslate nohighlight">\(F=F_r=F_x\cos\theta+F_y\sin\theta\)</span>, and that angular momentum is
<span class="math notranslate nohighlight">\(L=mrv_{\theta}=mr^2\dot{\theta}\)</span>. The term <span class="math notranslate nohighlight">\(L^2/mr^3=mv^2/r\)</span> behaves
like an additional force. Sometimes this is referred to as a
centrifugal force, but it is not a force. Instead, it is the
consequence of considering the motion in a rotating (and therefore
accelerating) frame.</p>
<p>Now, we switch to the particular case of an attractive inverse square
force, <span class="math notranslate nohighlight">\(F=-\alpha/r^2\)</span>, and show that the trajectory, <span class="math notranslate nohighlight">\(r(\theta)\)</span>, is
an ellipse. To do this we transform derivatives w.r.t. time to
derivatives w.r.t. <span class="math notranslate nohighlight">\(\theta\)</span> using the chain rule combined with angular
momentum conservation, <span class="math notranslate nohighlight">\(\dot{\theta}=L/mr^2\)</span>.</p>
<!-- Equation labels as ordinary links -->
<div id="eq:rtotheta"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:rtotheta} \tag{101}
\dot{r}&amp;=&amp;\frac{dr}{d\theta}\dot{\theta}=\frac{dr}{d\theta}\frac{L}{mr^2},\\
\nonumber
\ddot{r}&amp;=&amp;\frac{d^2r}{d\theta^2}\dot{\theta}^2
+\frac{dr}{d\theta}\left(\frac{d}{dr}\frac{L}{mr^2}\right)\dot{r}\\
\nonumber
&amp;=&amp;\frac{d^2r}{d\theta^2}\left(\frac{L}{mr^2}\right)^2
-2\frac{dr}{d\theta}\frac{L}{mr^3}\dot{r}\\
\nonumber
&amp;=&amp;\frac{d^2r}{d\theta^2}\left(\frac{L}{mr^2}\right)^2
-\frac{2}{r}\left(\frac{dr}{d\theta}\right)^2\left(\frac{L}{mr^2}\right)^2
\end{eqnarray}
\end{split}\]</div>
<p>Equating the two expressions for <span class="math notranslate nohighlight">\(\ddot{r}\)</span> in Eq.s (<a class="reference external" href="#eq:radialeqofmotion2">100</a>) and (<a class="reference external" href="#eq:rtotheta">101</a>) eliminates all the derivatives w.r.t. time, and provides a differential equation with only derivatives w.r.t. <span class="math notranslate nohighlight">\(\theta\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:rdotdot"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:rdotdot} \tag{102}
\frac{d^2r}{d\theta^2}\left(\frac{L}{mr^2}\right)^2
-\frac{2}{r}\left(\frac{dr}{d\theta}\right)^2\left(\frac{L}{mr^2}\right)^2
=\frac{F}{m}+\frac{L^2}{m^2r^3},
\end{equation}
\]</div>
<p>that when solved yields the trajectory, i.e. <span class="math notranslate nohighlight">\(r(\theta)\)</span>. Up to this
point the expressions work for any radial force, not just forces that
fall as <span class="math notranslate nohighlight">\(1/r^2\)</span>.</p>
<p>The trick to simplifying this differential equation for the inverse
square problems is to make a substitution, <span class="math notranslate nohighlight">\(u\equiv 1/r\)</span>, and rewrite
the differential equation for <span class="math notranslate nohighlight">\(u(\theta)\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
r&amp;=&amp;1/u,\\
\nonumber
\frac{dr}{d\theta}&amp;=&amp;-\frac{1}{u^2}\frac{du}{d\theta},\\
\nonumber
\frac{d^2r}{d\theta^2}&amp;=&amp;\frac{2}{u^3}\left(\frac{du}{d\theta}\right)^2-\frac{1}{u^2}\frac{d^2u}{d\theta^2}.
\end{eqnarray}
\end{split}\]</div>
<p>Plugging these expressions into Eq. (<a class="reference external" href="#eq:rdotdot">102</a>) gives an
expression in terms of <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(du/d\theta\)</span>, and <span class="math notranslate nohighlight">\(d^2u/d\theta^2\)</span>. After
some tedious algebra,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto75"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d^2u}{d\theta^2}=-u-\frac{F m}{L^2u^2}.
\label{_auto75} \tag{103}
\end{equation}
\]</div>
<p>For the attractive inverse square law force, <span class="math notranslate nohighlight">\(F=-\alpha u^2\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto76"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d^2u}{d\theta^2}=-u+\frac{m\alpha}{L^2}.
\label{_auto76} \tag{104}
\end{equation}
\]</div>
<p>The solution has two arbitrary constants, <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(\theta_0\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:Ctrajectory"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:Ctrajectory} \tag{105}
u&amp;=&amp;\frac{m\alpha}{L^2}+A\cos(\theta-\theta_0),\\
\nonumber
r&amp;=&amp;\frac{1}{(m\alpha/L^2)+A\cos(\theta-\theta_0)}.
\end{eqnarray}
\end{split}\]</div>
<p>The radius will be at a minimum when <span class="math notranslate nohighlight">\(\theta=\theta_0\)</span> and at a
maximum when <span class="math notranslate nohighlight">\(\theta=\theta_0+\pi\)</span>. The constant <span class="math notranslate nohighlight">\(A\)</span> is related to the
eccentricity of the orbit. When <span class="math notranslate nohighlight">\(A=0\)</span> the radius is a constant
<span class="math notranslate nohighlight">\(r=L^2/(m\alpha)\)</span>, and the motion is circular. If one solved the
expression <span class="math notranslate nohighlight">\(mv^2/r=-\alpha/r^2\)</span> for a circular orbit, using the
substitution <span class="math notranslate nohighlight">\(v=L/(mr)\)</span>, one would reproduce the expression
<span class="math notranslate nohighlight">\(r=L^2/(m\alpha)\)</span>.</p>
<p>The form describing the elliptical trajectory in
Eq. (<a class="reference external" href="#eq:Ctrajectory">105</a>) can be identified as an ellipse with one
focus being the center of the ellipse by considering the definition of
an ellipse as being the points such that the sum of the two distances
between the two foci are a constant. Making that distance <span class="math notranslate nohighlight">\(2D\)</span>, the
distance between the two foci as <span class="math notranslate nohighlight">\(2a\)</span>, and putting one focus at the
origin,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
2D&amp;=&amp;r+\sqrt{(r\cos\theta-2a)^2+r^2\sin^2\theta},\\
\nonumber
4D^2+r^2-4Dr&amp;=&amp;r^2+4a^2-4ar\cos\theta,\\
\nonumber
r&amp;=&amp;\frac{D^2-a^2}{D+a\cos\theta}=\frac{1}{D/(D^2-a^2)-a\cos\theta/(D^2-a^2)}.
\end{eqnarray}
\end{split}\]</div>
<p>By inspection, this is the same form as Eq. (<a class="reference external" href="#eq:Ctrajectory">105</a>) with <span class="math notranslate nohighlight">\(D/(D^2-a^2)=m\alpha/L^2\)</span> and <span class="math notranslate nohighlight">\(a/(D^2-a^2)=A\)</span>.</p>
<p>Let us remind ourselves about what an ellipse is before we proceed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>

<span class="n">u</span><span class="o">=</span><span class="mf">1.</span>     <span class="c1">#x-position of the center</span>
<span class="n">v</span><span class="o">=</span><span class="mf">0.5</span>    <span class="c1">#y-position of the center</span>
<span class="n">a</span><span class="o">=</span><span class="mf">2.</span>     <span class="c1">#radius on the x-axis</span>
<span class="n">b</span><span class="o">=</span><span class="mf">1.5</span>    <span class="c1">#radius on the y-axis</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">u</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="p">,</span> <span class="n">v</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="effective-or-centrifugal-potential">
<h2>Effective or Centrifugal Potential<a class="headerlink" href="#effective-or-centrifugal-potential" title="Permalink to this headline">¶</a></h2>
<p>The total energy of a particle is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
E&amp;=&amp;U(r)+\frac{1}{2}mv_\theta^2+\frac{1}{2}m\dot{r}^2\\
\nonumber
&amp;=&amp;U(r)+\frac{1}{2}mr^2\dot{\theta}^2+\frac{1}{2}m\dot{r}^2\\
\nonumber
&amp;=&amp;U(r)+\frac{L^2}{2mr^2}+\frac{1}{2}m\dot{r}^2.
\end{eqnarray}
\end{split}\]</div>
<p>The second term then contributes to the energy like an additional
repulsive potential. The term is sometimes referred to as the
“centrifugal” potential, even though it is actually the kinetic energy
of the angular motion. Combined with <span class="math notranslate nohighlight">\(U(r)\)</span>, it is sometimes referred
to as the “effective” potential,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
U_{\rm eff}(r)&amp;=&amp;U(r)+\frac{L^2}{2mr^2}.
\end{eqnarray}
\]</div>
<p>Note that if one treats the effective potential like a real potential, one would expect to be able to generate an effective force,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
F_{\rm eff}&amp;=&amp;-\frac{d}{dr}U(r) -\frac{d}{dr}\frac{L^2}{2mr^2}\\
\nonumber
&amp;=&amp;F(r)+\frac{L^2}{mr^3}=F(r)+m\frac{v_\perp^2}{r},
\end{eqnarray}
\end{split}\]</div>
<p>which is indeed matches the form for <span class="math notranslate nohighlight">\(m\ddot{r}\)</span> in Eq. (<a class="reference external" href="#eq:radialeqofmotion2">100</a>), which included the <strong>centrifugal</strong> force.</p>
<p>The following code plots this effective potential for a simple choice of parameters, with a standard gravitational potential <span class="math notranslate nohighlight">\(-\alpha/r\)</span>. Here we have chosen <span class="math notranslate nohighlight">\(L=m=\alpha=1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">Deltax</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays</span>
<span class="n">xinitial</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">xfinal</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># spring constant</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># mass, you can change these</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">((</span><span class="n">xfinal</span><span class="o">-</span><span class="n">xinitial</span><span class="p">)</span><span class="o">/</span><span class="n">Deltax</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xinitial</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">Deltax</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="n">x</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Plot potential</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;r[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;V[J]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="gravitational-force-example">
<h3>Gravitational force example<a class="headerlink" href="#gravitational-force-example" title="Permalink to this headline">¶</a></h3>
<p>Using the above parameters, we can now study the evolution of the system using for example the velocity Verlet method.
This is done in the code here for an initial radius equal to the minimum of the potential well.  We seen then that the radius is always the same and corresponds to a circle (the radius is always constant).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>


<span class="c1"># Simple Gravitational Force   -alpha/r</span>
    
<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">100.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v and r</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Constants of the model, setting all variables to one for simplicity</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># scale mass to one</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">m</span>
<span class="n">rmin</span> <span class="o">=</span> <span class="p">(</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">m</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span>
<span class="c1"># Initial conditions</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">rmin</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up acceleration</span>
    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="c1"># Plot position as function of time</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Velocity&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;RadialGVV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Changing the value of the initial position to a value where the energy is positive, leads to an increasing radius with time, a so-called unbound orbit. Choosing on the other hand an initial radius that corresponds to a negative energy and different from the minimum value leads to a radius that oscillates back and forth between two values.</p>
</div>
<div class="section" id="harmonic-oscillator-in-two-dimensions">
<h3>Harmonic Oscillator in two dimensions<a class="headerlink" href="#harmonic-oscillator-in-two-dimensions" title="Permalink to this headline">¶</a></h3>
<p>Consider a particle of mass <span class="math notranslate nohighlight">\(m\)</span> in a 2-dimensional harmonic oscillator with potential</p>
<div class="math notranslate nohighlight">
\[
U=\frac{1}{2}kr^2=\frac{1}{2}k(x^2+y^2).
\]</div>
<p>If the orbit has angular momentum <span class="math notranslate nohighlight">\(L\)</span>, we can find the radius and angular velocity of the circular orbit as well as the b) the angular frequency of small radial perturbations.</p>
<p>We consider the effective potential. The radius of a circular orbit is at the minimum of the potential (where the effective force is zero).
The potential is plotted here with the parameters <span class="math notranslate nohighlight">\(k=m=0.1\)</span> and <span class="math notranslate nohighlight">\(L=1.0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">Deltax</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays</span>
<span class="n">xinitial</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">xfinal</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">0.1</span>   <span class="c1"># spring constant</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">0.1</span>   <span class="c1"># mass, you can change these</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">((</span><span class="n">xfinal</span><span class="o">-</span><span class="n">xinitial</span><span class="p">)</span><span class="o">/</span><span class="n">Deltax</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xinitial</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">Deltax</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Plot potential</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;r[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;V[J]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
U_{\rm eff}&amp;=&amp;\frac{1}{2}kr^2+\frac{L^2}{2mr^2}
\end{eqnarray*}
\]</div>
<p>The effective potential looks like that of a harmonic oscillator for
large <span class="math notranslate nohighlight">\(r\)</span>, but for small <span class="math notranslate nohighlight">\(r\)</span>, the centrifugal potential repels the
particle from the origin. The combination of the two potentials has a
minimum for at some radius <span class="math notranslate nohighlight">\(r_{\rm min}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
0&amp;=&amp;kr_{\rm min}-\frac{L^2}{mr_{\rm min}^3},\\
r_{\rm min}&amp;=&amp;\left(\frac{L^2}{mk}\right)^{1/4},\\
\dot{\theta}&amp;=&amp;\frac{L}{mr_{\rm min}^2}=\sqrt{k/m}.
\end{eqnarray*}
\end{split}\]</div>
<p>For particles at <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> with <span class="math notranslate nohighlight">\(\dot{r}=0\)</span>, the particle does not
accelerate and <span class="math notranslate nohighlight">\(r\)</span> stays constant, i.e. a circular orbit. The radius
of the circular orbit can be adjusted by changing the angular momentum
<span class="math notranslate nohighlight">\(L\)</span>.</p>
<p>For the above parameters this minimum is at <span class="math notranslate nohighlight">\(r_{\rm min}=1\)</span>.</p>
<p>Now consider small vibrations about <span class="math notranslate nohighlight">\(r_{\rm min}\)</span>. The effective spring constant is the curvature of the effective potential.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
k_{\rm eff}&amp;=&amp;\left.\frac{d^2}{dr^2}U_{\rm eff}(r)\right|_{r=r_{\rm min}}=k+\frac{3L^2}{mr_{\rm min}^4}\\
&amp;=&amp;4k,\\
\omega&amp;=&amp;\sqrt{k_{\rm eff}/m}=2\sqrt{k/m}=2\dot{\theta}.
\end{eqnarray*}
\end{split}\]</div>
<p>Here, the second step used the result of the last step from part
(a). Because the radius oscillates with twice the angular frequency,
the orbit has two places where <span class="math notranslate nohighlight">\(r\)</span> reaches a minimum in one
cycle. This differs from the inverse-square force where there is one
minimum in an orbit. One can show that the orbit for the harmonic
oscillator is also elliptical, but in this case the center of the
potential is at the center of the ellipse, not at one of the foci.</p>
<p>The solution is also simple to write down exactly in Cartesian coordinates. The <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> equations of motion separate,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\ddot{x}&amp;=&amp;-kx,\\
\ddot{y}&amp;=&amp;-ky.
\end{eqnarray*}
\end{split}\]</div>
<p>So the general solution can be expressed as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
x&amp;=&amp;A\cos\omega_0 t+B\sin\omega_0 t,\\
y&amp;=&amp;C\cos\omega_0 t+D\sin\omega_0 t.
\end{eqnarray*}
\end{split}\]</div>
<p>The code here finds the solution for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> using the code we developed in homework 4.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Constants of the model</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">0.1</span>   <span class="c1"># spring constant</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">0.1</span>   <span class="c1"># mass, you can change these</span>
<span class="n">omega02</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">m</span><span class="p">)</span>  <span class="c1"># Frequency</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">rmin</span> <span class="o">=</span> <span class="p">(</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">k</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="c1">#x0 =rmin*0.5; y0 = sqrt(rmin*rmin-x0*x0)</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">y0</span><span class="o">=</span> <span class="mf">1.0</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">])</span> 
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">omega02</span>  
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">omega02</span>  
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time</span>
<span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;radius squared&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x position&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y position&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;2DimHOVV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>With some work using double angle formulas, one can calculate</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
r^2&amp;=&amp;x^2+y^2\\
\nonumber
&amp;=&amp;(A^2+C^2)\cos^2(\omega_0t)+(B^2+D^2)\sin^2\omega_0t+(AB+CD)\cos(\omega_0t)\sin(\omega_0t)\\
\nonumber
&amp;=&amp;\alpha+\beta\cos 2\omega_0 t+\gamma\sin 2\omega_0 t,\\
\alpha&amp;=&amp;\frac{A^2+B^2+C^2+D^2}{2},~~\beta=\frac{A^2-B^2+C^2-D^2}{2},~~\gamma=AB+CD,\\
r^2&amp;=&amp;\alpha+(\beta^2+\gamma^2)^{1/2}\cos(2\omega_0 t-\delta),~~~\delta=\arctan(\gamma/\beta),
\end{eqnarray*}
\end{split}\]</div>
<p>and see that radius oscillates with frequency <span class="math notranslate nohighlight">\(2\omega_0\)</span>. The
factor of two comes because the oscillation <span class="math notranslate nohighlight">\(x=A\cos\omega_0t\)</span> has two
maxima for <span class="math notranslate nohighlight">\(x^2\)</span>, one at <span class="math notranslate nohighlight">\(t=0\)</span> and one a half period later.</p>
<p>The following code shows first how we can solve this problem using the radial degrees of freedom only.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v and r</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Constants of the model</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">omega02</span> <span class="o">=</span> <span class="n">k</span><span class="o">/</span><span class="n">m</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">m</span>
<span class="n">rmin</span> <span class="o">=</span> <span class="p">(</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">k</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25</span>
<span class="c1"># Initial conditions</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">rmin</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v0</span><span class="o">*</span><span class="n">v0</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">r0</span><span class="o">*</span><span class="n">r0</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="p">(</span><span class="n">r0</span><span class="o">*</span><span class="n">r0</span><span class="p">)</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up acceleration</span>
    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">omega02</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>    
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">omega02</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># Plot position as function of time</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">E</span><span class="p">)</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;RadialHOVV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="stability-of-orbits">
<h2>Stability of Orbits<a class="headerlink" href="#stability-of-orbits" title="Permalink to this headline">¶</a></h2>
<p>The effective force can be extracted from the effective potential, <span class="math notranslate nohighlight">\(U_{\rm eff}\)</span>. Beginning from the equations of motion, Eq. (<a class="reference external" href="#eq:radialeqofmotion">98</a>), for <span class="math notranslate nohighlight">\(r\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
m\ddot{r}&amp;=&amp;F+\frac{L^2}{mr^3}\\
\nonumber
&amp;=&amp;F_{\rm eff}\\
\nonumber
&amp;=&amp;-\partial_rU_{\rm eff},\\
\nonumber
F_{\rm eff}&amp;=&amp;-\partial_r\left[U(r)+(L^2/2mr^2)\right].
\end{eqnarray}
\end{split}\]</div>
<p>For a circular orbit, the radius must be fixed as a function of time,
so one must be at a maximum or a minimum of the effective
potential. However, if one is at a maximum of the effective potential
the radius will be unstable. For the attractive Coulomb force the
effective potential will be dominated by the <span class="math notranslate nohighlight">\(-\alpha/r\)</span> term for
large <span class="math notranslate nohighlight">\(r\)</span> because the centrifugal part falls off more quickly, <span class="math notranslate nohighlight">\(\sim
1/r^2\)</span>. At low <span class="math notranslate nohighlight">\(r\)</span> the centrifugal piece wins and the effective
potential is repulsive. Thus, the potential must have a minimum
somewhere with negative potential. The circular orbits are then stable
to perturbation.</p>
<p>The effective potential is sketched for two cases, a <span class="math notranslate nohighlight">\(1/r\)</span> attractive
potential and a <span class="math notranslate nohighlight">\(1/r^3\)</span> attractive potential. The <span class="math notranslate nohighlight">\(1/r\)</span> case has a
stable minimum, whereas the circular orbit in the <span class="math notranslate nohighlight">\(1/r^3\)</span> case is
unstable.</p>
<p>If one considers a potential that falls as <span class="math notranslate nohighlight">\(1/r^3\)</span>, the situation is
reversed and the point where <span class="math notranslate nohighlight">\(\partial_rU\)</span> disappears will be a local
maximum rather than a local minimum. <strong>Fig to come here with code</strong></p>
<p>The repulsive centrifugal piece dominates at large <span class="math notranslate nohighlight">\(r\)</span> and the attractive
Coulomb piece wins out at small <span class="math notranslate nohighlight">\(r\)</span>. The circular orbit is then at a
maximum of the effective potential and the orbits are unstable. It is
the clear that for potentials that fall as <span class="math notranslate nohighlight">\(r^n\)</span>, that one must have
<span class="math notranslate nohighlight">\(n&gt;-2\)</span> for the orbits to be stable.</p>
<p>Consider a potential <span class="math notranslate nohighlight">\(U(r)=\beta r\)</span>. For a particle of mass <span class="math notranslate nohighlight">\(m\)</span> with
angular momentum <span class="math notranslate nohighlight">\(L\)</span>, find the angular frequency of a circular
orbit. Then find the angular frequency for small radial perturbations.</p>
<p>For the circular orbit you search for the position <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> where the effective potential is minimized,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\partial_r\left\{\beta r+\frac{L^2}{2mr^2}\right\}&amp;=&amp;0,\\
\beta&amp;=&amp;\frac{L^2}{mr_{\rm min}^3},\\
r_{\rm min}&amp;=&amp;\left(\frac{L^2}{\beta m}\right)^{1/3},\\
\dot{\theta}&amp;=&amp;\frac{L}{mr_{\rm min}^2}=\frac{\beta^{2/3}}{(mL)^{1/3}}
\end{eqnarray*}
\end{split}\]</div>
<p>Now, we can find the angular frequency of small perturbations about the circular orbit. To do this we find the effective spring constant for the effective potential,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
k_{\rm eff}&amp;=&amp;\partial_r^2 \left.U_{\rm eff}\right|_{r_{\rm min}}\\
&amp;=&amp;\frac{3L^2}{mr_{\rm min}^4},\\
\omega&amp;=&amp;\sqrt{\frac{k_{\rm eff}}{m}}\\
&amp;=&amp;\frac{\beta^{2/3}}{(mL)^{1/3}}\sqrt{3}.
\end{eqnarray*}
\end{split}\]</div>
<p>If the two frequencies, <span class="math notranslate nohighlight">\(\dot{\theta}\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span>, differ by an
integer factor, the orbit’s trajectory will repeat itself each time
around. This is the case for the inverse-square force,
<span class="math notranslate nohighlight">\(\omega=\dot{\theta}\)</span>, and for the harmonic oscillator,
<span class="math notranslate nohighlight">\(\omega=2\dot{\theta}\)</span>. In this case, <span class="math notranslate nohighlight">\(\omega=\sqrt{3}\dot{\theta}\)</span>,
and the angles at which the maxima and minima occur change with each
orbit.</p>
<div class="section" id="code-example-with-gravitional-force">
<h3>Code example with gravitional force<a class="headerlink" href="#code-example-with-gravitional-force" title="Permalink to this headline">¶</a></h3>
<p>The code example here is meant to illustrate how we can make a plot of the final orbit. We solve the equations in polar coordinates (the example here uses the minimum of the potential as initial value) and then we transform back to cartesian coordinates and plot <span class="math notranslate nohighlight">\(x\)</span> versus <span class="math notranslate nohighlight">\(y\)</span>. We see that we get a perfect circle when we place ourselves at the minimum of the potential energy, as expected.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simple Gravitational Force   -alpha/r</span>
    
<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">8.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v and r</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Constants of the model, setting all variables to one for simplicity</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># scale mass to one</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">m</span>
<span class="n">rmin</span> <span class="o">=</span> <span class="p">(</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">m</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span>
<span class="c1"># Initial conditions, place yourself at the potential min</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">rmin</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># starts at rest</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">phi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up acceleration</span>
    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="p">(</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Find cartesian coordinates for easy plot    </span>
<span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Angle $\cos{\phi}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;Phasespace&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Try to change the initial value for <span class="math notranslate nohighlight">\(r\)</span> and see what kind of orbits you get.
In order to test different energies, it can be useful to look at the plot of the effective potential discussed above.</p>
<p>However, for orbits different from a circle the above code would need modifications in order to allow us to display say an ellipse. For the latter, it is much easier to run our code in cartesian coordinates, as done here. In this code we test also energy conservation and see that it is conserved to numerical precision. The code here is a simple extension of the code we developed for homework 4.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Constants of the model</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># mass, you can change these</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">y0</span><span class="o">=</span> <span class="mf">0.</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">])</span> 
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="n">rabs</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="n">rabs</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y position&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y position&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;2DimGravity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="scattering-and-cross-sections">
<h2>Scattering and Cross Sections<a class="headerlink" href="#scattering-and-cross-sections" title="Permalink to this headline">¶</a></h2>
<p>Scattering experiments don’t measure entire trajectories. For elastic
collisions, they measure the distribution of final scattering angles
at best. Most experiments use targets thin enough so that the number
of scatterings is typically zero or one. The cross section, <span class="math notranslate nohighlight">\(\sigma\)</span>,
describes the cross-sectional area for particles to scatter with an
individual target atom or nucleus. Cross section measurements form the
basis for MANY fields of physics. BThe cross section, and the
differential cross section, encapsulates everything measurable for a
collision where all that is measured is the final state, e.g. the
outgoing particle had momentum <span class="math notranslate nohighlight">\(\boldsymbol{p}_f\)</span>. y studying cross sections,
one can infer information about the potential interaction between the
two particles. Inferring, or constraining, the potential from the
cross section is a classic {\it inverse} problem. Collisions are
either elastic or inelastic. Elastic collisions are those for which
the two bodies are in the same internal state before and after the
collision. If the collision excites one of the participants into a
higher state, or transforms the particles into different species, or
creates additional particles, the collision is inelastic. Here, we
consider only elastic collisions.</p>
<p>For Coulomb forces, the cross section is infinite because the range of
the Coulomb force is infinite, but for interactions such as the strong
interaction in nuclear or particle physics, there is no long-range
force and cross-sections are finite. Even for Coulomb forces, the part
of the cross section that corresponds to a specific scattering angle,
<span class="math notranslate nohighlight">\(d\sigma/d\Omega\)</span>, which is a function of the scattering angle
<span class="math notranslate nohighlight">\(\theta_s\)</span> is still finite.</p>
<p>If a particle travels through a thin target, the chance the particle
scatters is <span class="math notranslate nohighlight">\(P_{\rm scatt}=\sigma dN/dA\)</span>, where <span class="math notranslate nohighlight">\(dN/dA\)</span> is the number
of scattering centers per area the particle encounters. If the density
of the target is <span class="math notranslate nohighlight">\(\rho\)</span> particles per volume, and if the thickness of
the target is <span class="math notranslate nohighlight">\(t\)</span>, the areal density (number of target scatterers per
area) is <span class="math notranslate nohighlight">\(dN/dA=\rho t\)</span>. Because one wishes to quantify the collisions
independently of the target, experimentalists measure scattering
probabilities, then divide by the areal density to obtain
cross-sections,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\sigma=\frac{P_{\rm scatt}}{dN/dA}.
\end{eqnarray}
\]</div>
<p>Instead of merely stating that a particle collided, one can measure
the probability the particle scattered by a given angle. The
scattering angle <span class="math notranslate nohighlight">\(\theta_s\)</span> is defined so that at zero the particle is
unscattered and at <span class="math notranslate nohighlight">\(\theta_s=\pi\)</span> the particle is scattered directly
backward. Scattering angles are often described in the center-of-mass
frame, but that is a detail we will neglect for this first discussion,
where we will consider the scattering of particles moving classically
under the influence of fixed potentials <span class="math notranslate nohighlight">\(U(\boldsymbol{r})\)</span>. Because the
distribution of scattering angles can be measured, one expresses the
differential cross section,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto77"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d^2\sigma}{d\cos\theta_s~d\phi}.
\label{_auto77} \tag{106}
\end{equation}
\]</div>
<p>Usually, the literature expresses differential cross sections as</p>
<!-- Equation labels as ordinary links -->
<div id="_auto78"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
d\sigma/d\Omega=\frac{d\sigma}{d\cos\theta d\phi}=\frac{1}{2\pi}\frac{d\sigma}{d\cos\theta},
\label{_auto78} \tag{107}
\end{equation}
\]</div>
<p>where the last equivalency is true when the scattering does not depend
on the azimuthal angle <span class="math notranslate nohighlight">\(\phi\)</span>, as is the case for spherically
symmetric potentials.</p>
<p>The differential solid angle <span class="math notranslate nohighlight">\(d\Omega\)</span> can be thought of as the area
subtended by a measurement, <span class="math notranslate nohighlight">\(dA_d\)</span>, divided by <span class="math notranslate nohighlight">\(r^2\)</span>, where <span class="math notranslate nohighlight">\(r\)</span> is the
distance to the detector,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
dA_d=r^2 d\Omega.
\end{eqnarray}
\]</div>
<p>With this definition <span class="math notranslate nohighlight">\(d\sigma/d\Omega\)</span> is independent of the distance
from which one places the detector, or the size of the detector (as
long as it is small).</p>
<p>Differential scattering cross sections are calculated by assuming a
random distribution of impact parameters <span class="math notranslate nohighlight">\(b\)</span>. These represent the
distance in the <span class="math notranslate nohighlight">\(xy\)</span> plane for particles moving in the <span class="math notranslate nohighlight">\(z\)</span> direction
relative to the scattering center. An impact parameter <span class="math notranslate nohighlight">\(b=0\)</span> refers to
being aimed directly at the target’s center. The impact parameter
describes the transverse distance from the <span class="math notranslate nohighlight">\(z=0\)</span> axis for the
trajectory when it is still far away from the scattering center and
has not yet passed it. The differential cross section can be expressed
in terms of the impact parameter,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto79"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
d\sigma=2\pi bdb,
\label{_auto79} \tag{108}
\end{equation}
\]</div>
<p>which is the area of a thin ring of radius <span class="math notranslate nohighlight">\(b\)</span> and thickness <span class="math notranslate nohighlight">\(db\)</span>. In
classical physics, one can calculate the trajectory given the incoming
kinetic energy <span class="math notranslate nohighlight">\(E\)</span> and the impact parameter if one knows the mass and
potential. From the trajectory, one then finds the scattering angle
<span class="math notranslate nohighlight">\(\theta_s(b)\)</span>. The differential cross section is then</p>
<!-- Equation labels as ordinary links -->
<div id="_auto80"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d\sigma}{d\Omega}=\frac{1}{2\pi}\frac{d\sigma}{d\cos\theta_s}=b\frac{db}{d\cos\theta_s}=\frac{b}{(d/db)\cos\theta_s(b)}.
\label{_auto80} \tag{109}
\end{equation}
\]</div>
<p>Typically, one would calculate <span class="math notranslate nohighlight">\(\cos\theta_s\)</span> and <span class="math notranslate nohighlight">\((d/db)\cos\theta_s\)</span>
as functions of <span class="math notranslate nohighlight">\(b\)</span>. This is sufficient to plot the differential cross
section as a function of <span class="math notranslate nohighlight">\(\theta_s\)</span>.</p>
<p>The total cross section is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto81"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\sigma_{\rm tot}=\int d\Omega\frac{d\sigma}{d\Omega}=2\pi\int d\cos\theta_s~\frac{d\sigma}{d\Omega}. 
\label{_auto81} \tag{110}
\end{equation}
\]</div>
<p>Even if the total cross section is infinite, e.g. Coulomb forces, one
can still have a finite differential cross section as we will see
later on.</p>
<p>An asteroid of mass <span class="math notranslate nohighlight">\(m\)</span> and kinetic energy <span class="math notranslate nohighlight">\(E\)</span> approaches a planet of
radius <span class="math notranslate nohighlight">\(R\)</span> and mass <span class="math notranslate nohighlight">\(M\)</span>. What is the cross section for the asteroid to
impact the planet?</p>
<div class="section" id="solution">
<h3>Solution<a class="headerlink" href="#solution" title="Permalink to this headline">¶</a></h3>
<p>Calculate the maximum impact parameter, <span class="math notranslate nohighlight">\(b_{\rm max}\)</span>, for which the asteroid will hit the planet. The total cross  section for impact is <span class="math notranslate nohighlight">\(\sigma_{\rm impact}=\pi b_{\rm max}^2\)</span>. The maximum cross-section can be found with the help of angular momentum conservation. The asteroid’s incoming momentum is <span class="math notranslate nohighlight">\(p_0=\sqrt{2mE}\)</span> and the angular momentum is <span class="math notranslate nohighlight">\(L=p_0b\)</span>. If the asteroid just grazes the planet, it is moving with zero radial kinetic energy at impact. Combining energy and angular momentum conservation and having <span class="math notranslate nohighlight">\(p_f\)</span> refer to the momentum of the asteroid at a distance <span class="math notranslate nohighlight">\(R\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\frac{p_f^2}{2m}-\frac{GMm}{R}&amp;=&amp;E,\\
p_fR&amp;=&amp;p_0b_{\rm max},
\end{eqnarray*}
\end{split}\]</div>
<p>allows one to solve for <span class="math notranslate nohighlight">\(b_{\rm max}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
b_{\rm max}&amp;=&amp;R\frac{p_f}{p_0}\\
&amp;=&amp;R\frac{\sqrt{2m(E+GMm/R)}}{\sqrt{2mE}}\\
\sigma_{\rm impact}&amp;=&amp;\pi R^2\frac{E+GMm/R}{E}.
\end{eqnarray*}
\end{split}\]</div>
</div>
</div>
<div class="section" id="rutherford-scattering">
<h2>Rutherford Scattering<a class="headerlink" href="#rutherford-scattering" title="Permalink to this headline">¶</a></h2>
<p>This refers to the calculation of <span class="math notranslate nohighlight">\(d\sigma/d\Omega\)</span> due to an inverse
square force, <span class="math notranslate nohighlight">\(F_{12}=\pm\alpha/r^2\)</span> for repulsive/attractive
interaction. Rutherford compared the scattering of <span class="math notranslate nohighlight">\(\alpha\)</span> particles
(<span class="math notranslate nohighlight">\(^4\)</span>He nuclei) off of a nucleus and found the scattering angle at
which the formula began to fail. This corresponded to the impact
parameter for which the trajectories would strike the nucleus. This
provided the first measure of the size of the atomic nucleus. At the
time, the distribution of the positive charge (the protons) was
considered to be just as spread out amongst the atomic volume as the
electrons. After Rutherford’s experiment, it was clear that the radius
of the nucleus tended to be roughly 4 orders of magnitude smaller than
that of the atom, which is less than the size of a football relative
to Spartan Stadium.</p>
<p>The incoming and outgoing angles of the trajectory are at
<span class="math notranslate nohighlight">\(\pm\theta'\)</span>. They are related to the scattering angle by
<span class="math notranslate nohighlight">\(2\theta'=\pi+\theta_s\)</span>.</p>
<p>In order to calculate differential cross section, we must find how the
impact parameter is related to the scattering angle. This requires
analysis of the trajectory. We consider our previous expression for
the trajectory where we derived the elliptic form for the trajectory,
Eq. (<a class="reference external" href="#eq:Ctrajectory">105</a>). For that case we considered an attractive
force with the particle’s energy being negative, i.e. it was
bound. However, the same form will work for positive energy, and
repulsive forces can be considered by simple flipping the sign of
<span class="math notranslate nohighlight">\(\alpha\)</span>. For positive energies, the trajectories will be hyperbolas,
rather than ellipses, with the asymptotes of the trajectories
representing the directions of the incoming and outgoing
tracks. Rewriting Eq. (<a class="reference external" href="#eq:Ctrajectory">105</a>),</p>
<!-- Equation labels as ordinary links -->
<div id="eq:ruthtraj"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}\label{eq:ruthtraj} \tag{111}
r=\frac{1}{\frac{m\alpha}{L^2}+A\cos\theta}.
\end{equation}
\]</div>
<p>Once <span class="math notranslate nohighlight">\(A\)</span> is large enough, which will happen when the energy is
positive, the denominator will become negative for a range of
<span class="math notranslate nohighlight">\(\theta\)</span>. This is because the scattered particle will never reach
certain angles. The asymptotic angles <span class="math notranslate nohighlight">\(\theta'\)</span> are those for which
the denominator goes to zero,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto82"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\cos\theta'=-\frac{m\alpha}{AL^2}.
\label{_auto82} \tag{112}
\end{equation}
\]</div>
<p>The trajectory’s point of closest approach is at <span class="math notranslate nohighlight">\(\theta=0\)</span> and the
two angles <span class="math notranslate nohighlight">\(\theta'\)</span>, which have this value of <span class="math notranslate nohighlight">\(\cos\theta'\)</span>, are the
angles of the incoming and outgoing particles. From
Fig (<strong>to come</strong>), one can see that the scattering angle
<span class="math notranslate nohighlight">\(\theta_s\)</span> is given by,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:sthetover2"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:sthetover2} \tag{113}
2\theta'-\pi&amp;=&amp;\theta_s,~~~\theta'=\frac{\pi}{2}+\frac{\theta_s}{2},\\
\nonumber
\sin(\theta_s/2)&amp;=&amp;-\cos\theta'\\
\nonumber
&amp;=&amp;\frac{m\alpha}{AL^2}.
\end{eqnarray}
\end{split}\]</div>
<p>Now that we have <span class="math notranslate nohighlight">\(\theta_s\)</span> in terms of <span class="math notranslate nohighlight">\(m,\alpha,L\)</span> and <span class="math notranslate nohighlight">\(A\)</span>, we wish
to re-express <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(A\)</span> in terms of the impact parameter <span class="math notranslate nohighlight">\(b\)</span> and the
energy <span class="math notranslate nohighlight">\(E\)</span>. This will set us up to calculate the differential cross
section, which requires knowing <span class="math notranslate nohighlight">\(db/d\theta_s\)</span>. It is easy to write
the angular momentum as</p>
<!-- Equation labels as ordinary links -->
<div id="_auto83"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
L^2=p_0^2b^2=2mEb^2.
\label{_auto83} \tag{114}
\end{equation}
\]</div>
<p>Finding <span class="math notranslate nohighlight">\(A\)</span> is more complicated. To accomplish this we realize that
the point of closest approach occurs at <span class="math notranslate nohighlight">\(\theta=0\)</span>, so from
Eq. (<a class="reference external" href="#eq:ruthtraj">111</a>)</p>
<!-- Equation labels as ordinary links -->
<div id="eq:rminofA"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:rminofA} \tag{115}
\frac{1}{r_{\rm min}}&amp;=&amp;\frac{m\alpha}{L^2}+A,\\
\nonumber
A&amp;=&amp;\frac{1}{r_{\rm min}}-\frac{m\alpha}{L^2}.
\end{eqnarray}
\end{split}\]</div>
<p>Next, <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> can be found in terms of the energy because at the
point of closest approach the kinetic energy is due purely to the
motion perpendicular to <span class="math notranslate nohighlight">\(\hat{r}\)</span> and</p>
<!-- Equation labels as ordinary links -->
<div id="_auto84"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
E=-\frac{\alpha}{r_{\rm min}}+\frac{L^2}{2mr_{\rm min}^2}.
\label{_auto84} \tag{116}
\end{equation}
\]</div>
<p>One can solve the quadratic equation for <span class="math notranslate nohighlight">\(1/r_{\rm min}\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto85"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{1}{r_{\rm min}}=\frac{m\alpha}{L^2}+\sqrt{(m\alpha/L^2)^2+2mE/L^2}.
\label{_auto85} \tag{117}
\end{equation}
\]</div>
<p>We can plug the expression for <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> into the expression for <span class="math notranslate nohighlight">\(A\)</span>, Eq. (<a class="reference external" href="#eq:rminofA">115</a>),</p>
<!-- Equation labels as ordinary links -->
<div id="_auto86"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
A=\sqrt{(m\alpha/L^2)^2+2mE/L^2}=\sqrt{(\alpha^2/(4E^2b^4)+1/b^2}
\label{_auto86} \tag{118}
\end{equation}
\]</div>
<p>Finally, we insert the expression for <span class="math notranslate nohighlight">\(A\)</span> into that for the scattering angle, Eq. (<a class="reference external" href="#eq:sthetover2">113</a>),</p>
<!-- Equation labels as ordinary links -->
<div id="eq:scattangle"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:scattangle} \tag{119}
\sin(\theta_s/2)&amp;=&amp;\frac{m\alpha}{AL^2}\\
\nonumber
&amp;=&amp;\frac{a}{\sqrt{a^2+b^2}}, ~~a\equiv \frac{\alpha}{2E}
\end{eqnarray}
\end{split}\]</div>
<p>The differential cross section can now be found by differentiating the
expression for <span class="math notranslate nohighlight">\(\theta_s\)</span> with <span class="math notranslate nohighlight">\(b\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:rutherford"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:rutherford} \tag{120}
\frac{1}{2}\cos(\theta_s/2)d\theta_s&amp;=&amp;\frac{ab~db}{(a^2+b^2)^{3/2}}=\frac{bdb}{a^2}\sin^3(\theta_s/2),\\
\nonumber
d\sigma&amp;=&amp;2\pi bdb=\frac{\pi a^2}{\sin^3(\theta_s/2)}\cos(\theta_s/2)d\theta_s\\
\nonumber
&amp;=&amp;\frac{\pi a^2}{2\sin^4(\theta_s/2)}\sin\theta_s d\theta_s\\
\nonumber
\frac{d\sigma}{d\cos\theta_s}&amp;=&amp;\frac{\pi a^2}{2\sin^4(\theta_s/2)},\\
\nonumber
\frac{d\sigma}{d\Omega}&amp;=&amp;\frac{a^2}{4\sin^4(\theta_s/2)}.
\end{eqnarray}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(a= \alpha/2E\)</span>. This the Rutherford formula for the differential
cross section. It diverges as <span class="math notranslate nohighlight">\(\theta_s\rightarrow 0\)</span> because
scatterings with arbitrarily large impact parameters still scatter to
arbitrarily small scattering angles. The expression for
<span class="math notranslate nohighlight">\(d\sigma/d\Omega\)</span> is the same whether the interaction is positive or
negative.</p>
<p>Consider a particle of mass <span class="math notranslate nohighlight">\(m\)</span> and charge <span class="math notranslate nohighlight">\(z\)</span> with kinetic energy <span class="math notranslate nohighlight">\(E\)</span>
(Let it be the center-of-mass energy) incident on a heavy nucleus of
mass <span class="math notranslate nohighlight">\(M\)</span> and charge <span class="math notranslate nohighlight">\(Z\)</span> and radius <span class="math notranslate nohighlight">\(R\)</span>. Find the angle at which the
Rutherford scattering formula breaks down.</p>
<div class="section" id="id4">
<h3>Solution<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Let <span class="math notranslate nohighlight">\(\alpha=Zze^2/(4\pi\epsilon_0)\)</span>. The scattering angle in Eq. (<a class="reference external" href="#eq:scattangle">119</a>) is</p>
<div class="math notranslate nohighlight">
\[
\sin(\theta_s/2)=\frac{a}{\sqrt{a^2+b^2}}, ~~a\equiv \frac{\alpha}{2E}.
\]</div>
<p>The impact parameter <span class="math notranslate nohighlight">\(b\)</span> for which the point of closest approach
equals <span class="math notranslate nohighlight">\(R\)</span> can be found by using angular momentum conservation,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
p_0b&amp;=&amp;b\sqrt{2mE}=Rp_f=R\sqrt{2m(E-\alpha/R)},\\
b&amp;=&amp;R\frac{\sqrt{2m(E-\alpha/R)}}{\sqrt{2mE}}\\
&amp;=&amp;R\sqrt{1-\frac{\alpha}{ER}}.
\end{eqnarray*}
\end{split}\]</div>
<p>Putting these together</p>
<div class="math notranslate nohighlight">
\[
\theta_s=2\sin^{-1}\left\{
\frac{a}{\sqrt{a^2+R^2(1-\alpha/(RE))}}
\right\},~~~a=\frac{\alpha}{2E}.
\]</div>
<p>It was from this departure of the experimentally measured
<span class="math notranslate nohighlight">\(d\sigma/d\Omega\)</span> from the Rutherford formula that allowed Rutherford
to infer the radius of the gold nucleus, <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>Just like electrodynamics, one can define “fields”, which for a small
additional mass <span class="math notranslate nohighlight">\(m\)</span> are the force per mass and the additional
potential energy per mass. The {\it gravitational field} related to
the force has dimensions of force per mass, or acceleration, and can
be labeled <span class="math notranslate nohighlight">\(\boldsymbol{g}(\boldsymbol{r})\)</span>. The potential energy per mass has
dimensions of energy per mass. This is analogous to the
electromagnetic potential, which is the potential energy per charge,
and the electric field which is the force per charge.</p>
<p>Because the field <span class="math notranslate nohighlight">\(\boldsymbol{g}\)</span> obeys the same inverse square law for a
point mass as the electric field does for a point charge, the
gravitational field also satisfies a version of Gauss’s law,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:GravGauss"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:GravGauss} \tag{121}
\oint d\boldsymbol{A}\cdot\boldsymbol{g}=-4\pi GM_{\rm inside}.
\end{equation}
\]</div>
<p>Here, <span class="math notranslate nohighlight">\(M_{\rm inside}\)</span> is the net mass inside a closed area.</p>
<p>Gauss’s law can be understood by considering a nozzle that sprays
paint in all directions uniformly from a point source. Let <span class="math notranslate nohighlight">\(B\)</span> be the
number of gallons per minute of paint leaving the nozzle. If the
nozzle is at the center of a sphere of radius <span class="math notranslate nohighlight">\(r\)</span>, the paint per
square meter per minute that is deposited on some part of the sphere
is</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
F(r)&amp;=&amp;\frac{B}{4\pi r^2}.
\end{eqnarray}
\]</div>
<p>Now, let <span class="math notranslate nohighlight">\(F\)</span> also be assigned a direction, so that it becomes a vector
pointing along the direction of the flying paint. For any surface that
surrounds the nozzle, not necessarily a sphere, one can state that</p>
<!-- Equation labels as ordinary links -->
<div id="eq:paint"></div>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\label{eq:paint} \tag{122}
\oint \boldsymbol{dA}\cdot\boldsymbol{F}&amp;=&amp;B,
\end{eqnarray}
\]</div>
<p>regardless of the shape of the surface. This follows because the rate
at which paint is deposited on the surface should equal the rate at
which it leaves the nozzle. The dot product ensures that only the
component of <span class="math notranslate nohighlight">\(\boldsymbol{F}\)</span> into the surface contributes to the deposition
of paint. Similarly, if <span class="math notranslate nohighlight">\(\boldsymbol{F}\)</span> is any radial inverse-square forces,
that falls as <span class="math notranslate nohighlight">\(B/(4\pi r^2)\)</span>, then one can apply
Eq. (<a class="reference external" href="#eq:paint">122</a>). For gravitational fields, <span class="math notranslate nohighlight">\(B/(4\pi)\)</span> is replaced
by <span class="math notranslate nohighlight">\(GM\)</span>, and one quickly “derives” Gauss’s law for gravity,
Eq. (<a class="reference external" href="#eq:GravGauss">121</a>).</p>
<p>Consider Earth to have its mass <span class="math notranslate nohighlight">\(M\)</span> uniformly distributed in a sphere
of radius <span class="math notranslate nohighlight">\(R\)</span>. Find the magnitude of the gravitational acceleration as
a function of the radius <span class="math notranslate nohighlight">\(r\)</span> in terms of the acceleration of gravity
at the surface <span class="math notranslate nohighlight">\(g(R)\)</span>. Assume <span class="math notranslate nohighlight">\(r&lt;R\)</span>, i.e. you are inside the surface.</p>
<p>{\bf Solution}: Take the ratio of Eq. (<a class="reference external" href="#eq:GravGauss">121</a>) for two radii, <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(r&lt;R\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\frac{4\pi r^2 g(r)}{4\pi R^2 g(R)}&amp;=&amp;\frac{4\pi GM_{\rm inside~r}}{4\pi GM_{\rm inside~R}}\\
\nonumber
&amp;=&amp;\frac{r^3}{R^3}\\
\nonumber
g(r)&amp;=&amp;g(R)\frac{r}{R}~.
\end{eqnarray*}
\end{split}\]</div>
<p>The potential energy per mass is similar conceptually to the voltage, or electric potential energy per charge, that was studied in electromagnetism, if <span class="math notranslate nohighlight">\(V\equiv U/m\)</span>, <span class="math notranslate nohighlight">\(\boldsymbol{g}=-\nabla V\)</span>.</p>
</div>
</div>
<div class="section" id="tidal-forces">
<h2>Tidal Forces<a class="headerlink" href="#tidal-forces" title="Permalink to this headline">¶</a></h2>
<p>Consider a spherical planet of radius <span class="math notranslate nohighlight">\(r\)</span> a distance <span class="math notranslate nohighlight">\(D\)</span> from another
body of mass <span class="math notranslate nohighlight">\(M\)</span>. The magnitude of the force due to <span class="math notranslate nohighlight">\(M\)</span> on an small
object of mass <span class="math notranslate nohighlight">\(\delta m\)</span> on surface of the planet can be calculated
by performing a Taylor expansion about the center of the spherical
planet.</p>
<!-- Equation labels as ordinary links -->
<div id="_auto87"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
F=-\frac{GM\delta m}{D^2}+2\frac{GM\delta m}{D^3}\Delta D+\cdots
\label{_auto87} \tag{123}
\end{equation}
\]</div>
<p>If the <span class="math notranslate nohighlight">\(z\)</span> direction points toward the large object, <span class="math notranslate nohighlight">\(\Delta D\)</span> can be
referred to as <span class="math notranslate nohighlight">\(z\)</span>. In the accelerating frame of an observer at the
center of the planet,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto88"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\delta m\frac{d^2 z}{dt^2}=F-\delta ma'+{\rm other~forces~acting~on~} \delta m,
\label{_auto88} \tag{124}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(a'\)</span> is the acceleration of the observer. Because <span class="math notranslate nohighlight">\(\delta ma'\)</span>
equals the gravitational force on <span class="math notranslate nohighlight">\(\delta m\)</span> if it were located at the
planet’s center, one can write</p>
<!-- Equation labels as ordinary links -->
<div id="_auto89"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
m\frac{d^2z}{dt^2}=2\frac{GM\delta m}{D^3}z+{\rm other~forces~acting~on~}\delta m.
\label{_auto89} \tag{125}
\end{equation}
\]</div>
<p>Here the other forces could represent the forces acting on <span class="math notranslate nohighlight">\(\delta m\)</span>
from the spherical planet such as the gravitational force or the
contact force with the surface. If <span class="math notranslate nohighlight">\(\theta\)</span> is the angle w.r.t. the
<span class="math notranslate nohighlight">\(z\)</span> axis, the effective force acting on <span class="math notranslate nohighlight">\(\delta m\)</span> is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto90"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
F_{\rm eff}\approx 2\frac{GM\delta m}{D^3}r\cos\theta\hat{z}+{\rm other~forces~acting~on~}\delta m.
\label{_auto90} \tag{126}
\end{equation}
\]</div>
<p>This first force is the “tidal” force. It pulls objects outward from the center of the object. If the object were covered with water, it would distort the objects shape so that the shape would be elliptical, stretched out along the axis pointing toward the large mass <span class="math notranslate nohighlight">\(M\)</span>. The force is always along (either parallel or antiparallel to) the <span class="math notranslate nohighlight">\(\hat{z}\)</span> direction.</p>
<p>Consider the Earth to be a sphere of radius <span class="math notranslate nohighlight">\(R\)</span> covered with water,
with the gravitational acceleration at the surface noted by <span class="math notranslate nohighlight">\(g\)</span>. Now
assume that a distant body provides an additional constant
gravitational acceleration <span class="math notranslate nohighlight">\(\boldsymbol{a}\)</span> pointed along the <span class="math notranslate nohighlight">\(z\)</span> axis. Find
the distortion of the radius as a function of <span class="math notranslate nohighlight">\(\theta\)</span>. Ignore
planetary rotation and assume <span class="math notranslate nohighlight">\(a&lt;&lt;g\)</span>.</p>
<p>{\bf Solution}: Because Earth would then accelerate with <span class="math notranslate nohighlight">\(a\)</span>, the
field <span class="math notranslate nohighlight">\(a\)</span> would seem invisible in the accelerating frame. A tidal
force would only appear if <span class="math notranslate nohighlight">\(a\)</span> depended on position, i.e. <span class="math notranslate nohighlight">\(\nabla
\boldsymbol{a}\ne 0\)</span>.</p>
<p>Now consider that the field is no longer constant, but that instead <span class="math notranslate nohighlight">\(a=-kz\)</span> with <span class="math notranslate nohighlight">\(|kR|&lt;&lt;g\)</span>.</p>
<p>{\bf Solution}: The surface of the planet needs to be at constant
potential (if the planet is not accelerating). The force per mass,
<span class="math notranslate nohighlight">\(-kz\)</span> is like a spring, and the potential per mass is
<span class="math notranslate nohighlight">\(kz^2/2\)</span>. Otherwise water would move to a point of lower
potential. Thus, the potential energy for a sample mass <span class="math notranslate nohighlight">\(\delta m\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
V(R)+\delta m gh(\theta)-\frac{\delta m}{2}kr^2\cos^2\theta={\rm Constant}\\
V(R)+\delta mgh(\theta)-\frac{\delta m}{2}kR^2\cos^2\theta-\delta m kRh(\theta)\cos^2\theta-\frac{\delta m}{2}kh^2(\theta)\cos^2\theta={\rm Constant}.
\end{eqnarray*}
\end{split}\]</div>
<p>Here, the potential due to the external field is <span class="math notranslate nohighlight">\((1/2)kz^2\)</span> so that <span class="math notranslate nohighlight">\(-\nabla U=-kz\)</span>. One now needs to solve for <span class="math notranslate nohighlight">\(h(\theta)\)</span>. Absorbing all the constant terms from both sides of the equation into one constant <span class="math notranslate nohighlight">\(C\)</span>, and because both <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(kR\)</span> are small, we can through away terms of order <span class="math notranslate nohighlight">\(h^2\)</span> or <span class="math notranslate nohighlight">\(kRh\)</span>. This gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
gh(\theta)-\frac{1}{2}kR^2\cos^2\theta&amp;=&amp;C,\\
h(\theta)&amp;=&amp;\frac{C}{g}+\frac{1}{2g}kR^2\cos^2\theta,\\
h(\theta)&amp;=&amp;\frac{1}{2g}kR^2(\cos^2\theta-1/3).
\end{eqnarray*}
\end{split}\]</div>
<p>The term with the factor of <span class="math notranslate nohighlight">\(1/3\)</span> replaced the constant and was chosen so that the average height of the water would be zero.</p>
<p>The Sun’s mass is <span class="math notranslate nohighlight">\(27\times 10^6\)</span> the Moon’s mass, but the Sun is 390 times further away from Earth as the Sun. What is ratio of the tidal force of the Sun to that of the Moon.</p>
<p>{\bf Solution}: The gravitational force due to an object <span class="math notranslate nohighlight">\(M\)</span> a distance <span class="math notranslate nohighlight">\(D\)</span> away goes as <span class="math notranslate nohighlight">\(M/D^2\)</span>, but the tidal force is only the difference of that force over a distance <span class="math notranslate nohighlight">\(R\)</span>,</p>
<div class="math notranslate nohighlight">
\[
F_{\rm tidal}\propto \frac{M}{D^3}R.
\]</div>
<p>Therefore the ratio of force is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\frac{F_{\rm Sun's~tidal~force}}{F_{\rm Moon's~tidal~force}}
&amp;=&amp;\frac{M_{\rm sun}/D_{\rm sun}^3}{M_{\rm moon}/D_{\rm moon}^3}\\
&amp;=&amp;\frac{27\times 10^6}{390^3}=0.46.
\end{eqnarray*}
\end{split}\]</div>
<p>The Moon more strongly affects tides than the Sun.</p>
</div>
</div>
<div class="section" id="variational-calculus-and-lagrangian-formalism">
<h1>Variational Calculus and Lagrangian Formalism<a class="headerlink" href="#variational-calculus-and-lagrangian-formalism" title="Permalink to this headline">¶</a></h1>
<p>The calculus of variations involves
problems where the quantity to be minimized or maximized is an integral.</p>
<p>The usual minimization problem one faces involves taking a function
<span class="math notranslate nohighlight">\({\cal L}(x)\)</span>, then finding the single value <span class="math notranslate nohighlight">\(x\)</span> for which <span class="math notranslate nohighlight">\({\cal L}\)</span>
is either a maximum or minimum. In multivariate calculus one also
learns to solve problems where you minimize for multiple variables,
<span class="math notranslate nohighlight">\({\cal L}(x_1,x_2,\cdots x_n)\)</span>, and finding the points <span class="math notranslate nohighlight">\((x_1\cdots
y_n)\)</span> in an <span class="math notranslate nohighlight">\(n\)</span>-dimensional space that maximize or minimize the
function. Here, we consider what seems to be a much more ambitious
problem. Imagine you have a function <span class="math notranslate nohighlight">\({\cal L}(x(t),\dot{x}(t),t)\)</span>,
and you wish to find the extrema for an infinite number of values of
<span class="math notranslate nohighlight">\(x\)</span>, i.e. <span class="math notranslate nohighlight">\(x\)</span> at each point <span class="math notranslate nohighlight">\(t\)</span>. The function <span class="math notranslate nohighlight">\({\cal L}\)</span> will not only
depend on <span class="math notranslate nohighlight">\(x\)</span> at each point <span class="math notranslate nohighlight">\(t\)</span>, but also on the slope at each point,
plus an additional dependence on <span class="math notranslate nohighlight">\(t\)</span>. Note we are NOT finding an
optimum value of <span class="math notranslate nohighlight">\(t\)</span>, we are finding the set of optimum values of <span class="math notranslate nohighlight">\(x\)</span>
at each point <span class="math notranslate nohighlight">\(t\)</span>, or equivalently, finding the function <span class="math notranslate nohighlight">\(x(t)\)</span>.</p>
<p>One treats the function <span class="math notranslate nohighlight">\(x(t)\)</span> as being unknown while minimizing the action</p>
<div class="math notranslate nohighlight">
\[
S=\int_{t_1}^{t_2}dt~{\cal L}(x(t),\dot{x}(t),t).
\]</div>
<p>Thus, we are minimizing <span class="math notranslate nohighlight">\(S\)</span> with respect to an infinite number of
values of <span class="math notranslate nohighlight">\(x(t_i)\)</span> at points <span class="math notranslate nohighlight">\(t_i\)</span>. As an additional criteria, we will
assume that <span class="math notranslate nohighlight">\(x(t_1)\)</span> and <span class="math notranslate nohighlight">\(x(t_2)\)</span> are fixed, and that that we will
only consider variations of <span class="math notranslate nohighlight">\(x\)</span> between the boundaries. The dependence
on the derivative, <span class="math notranslate nohighlight">\(\dot{x}=dx/dt\)</span>, is crucial because otherwise the
solution would involve simply finding the one value of <span class="math notranslate nohighlight">\(x\)</span> that
minimized <span class="math notranslate nohighlight">\({\cal L}\)</span>, and <span class="math notranslate nohighlight">\(x(t)\)</span> would equal a constant if there were no
explicit <span class="math notranslate nohighlight">\(t\)</span> dependence. Furthermore, <span class="math notranslate nohighlight">\(x\)</span> wouldn’t need to be
continuous at the boundary.</p>
<p>In the general case we have an integral of the type</p>
<div class="math notranslate nohighlight">
\[
S[q]= \int_{t_1}^{t_2} {\cal L}(q(t),\dot{q}(t),t)dt,
\]</div>
<p>where <span class="math notranslate nohighlight">\(S\)</span> is the quantity which is sought minimized or maximized.  The
problem is that although <span class="math notranslate nohighlight">\({\cal L}\)</span>  is a function of the general variables
<span class="math notranslate nohighlight">\(q(t),\dot{q}(t),t\)</span> (note our change of variables), the exact dependence of <span class="math notranslate nohighlight">\(q\)</span> on <span class="math notranslate nohighlight">\(t\)</span> is not known.
This means again that even though the integral has fixed limits <span class="math notranslate nohighlight">\(t_1\)</span>
and <span class="math notranslate nohighlight">\(t_2\)</span>, the path of integration is not known. In our case the unknown
quantities are the positions and general velocities of a given number
of objects and we wish to choose an integration path which makes the
functional <span class="math notranslate nohighlight">\(S[q]\)</span> stationary. This means that we want to find minima,
or maxima or saddle points. In physics we search normally for minima.
Our task is therefore to find the minimum of <span class="math notranslate nohighlight">\(S[q]\)</span> so that its
variation <span class="math notranslate nohighlight">\(\delta S\)</span> is zero subject to specific constraints.  The
constraints can be treated via the technique of Lagrangian multipliers
as we will see below.</p>
<p>We assume the existence of an optimum path, that is a path for which
<span class="math notranslate nohighlight">\(S[q]\)</span> is stationary. There are infinitely many such paths.  The
difference between two paths <span class="math notranslate nohighlight">\(\delta q\)</span> is called the variation of
<span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>We call the variation <span class="math notranslate nohighlight">\(\eta(t)\)</span> and it is scaled by a factor <span class="math notranslate nohighlight">\(\alpha\)</span>.
The function <span class="math notranslate nohighlight">\(\eta(t)\)</span> is arbitrary except for</p>
<div class="math notranslate nohighlight">
\[
\eta(t_1)=\eta(t_2)=0,
\]</div>
<p>and we assume that we can model the change in <span class="math notranslate nohighlight">\(q\)</span> as</p>
<div class="math notranslate nohighlight">
\[
q(t,\alpha) = q(t)+\alpha\eta(t),
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\delta q = q(t,\alpha) -q(t,0)=\alpha\eta(t).
\]</div>
<p>We choose <span class="math notranslate nohighlight">\(q(t,\alpha=0)\)</span> as the unkonwn path  that will minimize <span class="math notranslate nohighlight">\(S\)</span>.  The value
<span class="math notranslate nohighlight">\(q(t,\alpha\ne 0)\)</span>  describes a neighbouring path.</p>
<p>We have</p>
<div class="math notranslate nohighlight">
\[
S[q(\alpha)]= \int_{t_1}^{t_2} {\cal L}(q(t,\alpha),\dot{q}(t,\alpha),t)dt.
\]</div>
<p>The condition for an extreme of</p>
<div class="math notranslate nohighlight">
\[
S[q(\alpha)]= \int_{t_1}^{t_2} {\cal L}(q(t,\alpha),\dot{q}(t,\alpha),t)dt,
\]</div>
<p>is</p>
<div class="math notranslate nohighlight">
\[
\left[\frac{\partial  S[q(\alpha)]}{\partial t}\right]_{\alpha=0} =0.
\]</div>
<p>The <span class="math notranslate nohighlight">\(\alpha\)</span> dependence is contained in <span class="math notranslate nohighlight">\(q(t,\alpha)\)</span> and <span class="math notranslate nohighlight">\(\dot{q}(t,\alpha)\)</span> meaning that</p>
<div class="math notranslate nohighlight">
\[
\left[\frac{\partial  E[q(\alpha)]}{\partial \alpha}\right]=\int_{t_1}^{t_2} \left( \frac{\partial {\cal l}}{\partial q}\frac{\partial q}{\partial \alpha}+\frac{\partial {\cal L}}{\partial \dot{q}}\frac{\partial \dot{q}}{\partial \alpha}\right)dt.
\]</div>
<p>We have defined</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial q(x,\alpha)}{\partial \alpha}=\eta(x)
\]</div>
<p>and thereby</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \dot{q}(t,\alpha)}{\partial \alpha}=\frac{d(\eta(t))}{dt}.
\]</div>
<p>Using</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial q(t,\alpha)}{\partial \alpha}=\eta(t),
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \dot{q}(t,\alpha)}{\partial \alpha}=\frac{d(\eta(t))}{dt},
\]</div>
<p>in the integral gives</p>
<div class="math notranslate nohighlight">
\[
\left[\frac{\partial  S[q(\alpha)]}{\partial \alpha}\right]=\int_{t_1}^{t_2} \left( \frac{\partial {\cal L}}{\partial q}\eta(t)+\frac{\partial {\cal L}}{\partial \dot{q}}\frac{d(\eta(t))}{dt}\right)dt.
\]</div>
<p>Integrating the second term by parts</p>
<div class="math notranslate nohighlight">
\[
\int_{t_1}^{t_2} \frac{\partial {\cal L}}{\partial \dot{q}}\frac{d(\eta(t))}{dt}dt =\eta(t)\frac{\partial {\cal L}}{\partial \dot{q}}|_{t_1}^{t_2}-
\int_a^b \eta(t)\frac{d}{dx}\frac{\partial {\cal L}}{\partial \dot{q}}dt,
\]</div>
<p>and since the first term dissappears due to <span class="math notranslate nohighlight">\(\eta(a)=\eta(b)=0\)</span>, we obtain</p>
<div class="math notranslate nohighlight">
\[
\left[\frac{\partial  S[q(\alpha)]}{\partial \alpha}\right]=\int_{t_1}^{t_2} \left( \frac{\partial {\cal L}}{\partial q}-\frac{d}{dx}\frac{\partial {\cal L}}{\partial \dot{q}}
\right)\eta(t)dt=0,
\]</div>
<p>which can also be written as</p>
<div class="math notranslate nohighlight">
\[
\left[\frac{\partial  S[q(\alpha)]}{\partial \alpha}\right]_{\alpha=0}=\int_{t_1}^{t_2} \left( \frac{\partial {\cal L}}{\partial q}-\frac{d}{\
dx}\frac{\partial {\cal L}}{\partial \dot{q}}\right)\delta q(t)dt=\delta S = 0.
\]</div>
<p>The condition for a stationary value is thus a partial differential equation</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial {\cal L}}{\partial q}-\frac{d}{dx}\frac{\partial {\cal L}}{\partial \dot{q}}=0,
\]</div>
<p>known as the <strong>Euler-Lagrange</strong> equation.</p>
<div class="section" id="constrained-motion">
<h2>Constrained motion<a class="headerlink" href="#constrained-motion" title="Permalink to this headline">¶</a></h2>
<p>Sometimes an auxiliary constraint is added to the problem (beyond
fixing the end poits <span class="math notranslate nohighlight">\(y_1\)</span> and <span class="math notranslate nohighlight">\(y_2\)</span>). Just ahead, we will work on the
example of a hanging chain. The shape of the curve minimizes the
potential energy, under the constraint of a fixed length of
chain. Before presenting such an example we first review the method of
Lagrange multipliers as a method for finding minima or maxima under
constraints.</p>
<p>Imagine a function <span class="math notranslate nohighlight">\(f(x_1,x_2\cdots x_n)\)</span> for which you wish to find
the minima. Additionally, you are given a constraint</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
C(x_1\cdots x_n)=0
\end{eqnarray}
\]</div>
<p>The usual condition for a a minimum is</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\frac{\partial f}{\partial x_i}=0{\rm ,~~or~}\nabla f=0.
\end{eqnarray}
\]</div>
<p>which would be <span class="math notranslate nohighlight">\(n\)</span> equations for the <span class="math notranslate nohighlight">\(n\)</span> variables. The gradient of a
scalar is a vector, so you should think of <span class="math notranslate nohighlight">\(\nabla\)</span> as
<span class="math notranslate nohighlight">\(\boldsymbol{\nabla}\)</span>. However, the solution will likely not satisfy the
constraint, i.e. the point at which <span class="math notranslate nohighlight">\(f(x_1\cdots x_n)\)</span> has an extrema,
may not be a point where <span class="math notranslate nohighlight">\(C(x_1\cdots x_n)=0\)</span>.</p>
<p>A necessary condition for the solution is that</p>
<!-- Equation labels as ordinary links -->
<div id="_auto91"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\nabla f\cdot\boldsymbol{\epsilon}=0,
\label{_auto91} \tag{127}
\end{equation}
\]</div>
<p>for any infinitesimal vector <span class="math notranslate nohighlight">\(\boldsymbol{\epsilon}\)</span> if <span class="math notranslate nohighlight">\(\boldsymbol{\epsilon}\)</span>
satisfies the condition</p>
<!-- Equation labels as ordinary links -->
<div id="_auto92"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\delta C=\nabla C\cdot\boldsymbol{\epsilon}=0.
\label{_auto92} \tag{128}
\end{equation}
\]</div>
<p>That is to say if I take a small step in a direction that doesn’t
change the constraint, then <span class="math notranslate nohighlight">\(f\)</span> must not change if it is an
extrema. Not changing the constraint implies the step is orthogonal to
<span class="math notranslate nohighlight">\(\nabla C\)</span>. As there are <span class="math notranslate nohighlight">\(n\)</span> dimensions of <span class="math notranslate nohighlight">\(x\)</span>, the vector <span class="math notranslate nohighlight">\(\nabla C\)</span>
defines one direction, and <span class="math notranslate nohighlight">\(\boldsymbol{\epsilon}\)</span> can be in any of the <span class="math notranslate nohighlight">\(n-1\)</span>
directions orthogonal to <span class="math notranslate nohighlight">\(\nabla C\)</span>. If <span class="math notranslate nohighlight">\(\nabla f\cdot\boldsymbol{\epsilon}=0\)</span>
for ANY of the <span class="math notranslate nohighlight">\(n-1\)</span> directions of <span class="math notranslate nohighlight">\(\boldsymbol{\epsilon}\)</span> orthogonal to
<span class="math notranslate nohighlight">\(\nabla C\)</span>, then</p>
<!-- Equation labels as ordinary links -->
<div id="_auto93"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\nabla f ~||~ \nabla C.
\label{_auto93} \tag{129}
\end{equation}
\]</div>
<p>Because the two vectors are parallel you can say there must exist some
constant <span class="math notranslate nohighlight">\(\lambda\)</span> such that</p>
<!-- Equation labels as ordinary links -->
<div id="_auto94"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\nabla(f-\lambda C)=0.
\label{_auto94} \tag{130}
\end{equation}
\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\lambda\)</span> is known as a Lagrange multiplier. Satisfying
this equation  is a necessary, but not a sufficient
condition. One could add a constant to the constraint and the gradient
would not change. One must find the correct value of <span class="math notranslate nohighlight">\(\lambda\)</span> that
satisfies the constraint <span class="math notranslate nohighlight">\(C=0\)</span>, rather than <span class="math notranslate nohighlight">\(C=\)</span> some other
constant. The strategy is then to solve
thw above equation  then adjust <span class="math notranslate nohighlight">\(\lambda\)</span> until one
finds the <span class="math notranslate nohighlight">\(x_1\cdots x_n\)</span> that gives <span class="math notranslate nohighlight">\(C(x_1\cdots x_n)=0\)</span>.</p>
<p>The method of Lagrange multipliers is counter-intuitive to one’s
intuition to use the constraint to reduce the dimensionality of the
problem. Normally, minimizing a function of <span class="math notranslate nohighlight">\(n\)</span> variables, leads to
<span class="math notranslate nohighlight">\(n\)</span> equations and <span class="math notranslate nohighlight">\(n\)</span> unknowns. A constraint could be used, by
substitution, to replace the <span class="math notranslate nohighlight">\(n\)</span> variables with <span class="math notranslate nohighlight">\(n-1\)</span>
variables. Instead, we add an unknown parameter, <span class="math notranslate nohighlight">\(\lambda\)</span>, and change
the equation to <span class="math notranslate nohighlight">\(n+1\)</span> equations with <span class="math notranslate nohighlight">\(n+1\)</span> unknowns, with the extra
unknown being the Lagrange multiplier <span class="math notranslate nohighlight">\(\lambda\)</span>. Often, it is rather
easy to solve for <span class="math notranslate nohighlight">\(x_1\cdots x_n\)</span>. Then one is left with the usually
difficult problem of finding <span class="math notranslate nohighlight">\(\lambda\)</span>, often requiring the solution
of a transcendental equation.</p>
<p>Let us try to formalize this. We consider a function of three independent variables <span class="math notranslate nohighlight">\(f(x,y,z)\)</span> . For
the function <span class="math notranslate nohighlight">\(f\)</span> to be an extreme we have</p>
<div class="math notranslate nohighlight">
\[
df=0.
\]</div>
<p>A necessary and sufficient condition is</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial f}{\partial x} =\frac{\partial f}{\partial y}=\frac{\partial f}{\partial z}=0,
\]</div>
<p>due to</p>
<div class="math notranslate nohighlight">
\[
df = \frac{\partial f}{\partial x}dx+\frac{\partial f}{\partial y}dy+\frac{\partial f}{\partial z}dz.
\]</div>
<p>In physical problems the variables <span class="math notranslate nohighlight">\(x,y,z\)</span> are often subject to constraints (in our case <span class="math notranslate nohighlight">\(q\)</span> and the orthogonality constraint)
so that they are no longer all independent. It is possible at least in principle to use each constraint to eliminate one variable
and to proceed with a new and smaller set of independent varables.</p>
<p>The use of so-called Lagrangian  multipliers is an alternative technique  when the elimination of
of variables is incovenient or undesirable.  Assume that we have an equation of constraint on the variables <span class="math notranslate nohighlight">\(x,y,z\)</span></p>
<div class="math notranslate nohighlight">
\[
\phi(x,y,z) = 0,
\]</div>
<p>resulting in</p>
<div class="math notranslate nohighlight">
\[
d\phi = \frac{\partial \phi}{\partial x}dx+\frac{\partial \phi}{\partial y}dy+\frac{\partial \phi}{\partial z}dz =0.
\]</div>
<p>Now we cannot set anymore</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial f}{\partial x} =\frac{\partial f}{\partial y}=\frac{\partial f}{\partial z}=0,
\]</div>
<p>if <span class="math notranslate nohighlight">\(df=0\)</span> is wanted
because there are now only two independent variables!  Assume <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are the independent variables.
Then <span class="math notranslate nohighlight">\(dz\)</span> is no longer arbitrary.</p>
<p>However, we can add to</p>
<div class="math notranslate nohighlight">
\[
df = \frac{\partial f}{\partial x}dx+\frac{\partial f}{\partial y}dy+\frac{\partial f}{\partial z}dz,
\]</div>
<p>a multiplum of <span class="math notranslate nohighlight">\(d\phi\)</span>, viz. <span class="math notranslate nohighlight">\(\lambda d\phi\)</span>, resulting  in</p>
<div class="math notranslate nohighlight">
\[
df+\lambda d\phi = (\frac{\partial f}{\partial z}+\lambda\frac{\partial \phi}{\partial x})dx+(\frac{\partial f}{\partial y}+\lambda\frac{\partial \phi}{\partial y})dy+(\frac{\partial f}{\partial z}+\lambda\frac{\partial \phi}{\partial z})dz =0.
\]</div>
<p>Our multiplier is chosen so that</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial f}{\partial z}+\lambda\frac{\partial \phi}{\partial z} =0.
\]</div>
<p>However, we took <span class="math notranslate nohighlight">\(dx\)</span> and <span class="math notranslate nohighlight">\(dy\)</span> as to be arbitrary and thus we must have</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial f}{\partial x}+\lambda\frac{\partial \phi}{\partial x} =0,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial f}{\partial y}+\lambda\frac{\partial \phi}{\partial y} =0.
\]</div>
<p>When all these equations are satisfied, <span class="math notranslate nohighlight">\(df=0\)</span>.  We have four
unknowns, <span class="math notranslate nohighlight">\(x,y,z\)</span> and <span class="math notranslate nohighlight">\(\lambda\)</span>. Actually we want only <span class="math notranslate nohighlight">\(x,y,z\)</span>,
<span class="math notranslate nohighlight">\(\lambda\)</span> need not to be determined, it is therefore often called
Lagrange’s undetermined multiplier.  If we have a set of constraints
<span class="math notranslate nohighlight">\(\phi_k\)</span> we have the equations</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial f}{\partial x_i}+\sum_k\lambda_k\frac{\partial \phi_k}{\partial x_i} =0.
\]</div>
<div class="section" id="example-brachiostone">
<h3>Example: brachiostone<a class="headerlink" href="#example-brachiostone" title="Permalink to this headline">¶</a></h3>
<p>Consider a particle constrained to move along a path (like a bead
moving without friction on a wire) and you need to design a path from
<span class="math notranslate nohighlight">\(x=y=0\)</span> to some final point <span class="math notranslate nohighlight">\(x_f,y_f\)</span>. Assume there is a constant
force in the <span class="math notranslate nohighlight">\(x\)</span> direction, <span class="math notranslate nohighlight">\(F_x=mg\)</span>. Design the path so that the time
the bead travels is a minimum.</p>
<p>The net time is</p>
<div class="math notranslate nohighlight">
\[
T=\int \frac{d\ell}{v}=\int_0^{x_f} dx~\frac{\sqrt{1+y'^2}}{\sqrt{2gx}}={\rm minimum}.
\]</div>
<p>Here we made use of the fact that <span class="math notranslate nohighlight">\(d\ell=\sqrt{dx^2+dy^2}\)</span> and that
the velocity is determined by <span class="math notranslate nohighlight">\(KE=mv^2/2=mgx\)</span>. The Euler equations can
be applied if you first define the function as</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
f(y,y';x)&amp;=&amp;\frac{\sqrt{1+y'^2}}{\sqrt{x}}.
\end{eqnarray*}
\]</div>
<p>The equations are then</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
\frac{d}{dx}\frac{\partial f}{\partial y'}&amp;=&amp;0.
\end{eqnarray*}
\]</div>
<p>The simplification ensued from <span class="math notranslate nohighlight">\(f\)</span> not having any dependence on <span class="math notranslate nohighlight">\(y\)</span>. This yields the differential equation</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\frac{y'}{x^{1/2}(1+y'^2)^{1/2}}&amp;=&amp;(2a)^{-1/2},
\end{eqnarray}
\]</div>
<p>because <span class="math notranslate nohighlight">\(\partial f/\partial y'\)</span> must be a constant, which with some
foresight we label <span class="math notranslate nohighlight">\((2a)^{-1/2}\)</span>. One can now solve for <span class="math notranslate nohighlight">\(y'\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
(y')^2&amp;=&amp;2ax(1+y'^2)\\
\nonumber
y'&amp;=&amp;\sqrt{\frac{x}{2a-x}},\\
\nonumber
y(t)&amp;=&amp;\int_0^x dx'~\frac{\sqrt{x'}dx'}{\sqrt{2a-x'}}=\int_0^x dx'~\frac{x'dx'}{\sqrt{2ax'-x'^2}}\\
\nonumber
&amp;=&amp;\frac{1}{2}\int_0^x\frac{(2x'-2a)dx'}{(2ax'-x'^2)^{1/2}}+a\int_0^x\frac{dx'}{\sqrt{2ax'-x'^2}}\\
\nonumber
&amp;=&amp;\frac{-1}{2}\int_0^{2ax-x^2}\frac{du}{\sqrt{u}}+a\int_0^x\frac{dx'}{\sqrt{a^2-(x'-a)^2}}\\
&amp;=&amp;-\sqrt{2ax-x^2}+a\cos^{-1}(1-x/a).
\end{eqnarray*}
\end{split}\]</div>
<p>This turns out to be the equation for a {\it cycloid} or a {\it
brachiostone}. If you rolled a wheel of radius <span class="math notranslate nohighlight">\(a\)</span> down the <span class="math notranslate nohighlight">\(y\)</span> axis
and followed a point on the rim, it would trace out a cycloid. Here,
the constant <span class="math notranslate nohighlight">\(a\)</span> must be chosen to match the boundary condition,
<span class="math notranslate nohighlight">\(y_2=y(x_2)\)</span>. You can see the textbook for more details, plus you get
a chance to work with cycloids in the exercises at the end of this
chapter.</p>
</div>
<div class="section" id="maximizing-a-function">
<h3>Maximizing a Function<a class="headerlink" href="#maximizing-a-function" title="Permalink to this headline">¶</a></h3>
<p>As an example of using Lagrange multipliers for a standard
optimization formula we attempt to maximize the following function,</p>
<div class="math notranslate nohighlight">
\[
F(x_1\cdots x_n)=-\sum_{i=1}^n x_i\ln(x_i),
\]</div>
<p>with respect to the <span class="math notranslate nohighlight">\(n\)</span> variables <span class="math notranslate nohighlight">\(x_i\)</span>. With no constraints, each
<span class="math notranslate nohighlight">\(x_i\)</span> would maximize the function for</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\frac{d}{dx_j}~\left[-\sum_i x_i\ln(x_i)\right]&amp;=&amp;0\\
-\ln(x_j)-1&amp;=&amp;0,~~~~x_j=e^{-1}.
\end{eqnarray*}
\end{split}\]</div>
<p>Now, we repeat the problem but with two constraints,</p>
<div class="math notranslate nohighlight">
\[
\sum_ix_i=1~,~~~~\sum_ix_i\epsilon_i=E.
\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\epsilon_i\)</span> and <span class="math notranslate nohighlight">\(E\)</span> are fixed constants. We go forward by
finding the extrema for</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
G(x_1\cdots x_n)&amp;=&amp;F-\alpha\sum_i x_i-\beta\sum_i\epsilon_ix_i
=\sum_i \left\{-x_i\ln(x_i)-\alpha x_i-\beta\epsilon_ix_i\right\}.
\end{eqnarray*}
\]</div>
<p>There are two Lagrange multipliers, <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>,
corresponding to the two constraints. One then solves for the extrema</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\frac{d}{dx_j}G&amp;=&amp;0\\
&amp;=&amp;-\ln(x_j)-1-\alpha-\beta\epsilon_j,\\
x_j&amp;=&amp;\exp\left\{-1-\alpha-\beta\epsilon_j\right\}.
\end{eqnarray*}
\end{split}\]</div>
<p>For any given <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> this provides a solution for
constraining <span class="math notranslate nohighlight">\(\sum_i x_i\)</span> and <span class="math notranslate nohighlight">\(\sum_i\epsilon_ix_i\)</span> to some values,
just not the values of unity and <span class="math notranslate nohighlight">\(E\)</span> that you wish. One would then
have to search for the correct values by adjusting <span class="math notranslate nohighlight">\(\alpha\)</span> and
<span class="math notranslate nohighlight">\(\beta\)</span> until the constraint are actually matched by solving a
transcendental equation. Although this can be complicated, it is
certainly less expensive than searching over all <span class="math notranslate nohighlight">\(N\)</span> values of
<span class="math notranslate nohighlight">\(x_i\)</span>. This particular example corresponds to maximizing the entropy
for a system, <span class="math notranslate nohighlight">\(S=-\sum_i x_i\ln(x_i)\)</span>, where <span class="math notranslate nohighlight">\(x_i\)</span> is the probability
of the system being in a particular discrete level <span class="math notranslate nohighlight">\(i\)</span> that has energy
<span class="math notranslate nohighlight">\(\epsilon_i\)</span>. One wishes to maximize the entropy subject to the
constraints that the probabilities sum to unity and the average energy
has some given value. The result that <span class="math notranslate nohighlight">\(x_i\sim e^{-\beta\epsilon_i}\)</span>
demonstrates the origin of the Boltzmann factor, with the inverse
temperature <span class="math notranslate nohighlight">\(\beta=1/T\)</span>.</p>
<p>Lagrange multipliers also assist with the Euler-Lagrange equation. If
one breaks an interval <span class="math notranslate nohighlight">\(x_1&lt;x&lt;x_2\)</span> into a large number
<span class="math notranslate nohighlight">\(n\rightarrow\infty\)</span> points separated by <span class="math notranslate nohighlight">\(dx\)</span>, the Euler-Lagrange
equation involves finding the <span class="math notranslate nohighlight">\(n\)</span> values <span class="math notranslate nohighlight">\(y_i\)</span> at each point so that
<span class="math notranslate nohighlight">\(\sum_i dx f\left\{y_i,y'_i=(y_{i+1}-y_{i-1})/(2dx)\right\}\)</span> is
maximized for some given function <span class="math notranslate nohighlight">\(f\)</span>. If an additional auxiliary
constraint is added, also some function of the <span class="math notranslate nohighlight">\(n\)</span> values <span class="math notranslate nohighlight">\(y_i\)</span>, one
can use the method of Lagrange multipliers. In the constraint can also
be written as some function of <span class="math notranslate nohighlight">\(C(y_i,y'_i)\)</span>, then one simply adds a
term <span class="math notranslate nohighlight">\(\lambda C(y,y')\)</span> to the function <span class="math notranslate nohighlight">\(f\)</span> and uses the Euler-Lagrange
equation to find the extrema of.</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
J&amp;=&amp;\int_{x_1}^{x_2}dx~f\left\{y(t),y'(t),x\right\}-\lambda C\left\{y(t),y'(t),x\right\},
\end{eqnarray}
\]</div>
<p>the one difference being that</p>
<!-- Equation labels as ordinary links -->
<div id="_auto95"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
f\left\{y(t),y'(t),x\right\}\rightarrow f\left\{y(t),y'(t),x\right\}-\lambda C\left\{y(t),y'(t),x\right\}
\label{_auto95} \tag{131}
\end{equation}
\]</div>
</div>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>Consider a chain of length <span class="math notranslate nohighlight">\(L\)</span> and mass per unit length <span class="math notranslate nohighlight">\(\kappa\)</span> that
hangs from point <span class="math notranslate nohighlight">\(x=0,y=0\)</span> to point <span class="math notranslate nohighlight">\(x_f,y_f\)</span>. The shape must minimize
the potential energy. Find general expressions for the shape in terms
of three constants which must be chosen to match <span class="math notranslate nohighlight">\(y(0)=0, y(x_f)=y_f\)</span>
and the fixed length. Equivalently, one finds the function <span class="math notranslate nohighlight">\(y(t)\)</span> that
provides an extrema for the integral,</p>
<p>One must minimize</p>
<div class="math notranslate nohighlight">
\[
\int d\ell~\kappa gy-\lambda\int d\ell=
\int_0^{x_f} dx~\sqrt{1+y'^2}\kappa gy-\lambda \int_0^{x_f} dx\sqrt{1+y'^2}.
\]</div>
<p>Here <span class="math notranslate nohighlight">\(\lambda\)</span> is the Lagrange multiplier associated with constraining
the length of the chain. The constrained length <span class="math notranslate nohighlight">\(L\)</span> appears nowhere in
the expression. Instead, one solves for form of the answer, then
adjusts <span class="math notranslate nohighlight">\(\lambda\)</span> to give the correct length. For the purposes of the
Euler-Lagrange minimization one considers the function</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
f(y,y';x)&amp;=&amp;\kappa gy\sqrt{1+y'^2}-\lambda\sqrt{1+y'^2}.
\end{eqnarray}
\]</div>
<p>Because <span class="math notranslate nohighlight">\(\lambda\)</span> is an unknown constant and because minimizing a
function multiplied by a constant is the same as minimizing the
function, we can equivlently minimize the integral using the function</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\tilde{f}(y,y';x)&amp;=&amp;y\sqrt{1+y'^2}-\tilde{\lambda}\sqrt{1+y'^2},\\
\nonumber
\tilde{\lambda}&amp;\equiv&amp;\frac{\lambda}{\kappa g}.
\end{eqnarray}
\end{split}\]</div>
<p>The Euler-Lagrange equations then become</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
\frac{d}{dx}\left\{
\frac{y'}{\sqrt{1+y'^2}}y-\tilde{\lambda}\frac{y'}{\sqrt{1+y'^2}}
\right\}&amp;=&amp;\sqrt{1+y'^2}.
\end{eqnarray*}
\]</div>
<p>Here, we will guess at the form of the solution,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
y'&amp;=&amp;\sinh[(x-x_0)/a],~~y=a\cosh[(x-x_0)/a]+y_0.
\end{eqnarray*}
\]</div>
<p>Plugging into the Euler-Lagange equations,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\frac{d}{dx}\left\{(a\cosh[(x-x_0)/a]+y_0)\frac{\sinh[(x-x_0)/a]}{\cosh[(x-x_0)/a]}-\tilde{\lambda}\frac{\sinh[(x-x_0)/a]}{\cosh[(x-x_0)/a]}\right\}&amp;=&amp;\cosh[(x-x_0)/a],\\
\nonumber
\frac{d}{dx}\left\{(y_0-\tilde{\lambda})\tanh[(x-x_0)/a]\right\}=0.
\end{eqnarray*}
\end{split}\]</div>
<p>This solution works if <span class="math notranslate nohighlight">\(y_0=\tilde{\lambda}\)</span>. So the general form of
the solution is</p>
<div class="math notranslate nohighlight">
\[
y=\tilde{\lambda}+a\cosh[(x-x_0)/a].
\]</div>
<p>One must find <span class="math notranslate nohighlight">\(\tilde{\lambda}\)</span>, <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(a\)</span> to satisfy three
conditions, <span class="math notranslate nohighlight">\(y(x=0)=0\)</span>, <span class="math notranslate nohighlight">\(y(x=x_f)=y_f\)</span> and that the length is <span class="math notranslate nohighlight">\(L\)</span>. For
a hanging chain <span class="math notranslate nohighlight">\(a\)</span> is positive. A solution with negative <span class="math notranslate nohighlight">\(a\)</span> would
represent a maximum of the potential energy. A remarkable property of
the solution is that once you define the length and the end-point
positions <span class="math notranslate nohighlight">\(y_1\)</span> and <span class="math notranslate nohighlight">\(y_2\)</span>, the solution does not depend on <span class="math notranslate nohighlight">\(\kappa\)</span> or
<span class="math notranslate nohighlight">\(g\)</span>. Thus, the shape of the chain would be the same if you took it to
the moon. These solutions are known as <a class="reference external" href="http://en.wikipedia.org/wiki/Catenary%7D%7Bhttp://en.wikipedia.org/wiki/Catenary">catenaries</a>.</p>
</div>
</div>
<div class="section" id="lagrangians">
<h2>Lagrangians<a class="headerlink" href="#lagrangians" title="Permalink to this headline">¶</a></h2>
<p>Lagrangians represent a powerful method for solving problems that
would be nearly impossible by direct application of Newton’s third
law, <span class="math notranslate nohighlight">\(\boldsymbol{F}=m\boldsymbol{a}\)</span>. The method works well for problems where a
system is well described by a few \textit{generalized coordinates}. A
generalized coordinate might be the angle describing the position of a
pendulum. This one angle takes the place of using <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> to
describe the position of the pendulum, then applying a clumsy
constraint.</p>
<p>The Lagrangian equations of motion can be derived from a principle of
least action, where the action <span class="math notranslate nohighlight">\(S\)</span> is defined as</p>
<!-- Equation labels as ordinary links -->
<div id="_auto96"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
S=\int dt~ L(q,\dot{q},t),
\label{_auto96} \tag{132}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(q\)</span> is some coordinate that describes the orientation of a
system and the Lagrangian <span class="math notranslate nohighlight">\(L\)</span> is defined as</p>
<!-- Equation labels as ordinary links -->
<div id="_auto97"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
L=T-U,
\label{_auto97} \tag{133}
\end{equation}
\]</div>
<p>the difference of the kinetic and potential energies. Minimizing the
action through the Euler-Lagrange equations gives the Lagrangian
equations of motion,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto98"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d}{dt}\frac{\partial L}{\partial \dot{q}}=\frac{\partial L}{\partial q}.
\label{_auto98} \tag{134}
\end{equation}
\]</div>
<p>We begin with two simple examples, neither of which gains from the Lagrangian approach.</p>
<p>Consider a particle of mass <span class="math notranslate nohighlight">\(m\)</span> connected to a spring with stiffness <span class="math notranslate nohighlight">\(k\)</span>. Derive the Lagrangian equations of motion.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
L&amp;=&amp;\frac{1}{2}m\dot{x}^2-\frac{1}{2}kx^2,\\
\frac{d}{dt}\frac{\partial L}{\partial \dot{x}}&amp;=&amp;\frac{\partial L}{\partial x},\\
m\ddot{x}&amp;=&amp;-kx.
\end{eqnarray*}
\end{split}\]</div>
<p>Derive the Lagrangian equations of motion for a pendulum of mass <span class="math notranslate nohighlight">\(m\)</span>
and length <span class="math notranslate nohighlight">\(\ell\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
L&amp;=&amp;\frac{m}{2}\ell^2\dot{\theta}^2-mg\ell(1-\cos\theta),\\
\frac{d}{dt}\frac{\partial L}{\partial \dot{\theta}}&amp;=&amp;\frac{\partial L}{\partial \theta},\\
m\ell^2\ddot{\theta}&amp;=&amp;-mg\ell\sin\theta,\\
\ddot{\theta}&amp;=&amp;-\frac{g}{\ell}\sin\theta,\\
\ddot{\theta}&amp;\approx&amp;-\frac{g}{\ell}\theta.
\end{eqnarray*}
\end{split}\]</div>
<div class="section" id="proving-lagrange-s-equations-of-motion-from-newton-s-laws">
<h3>Proving Lagrange’s Equations of Motion from Newton’s Laws<a class="headerlink" href="#proving-lagrange-s-equations-of-motion-from-newton-s-laws" title="Permalink to this headline">¶</a></h3>
<p>Lagrange’s equations of motion can only be applied for the following conditions:</p>
<ul class="simple">
<li><p>The potential energy is a function of the generalized coordinates <span class="math notranslate nohighlight">\(q_i\)</span>, but not of <span class="math notranslate nohighlight">\(\dot{q}_i\)</span>.</p></li>
<li><p>The relation between the original coordinates <span class="math notranslate nohighlight">\(x,y,z\cdots\)</span> and the generalized coordinates does not depend on <span class="math notranslate nohighlight">\(\dot{q}_i\)</span>, e.g. <span class="math notranslate nohighlight">\(x(q,t)\)</span> not <span class="math notranslate nohighlight">\(x(q,\dot{q},t)\)</span>.</p></li>
<li><p>Any constraints used to reduce the number of degrees of freedom are functions of <span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span>, but not of <span class="math notranslate nohighlight">\(\dot{\boldsymbol{q}}\)</span>.</p></li>
<li><p>The motion is not dissipative (no damping or friction).</p></li>
</ul>
<p>Going forward with the proof, consider <span class="math notranslate nohighlight">\(x_i(q_1,q_2\cdots,t)\)</span> and look
at the l.h.s. of Lagrange’s equations of motion.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{\partial T}{\partial\dot{q}_j}&amp;=&amp;\sum_i\frac{\partial T}{\partial\dot{x}_i}\frac{\partial\dot{x}_i}{\partial\dot{q_j}}
+\sum_i\frac{\partial T}{\partial x_i}\frac{\partial x_i}{\partial\dot{q_j}}\\
\nonumber
&amp;=&amp;\sum_i m\dot{x}_i\frac{\partial \dot{x}_i}{\partial\dot{q_j}}\\
\nonumber
&amp;=&amp;\sum_i m\dot{x}_i\frac{(\delta x_i/\delta t)|_{{\rm fixed~}q_{j'\ne j}}}{\delta q_j/\delta t}\\
\nonumber
&amp;=&amp;\sum_im\dot{x}_i\frac{\delta{x}_i|_{{\rm fixed~}q_{j'\ne j}}}{\delta q_j}\\
\nonumber
&amp;=&amp;\sum_i m\dot{x}_i\frac{\partial x_i}{\partial q_j}.
\end{eqnarray}
\end{split}\]</div>
<p>In the first line we used the fact that <span class="math notranslate nohighlight">\(T\)</span> does not depend on
<span class="math notranslate nohighlight">\(x\)</span>. Continuing with taking the derivative of <span class="math notranslate nohighlight">\(U\)</span>,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
-\frac{\partial U}{\partial\dot{q}_j}&amp;=&amp;-\sum_i\frac{\partial U}{\partial x_i}\frac{\partial x_i}{\partial\dot{q}_j}=0.
\end{eqnarray}
\]</div>
<p>In the first line above we used the fact that <span class="math notranslate nohighlight">\(U\)</span> does not depend on <span class="math notranslate nohighlight">\(\dot{x}\)</span> then we used the second condition that <span class="math notranslate nohighlight">\(x\)</span> does not depend on <span class="math notranslate nohighlight">\(\dot{q}\)</span>. Adding the two pieces together, then taking the derivative w.r.t. time,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\nonumber
\frac{d}{dt}\frac{\partial}{\partial\dot{q}}(T-U)&amp;=&amp;\sum_im\ddot{x}_i\frac{\partial x_i}{\partial q_j}
+\sum_i m\dot{x}_i\frac{\partial\dot{x}_i}{\partial q_j}.
\end{eqnarray}
\]</div>
<p>Now, we consider the r.h.s. of Lagrange’s equations. Because the
kinetic energy depends only on <span class="math notranslate nohighlight">\(\dot{x}\)</span> and not <span class="math notranslate nohighlight">\(x\)</span>, and because the
potential depends on <span class="math notranslate nohighlight">\(x\)</span> but not <span class="math notranslate nohighlight">\(\dot{x}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{\partial}{\partial q_j}(T-U)&amp;=&amp;\sum_i\frac{\partial T}{\partial\dot{x}_i}\frac{\partial\dot{x_i}}{\partial q_j}
-\sum_i\frac{\partial U}{\partial x_i}\frac{\partial x_i}{\partial q_j}\\
\nonumber
&amp;=&amp;\sum_i m\dot{x}_i\frac{\partial\dot{x_i}}{\partial q_j}
-\sum_i\frac{\partial U}{\partial x_i}\frac{\partial x_i}{\partial q_j}
\end{eqnarray}
\end{split}\]</div>
<p>Using the fact that <span class="math notranslate nohighlight">\(m\ddot{x}_i=-(\partial/\partial x_i)U\)</span>, one can
see that the bottom expressions above are identical,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto99"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d}{dt}\frac{\partial}{\partial\dot{q}_i}(T-U)=\frac{\partial}{\partial q_i}(T-U).
\label{_auto99} \tag{135}
\end{equation}
\]</div>
</div>
<div class="section" id="lagrangian-examples">
<h3>Lagrangian Examples<a class="headerlink" href="#lagrangian-examples" title="Permalink to this headline">¶</a></h3>
<p>Two examples are presented here. In the first, there are two
generalized coordinates, but the two equations of motion can be
reduced to one through conservation laws (angular momentum in this
case). In the second, there is a time-dependent constraint.</p>
<p>Consider a cone of half angle <span class="math notranslate nohighlight">\(\alpha\)</span> standing on its tip at the
origin. The surface of the cone is defined as</p>
<div class="math notranslate nohighlight">
\[
r=\sqrt{x^2+y^2}=z\tan \alpha.
\]</div>
<p>Find the equations of motion for a particle of mass <span class="math notranslate nohighlight">\(m\)</span> moving along the surface under the influence of a constant gravitational force, <span class="math notranslate nohighlight">\(-mg\hat{z}\)</span>. For generalized coordinates use the azimuthal angle <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(r\)</span>.</p>
<p>The kinetic energy is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
T&amp;=&amp;\frac{1}{2}mr^2\dot{\theta}^2+\frac{1}{2}m(\dot{r}^2+\dot{z}^2)\\
&amp;=&amp;\frac{1}{2}mr^2\dot{\theta}^2+\frac{1}{2}m\dot{r}^2\left(1+\cot^2\alpha\right)\\
&amp;=&amp;\frac{1}{2}mr^2\dot{\theta}^2+\frac{1}{2}m\dot{r}^2\csc^2\alpha.
\end{eqnarray*}
\end{split}\]</div>
<p>The potential energy is</p>
<div class="math notranslate nohighlight">
\[
U=mgr\cot\alpha,
\]</div>
<p>so Lagrange’s equations give</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\frac{d}{dt}\left(mr^2\dot{\theta}\right)&amp;=&amp;0,\\
\frac{d}{dt}\left(m\csc^2\alpha \dot{r}\right)&amp;=&amp;mr\dot{\theta}^2-mg\cot\alpha,\\
\ddot{r}&amp;=&amp;r\dot{\theta}^2\sin^2\alpha-g\cos\alpha\sin\alpha
\end{eqnarray*}
\end{split}\]</div>
<p>The first equation is a statement of the conservation of angular
momentum with <span class="math notranslate nohighlight">\(L=mr^2\dot{\theta}\)</span>, so the second equation can also be
expressed as</p>
<div class="math notranslate nohighlight">
\[
\ddot{r}=\frac{L^2\sin^2\alpha}{m^2r^3}-g\sin\alpha\cos\alpha.
\]</div>
<p>A bead slides along a wire bent in the shape of a parabola,</p>
<div class="math notranslate nohighlight">
\[
z=\frac{1}{2}kr^2,~~r^2=x^2+y^2.
\]</div>
<p>Also, the parabolic wire is rotating about the <span class="math notranslate nohighlight">\(z\)</span> axis with angular
velocity <span class="math notranslate nohighlight">\(\omega\)</span>. Derive the equations of motion. Are there any
stable configurations?</p>
<p>Using the fact that</p>
<div class="math notranslate nohighlight">
\[
\dot{z}=\dot{r}\frac{\partial z}{\partial r}=kr\dot{r},
\]</div>
<p>the kinetic and potential energies are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
T&amp;=&amp;\frac{1}{2}m\left(\dot{r}^2+\dot{z}^2+r^2\omega^2\right)\\
&amp;=&amp;\frac{1}{2}m\left(\dot{r}^2+(kr\dot{r})^2+r^2\omega^2\right),\\
U&amp;=&amp;mgkr^2/2.
\end{eqnarray*}
\end{split}\]</div>
<p>The equations of motion are then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\frac{d}{dt}\left\{m\dot{r}(1+k^2r^2)\right\}&amp;=&amp;-mgkr+mk^2\dot{r}^2r+m\omega^2r,\\
\ddot{r}&amp;=&amp;\frac{-gkr+\omega^2r-k^2\dot{r}^2r}{1+k^2r^2}
\end{eqnarray*}
\end{split}\]</div>
<p>For a stable configuration, there needs to be a solution with
<span class="math notranslate nohighlight">\(\dot{r}=0\)</span> and <span class="math notranslate nohighlight">\(\ddot{r}=0\)</span>. This can only happen at <span class="math notranslate nohighlight">\(r=0\)</span>, and then
for the acceleration to be inward for small deviations of <span class="math notranslate nohighlight">\(r\)</span> one
needs to have <span class="math notranslate nohighlight">\(gk&gt;\omega^2\)</span>. If <span class="math notranslate nohighlight">\(\omega^2&gt;gk\)</span> the bead will move
outward indefinitely.</p>
</div>
</div>
<div class="section" id="small-vibrations-and-normal-modes">
<h2>Small Vibrations and Normal Modes<a class="headerlink" href="#small-vibrations-and-normal-modes" title="Permalink to this headline">¶</a></h2>
<p>Two examples are provided for solving for normal modes. These are
solutions with multiple generalized coordinates, where the motion is
that of simple harmonic motion. However, the motion is only simple for
a particular set of coordinates <span class="math notranslate nohighlight">\(q_1\)</span> and <span class="math notranslate nohighlight">\(q_2\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
q_1&amp;=&amp;A\cos(\omega_1 t),\\
\nonumber
q_2&amp;=&amp;B\cos(\omega_2 t),
\end{eqnarray}
\end{split}\]</div>
<p>while it is not necessarily simple in other coordinates. For example
if <span class="math notranslate nohighlight">\(x=q_1+q_2\)</span>, and <span class="math notranslate nohighlight">\(y=q_1-q_2\)</span>, the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> motions will contain
mixtures of multiple frequencies. For many problems, or in the limit
of small vibrations about a minimum, there is some coordinate system
where the motion is simple. These are normal modes. Characterizing the
normal modes involves finding the frequencies, <span class="math notranslate nohighlight">\(\omega_i\)</span>, and the
coordinate system where the motion is simple for each coordinate. This
involves finding the direction, or the linear combination of <span class="math notranslate nohighlight">\(x_i\)</span>
that form the coordinates <span class="math notranslate nohighlight">\(q_i\)</span> in which the motion is that of a
single oscillator in each coordinate.</p>
<p>For a first example, we consider a system of springs, where we write
the Lagrangian, then find the normal modes. For the second example, a
double pendulum is considered. In this case, one must first make a
small angle expansion before finding the modes. In principle, problems
could have the same number of normal modes a degrees of freedom. For
example, a system of 7 particles moving in three dimensions has 21
degrees of freedom. However, some of the degrees of freedom do not
have oscillatory behavior. For example, for a rigid body in free
space, the angles describing the orientation evolve, but do not
oscillate. Also, the center-of-mass coordinates of a system of
particles isolated from outside particles moves at constant
velocity. One can also describe these as normal modes, but acknowledge
that their characteristic frequency is zero, as there are no restoring
forces.</p>
<p>Consider two springs, whose relaxed lengths are <span class="math notranslate nohighlight">\(\ell\)</span>, connected to three masses as depicted in the figure here. Describe the two normal modes of the motion. We can write the Lagrangian as</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
\mathcal{L}&amp;=&amp;\frac{m}{2}\dot{x}_1^2+m\dot{x}_2^2+\frac{m}{2}\dot{x}_3^2
-\frac{k}{2}(x_2-x_1-\ell)^2-\frac{k}{2}(x_3-x_2-\ell)^2.
\end{eqnarray*}
\]</div>
<p>There are three coordinates, thus there are three equations of motion,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
m\ddot{x}_1&amp;=&amp;-k(x_1-x_2+\ell)\\
2m\ddot{x}_2&amp;=&amp;-k(x_2-x_1-\ell)-k(x_2-x_3+\ell)\\
&amp;=&amp;-k(2x_2-x_1-x_3)\\
m\ddot{x}_3&amp;=&amp;-k(x_3-x_2+\ell).
\end{eqnarray*}
\end{split}\]</div>
<p>This is a bit complicated because the center-of-mass motion does not easily separate from the three equations. Instead, choose the following coordinates,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
X&amp;=&amp;\frac{x_1+2x_2+x_3}{4},\\
q_1&amp;=&amp;x_1-x_2+\ell,\\
q_3&amp;=&amp;x_3-x_2-\ell.
\end{eqnarray*}
\end{split}\]</div>
<p>In these coordinates the potential energy only involves two coordinates,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
U&amp;=&amp;\frac{k}{2}(q_1^2+q_3^2).
\end{eqnarray*}
\]</div>
<p>To express the kinetic energy express <span class="math notranslate nohighlight">\(x_1, x_2\)</span> and <span class="math notranslate nohighlight">\(x_3\)</span> in terms of
<span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(q_1\)</span> and <span class="math notranslate nohighlight">\(q_3\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
x_1&amp;=&amp;(3q_1-q_3-4\ell+4X)/4,\\
x_2&amp;=&amp;(4X-q_1-q_3)/4,\\
x_3&amp;=&amp;(3q_3-q_1+4\ell+4X)/4.
\end{eqnarray*}
\end{split}\]</div>
<p>The kinetic energy and Lagrangian are them</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
T&amp;=&amp;\frac{m}{2}\frac{1}{16}(3\dot{q}_1-\dot{q}_3+4\dot{X})^2
+m\frac{1}{16}(4\dot{X}-\dot{q}_1-\dot{q}_3)^2
+\frac{m}{2}\frac{1}{16}(3\dot{q}_3-\dot{q}_1+4\dot{X})^2\\
&amp;=&amp;\frac{3m}{8}(\dot{q}_1^2+\dot{q}_3^2)-\frac{m}{4}\dot{q}_1\dot{q}_3
+2m\dot{X}^2,\\
\mathcal{L}&amp;=&amp;\frac{3m}{8}(\dot{q}_1^2+\dot{q}_3^2)-\frac{m}{4}\dot{q}_1\dot{q}_3
+2m\dot{X}^2-\frac{k}{2}q_1^2-\frac{k}{2}q_3^2.
\end{eqnarray*}
\end{split}\]</div>
<p>The three equations of motion are then,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\frac{3}{4}m\ddot{q}_1-\frac{1}{4}m\ddot{q}_3&amp;=&amp;-kq_1,\\
\frac{3}{4}m\ddot{q}_3-\frac{1}{4}m\ddot{q}_1&amp;=&amp;-kq_3,\\
4M\ddot{X}&amp;=&amp;0.
\end{eqnarray*}
\end{split}\]</div>
<p>The last equation simply states that the center-of-mass velocity is
fixed. One could obtain the same result by summing the equations of
motion for <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(2x_2\)</span> and <span class="math notranslate nohighlight">\(x_3\)</span> above. The second two equations are
more complicated. To solve them, we assume a form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
q_1&amp;=&amp;Ae^{i\omega t},\\
q_3&amp;=&amp;Be^{i\omega t},
\end{eqnarray*}
\end{split}\]</div>
<p>Because this is a linear equation, we can multiply the solution by a
constant and it will still be a solution. Thus, we can set <span class="math notranslate nohighlight">\(B=1\)</span>, then
solve for <span class="math notranslate nohighlight">\(A\)</span>, effectively solving for <span class="math notranslate nohighlight">\(A/B\)</span>. Putting this guess into
the equations of motion,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
-\frac{3}{4}\frac{A}{B}\omega^2+\frac{1}{4}\omega^2&amp;=&amp;-\omega_0^2\frac{A}{B},\\
-\frac{3}{4}\omega^2+\frac{1}{4}\frac{A}{B}\omega^2&amp;=&amp;-\omega_0^2.
\end{eqnarray*}
\end{split}\]</div>
<p>This is two equations and two unknowns, <span class="math notranslate nohighlight">\(\omega^2\)</span> and
<span class="math notranslate nohighlight">\(A/B\)</span>. Substituting for <span class="math notranslate nohighlight">\(A/B\)</span> gives a quadratic equation,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\omega^4-3\omega_0^2\omega^2+2\omega_0^4&amp;=&amp;0,\\
\omega_0^2&amp;\equiv&amp;k/m.
\end{eqnarray*}
\end{split}\]</div>
<p>The two solutions are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
(1)~~\omega&amp;=&amp;\omega_0,~~~A=-B,\\
(2)~~\omega&amp;=&amp;\omega_0\sqrt{2},~~~A=B.
\end{eqnarray*}
\end{split}\]</div>
<p>The first solution corresponds to the two outer masses moving in
opposite directions, in sync, with the middle mass fixed. The second
solution has both outer masses moving in the same direction, but with
the center mass moving opposite. These two solutions are referred to
as normal modes, and are characterized by their frequency and by the
linear combinations of coordinates that oscillate together. In
general, the solution is a linear combination of normal modes, which
usually results in a chaotic looking motion. However, once the
solution is expressed in terms of the normal modes, each of which
oscillates independently in a simple manner, one can better understand
the motion. Further, the frequencies of these modes represent the
natural resonant frequencies of the system. This is important in the
construction of many structures, such as bridges or vehicles.</p>
<p>Consider a double pendulum confined to the <span class="math notranslate nohighlight">\(x-y\)</span> plane, where <span class="math notranslate nohighlight">\(y\)</span> is
vertical. A mass <span class="math notranslate nohighlight">\(m\)</span> is connected to the ceiling with a massless
string of length <span class="math notranslate nohighlight">\(\ell\)</span>. A second mass <span class="math notranslate nohighlight">\(m\)</span> hangs from the first mass
with an identical massless string of the same length. Using <span class="math notranslate nohighlight">\(\theta_1\)</span>
and <span class="math notranslate nohighlight">\(\theta_2\)</span> to describe the orientations of the strings relative to
the vertical axis, find the Lagrangian and derive the equations of
motion, both for arbitrary angles and in the small-angle
approximation. Finally, express the equations of motion in the limit
of small oscillations.</p>
<p>The kinetic and potential energies are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
T&amp;=&amp;\frac{1}{2}m\ell^2\dot{\theta}_1^2
+\frac{1}{2}m\left\{(\ell\dot{\theta}_1\cos\theta_1+\ell\dot{\theta}_2\cos\theta_2)^2
+(\ell\dot{\theta}_1\sin\theta_1+\ell\dot{\theta}_2\sin\theta_2)^2\right\}\\
&amp;=&amp;\frac{1}{2}m\ell^2\left\{2\dot{\theta}_1^2+\dot{\theta}_2^2+2\dot{\theta}_1\dot{\theta}_2\cos(\theta_1-\theta_2)
\right\},\\
U&amp;=&amp;mg\ell(1-\cos\theta_1)+mg\left[\ell(1-\cos\theta_1)+\ell(1-\cos\theta_2)\right]\\
&amp;=&amp;mg\ell(3-2\cos\theta_1-\cos\theta_2)
\end{eqnarray*}
\end{split}\]</div>
<p>Lagrange’s equations for <span class="math notranslate nohighlight">\(\theta_1\)</span> lead to</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
m\ell^2\frac{d}{dt}\left\{2\dot{\theta}_1+\dot{\theta}_2\cos(\theta_1-\theta_2)\right\}&amp;=&amp;
-m\ell^2\dot{\theta}_1\dot{\theta}_2\sin(\theta_1-\theta_2)
-2mg\ell\sin\theta_1,\\
2\ddot{\theta}_1+\ddot{\theta}_2\cos(\theta_1-\theta_2)+\dot{\theta}_2^2\sin(\theta_1-\theta_2)
&amp;=&amp;-2\omega_0^2\sin\theta_1,\\
\omega_0^2&amp;\equiv&amp; g/\ell,
\end{eqnarray*}
\end{split}\]</div>
<p>and the equations for <span class="math notranslate nohighlight">\(\theta_2\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
m\ell^2\frac{d}{dt}\left\{\dot{\theta}_2+\dot{\theta}_1\cos(\theta_1-\theta_2)\right\}&amp;=&amp;
m\ell^2\dot{\theta}_1\dot{\theta}_2\sin(\theta_1-\theta_2)-mg\ell\sin\theta_2,\\
\ddot{\theta}_2+\ddot{\theta_1}\cos(\theta_1-\theta_2)&amp;=&amp;
-\omega_0^2\sin\theta_2.
\end{eqnarray*}
\end{split}\]</div>
<p>For small oscillations, one can only consider terms linear in <span class="math notranslate nohighlight">\(\theta_1\)</span> and <span class="math notranslate nohighlight">\(\theta_2\)</span> or their derivatives,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
2\ddot{\theta}_1+\ddot{\theta}_2&amp;=&amp;-2\omega_0^2\theta_1,\\
\nonumber
\ddot{\theta}_1+\ddot{\theta}_2&amp;=&amp;-\omega_0^2\theta_2.
\end{eqnarray}
\end{split}\]</div>
<p>To find the solutions, assume they are of the form
<span class="math notranslate nohighlight">\(\theta_1=Ae^{i\omega t}, \theta_2=Be^{i\omega t}\)</span>. Solve for <span class="math notranslate nohighlight">\(\omega\)</span>
and <span class="math notranslate nohighlight">\(A/B\)</span>, noting that <span class="math notranslate nohighlight">\(B\)</span> is arbitrary.</p>
<p>Plug in the desired form and find</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
e^{i\omega t}(-2\omega^2A-\omega^2B)&amp;=&amp;e^{i\omega t}(-2\omega_0^2A),\\
e^{i\omega t}(-\omega^2A-\omega^2B)&amp;=&amp;e^{i\omega t}(-\omega_0^2B).
\end{eqnarray*}
\end{split}\]</div>
<p>We can treat <span class="math notranslate nohighlight">\(B\)</span> as arbitrary and set it to unity. When we find <span class="math notranslate nohighlight">\(A\)</span>,
it is the same as <span class="math notranslate nohighlight">\(A/B\)</span> for arbitrary <span class="math notranslate nohighlight">\(B\)</span>. This gives the equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
2\omega^2A+\omega^2&amp;=&amp;2\omega_0^2A,\\
\omega^2A+\omega^2&amp;=&amp;\omega_0^2.
\end{eqnarray*}
\end{split}\]</div>
<p>This is two equations and two unknowns. Solving them leads to a
quadratic equation with solutions</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
A/B&amp;=&amp;\pm\frac{1}{\sqrt{2}},\\
\omega^2&amp;=&amp;\frac{\omega_0^2}{1\pm 1/\sqrt{2}}.
\end{eqnarray*}
\end{split}\]</div>
<p>Again, these two solutions are the normal modes, and the general
solution is a sum of the two solutions, with two arbitrary
constants. For the angles <span class="math notranslate nohighlight">\(\theta_1\)</span> and <span class="math notranslate nohighlight">\(\theta_2\)</span> are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\theta_1&amp;=&amp;\frac{A_+}{\sqrt{2}}e^{i\omega_+t}, ~\theta_2=A_+e^{i\omega_+t},\\
\theta_1&amp;=&amp;\frac{-A_-}{\sqrt{2}}e^{i\omega_-t}, ~\theta_2=A_-e^{i\omega_-t},\\
\omega_{\pm}&amp;=&amp;\omega_0\sqrt{\frac{1}{1\pm 1/\sqrt{2}}}.
\end{eqnarray*}
\end{split}\]</div>
<p>One can also express the solution in vector notation, with the vectors
having arbitrary amplitudes <span class="math notranslate nohighlight">\(A_+\)</span> and <span class="math notranslate nohighlight">\(A_-\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\theta_+&amp;=&amp;\left(\begin{array}{c}
\frac{1}{\sqrt{2}}\\ 1\end{array}\right)A_+e^{i\omega_+t},\\
\theta_-&amp;=&amp;\left(\begin{array}{c}
\frac{-1}{\sqrt{2}}\\ 1\end{array}\right)A_-e^{i\omega_-t}.
\end{eqnarray*}
\end{split}\]</div>
<p>Here, the upper/lower components of the vector describe
<span class="math notranslate nohighlight">\(\theta_1/\theta_2\)</span> respectively.</p>
<p>These problems can be treated as linear algebra exercises. Linear
algebra is not used in this course, but nonetheless we describe how
this works for the curious student. In the limit of small vibrations,
the equations of motion can be expressed in the form,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
M\ddot{q}&amp;=&amp;-Kq,
\end{eqnarray*}
\]</div>
<p>a form that looks like the spring equation. However, <span class="math notranslate nohighlight">\(q\)</span> is an
<span class="math notranslate nohighlight">\(n-\)</span>dimensional vector and <span class="math notranslate nohighlight">\(M\)</span> and <span class="math notranslate nohighlight">\(k\)</span> are <span class="math notranslate nohighlight">\(n\times n\)</span> matrices. In
the double pendulum example, the dimensionality is 2 and the <span class="math notranslate nohighlight">\(q\)</span>
refers to the <span class="math notranslate nohighlight">\(\theta_1\)</span> and <span class="math notranslate nohighlight">\(\theta_2\)</span>, and the matrices for <span class="math notranslate nohighlight">\(M\)</span> and
<span class="math notranslate nohighlight">\(K\)</span> can be read off (add ref).</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
M&amp;=&amp;\left(\begin{array}{cc}
2&amp;1\\
1&amp;1\end{array}\right)~,\hspace*{40pt} K=\left(\begin{array}{cc}
2\omega_0^2&amp;0\\
0&amp;\omega_0^2\end{array}\right).
\end{eqnarray*}
\end{split}\]</div>
<p>Multiplying both sides of the equation by the inverse matrix <span class="math notranslate nohighlight">\(M^{-1}\)</span>,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
\ddot{q}&amp;=&amp;-\left(M^{-1}K\right)q.
\end{eqnarray*}
\]</div>
<p>Here,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
M^{-1}&amp;=&amp;\left(\begin{array}{cc}
1&amp;-1\\
-1&amp;2\end{array}\right),\\
M^{-1}K&amp;=&amp;\left(\begin{array}{cc}
2&amp;-1\\
-2&amp;2\end{array}\right)\omega_0^2.
\end{eqnarray*}
\end{split}\]</div>
<p>One can find a transformation, basically a rotation, that transforms
to a frame where <span class="math notranslate nohighlight">\(M^{-1}K\)</span> is diagonal. In this coordinate system the
diagonal components of <span class="math notranslate nohighlight">\(M^{-1}K\)</span> represent the squared frequencies of
the normal modes,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
M^{-1}K\rightarrow -\left(\begin{array}{cc}
\omega_+^2&amp;0\\
0&amp;\omega_-^2\end{array}\right)~,
\end{split}\]</div>
<p>and are known as “eigen” frequencies. The corresponding unit vectors,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left(\begin{array}{c}
1\\0\end{array}\right)~{\rm and}~\left(\begin{array}{c}
0\\1\end{array}\right)~{\rm in~the~new~coordinate~system},
\end{split}\]</div>
<p>can be rotated back into the original frame, and become the solutions
for the normal modes. These are then called “eigenvectors”, which
are the same as the normal modes. Finding the eigenfrequencies is
performed by realizing that the determinant of a matrix is unchanged
by the rotation between coordinate systems. Writing the equations of
motion as an eigenvalue problem,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\left[A-\lambda_i\mathbb{1}\right]u_i&amp;=&amp;0,~~~A\equiv M^{-1}K,~\lambda_i\equiv \omega^2_i.
\end{eqnarray}
\]</div>
<p>In the coordinate system where <span class="math notranslate nohighlight">\(M^{-1}K\)</span> is diagonal, and the forms
for <span class="math notranslate nohighlight">\(u_i\)</span> are simple this requires that in that system, the diagonal
elements of <span class="math notranslate nohighlight">\(M^{-1}K\)</span> are the eigenvalues, <span class="math notranslate nohighlight">\(\omega_i^2\)</span>. For each
<span class="math notranslate nohighlight">\(\omega^2_i\)</span>, the determinant <span class="math notranslate nohighlight">\(|A-\lambda_i\mathbb{1}|\)</span> must
vanish. This is then true in any coordinate system,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
{\rm det}\left[A-\lambda\mathbb{1}\right]&amp;=&amp;0,
\end{eqnarray}
\]</div>
<p>which for a <span class="math notranslate nohighlight">\(2\times 2\)</span> matrix becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\left|
\begin{array}{cc}
A_{11}-\lambda&amp;A_{12}\\
A_{21}&amp;A_{22}-\lambda
\end{array}
\right|&amp;=&amp;0,\\
A_{11}A_{22}-\lambda A_{11}-\lambda A_{22}+\lambda^2-A_{21}A_{12}&amp;=&amp;0.
\end{eqnarray}
\end{split}\]</div>
<p>One can solve a quadratic equation for <span class="math notranslate nohighlight">\(\lambda\)</span>, which gives two
eigenvalues corresponding to <span class="math notranslate nohighlight">\(\omega_+^2\)</span> and <span class="math notranslate nohighlight">\(\omega_-^2\)</span> found
above. Choosing one of the eigenvalues, one can insert one of the
eigenvalues <span class="math notranslate nohighlight">\(\lambda_i\)</span> into the eigenvalue problem  and solve for <span class="math notranslate nohighlight">\(u_i\)</span>,
then choose the other eigenvalue and solve for the other corresponding
vector.</p>
<p>If this were a 3-dimensional set of equations, the determinant would
include terms like <span class="math notranslate nohighlight">\(\lambda^3\)</span> and would become a cubic equation with
three eigenvalues. One would then solve for three eigenvectors. If one
has a system with dimensionality <span class="math notranslate nohighlight">\(n&gt;2\)</span>, one usually resorts to solving
the problem numerically due to the messiness of the algebra. The main
programming languages all have packages which readily diagonalize
matrices and find eigenvectors and eigenvalues.</p>
</div>
<div class="section" id="conservation-laws">
<h2>Conservation Laws<a class="headerlink" href="#conservation-laws" title="Permalink to this headline">¶</a></h2>
<p>Energy is conserved only when the Lagrangian has no explicit
dependence on time, i.e. <span class="math notranslate nohighlight">\(L(q,\dot{q})\)</span>, not <span class="math notranslate nohighlight">\(L(q,\dot{q},t)\)</span>. To show
this, we first define the Hamiltonian,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
H&amp;=&amp;\sum_i\left(\dot{q}_i\frac{\partial L}{\partial\dot{q}_i}\right)-L.
\end{eqnarray}
\]</div>
<p>After showing that <span class="math notranslate nohighlight">\(H\)</span> is conserved, i.e. <span class="math notranslate nohighlight">\((d/dt)H=0\)</span>, we then show
that <span class="math notranslate nohighlight">\(H\)</span> can be identified with the total energy, <span class="math notranslate nohighlight">\(H=T+V\)</span>.</p>
<p>One can see that <span class="math notranslate nohighlight">\(H\)</span> is conserved by applying first using the chain
rule for <span class="math notranslate nohighlight">\((d/dt)H\)</span>, then applying Lagrange’s
equations,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{d}{dt}H&amp;=&amp;\sum_i\left\{\ddot{q}_i\frac{\partial L}{\partial\dot{q}_i}+\dot{q}_i\frac{d}{dt}\left(\frac{\partial L}{\partial\dot{q}_i}\right)-\frac{\partial L}{\partial\dot{q}_i}\ddot{q}_i-\frac{\partial L}{\partial q_i}\dot{q}_i\right\}\\
\nonumber
&amp;=&amp;\sum_i\left\{\ddot{q}_i\frac{\partial L}{\partial\dot{q}_i}+\dot{q}_i\frac{\partial L}{\partial q_i}-\frac{\partial L}{\partial\dot{q}_i}\ddot{q}_i-\frac{\partial L}{\partial q_i}\dot{q}_i\right\}\\
\nonumber
&amp;=&amp;0.
\end{eqnarray}
\end{split}\]</div>
<p>These steps assumed that <span class="math notranslate nohighlight">\(L\)</span> had no explicit time dependence, i.e. <span class="math notranslate nohighlight">\(L\)</span>
is a function of <span class="math notranslate nohighlight">\(q\)</span> and <span class="math notranslate nohighlight">\(\dot{q}\)</span>, but not of <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>Next, we show that <span class="math notranslate nohighlight">\(L\)</span> can be identified with the energy. Because <span class="math notranslate nohighlight">\(V\)</span> does not depend on <span class="math notranslate nohighlight">\(\dot{q}\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto100"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
H=\sum_i\frac{\partial T}{\partial\dot{q}_i}\dot{q}_i-T+V.
\label{_auto100} \tag{136}
\end{equation}
\]</div>
<p>If the kinetic energy has a purely quadratic form in terms of <span class="math notranslate nohighlight">\(\dot{q}\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto101"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
T=\sum_{ij}A_{ij}(q)\dot{q}_i\dot{q}_j,
\label{_auto101} \tag{137}
\end{equation}
\]</div>
<p>the Hamiltonian becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
H&amp;=&amp;\sum_{ij}2A_{ij}(q)\dot{q}_i\dot{q}_j-\sum_{ij}A_{ij}(q)\dot{q}_i\dot{q}_j+V\\
\nonumber
&amp;=&amp;T+V.
\end{eqnarray}
\end{split}\]</div>
<p>The proof that <span class="math notranslate nohighlight">\(H\)</span> equals the energy hinged on the fact that the
kinetic energy was quadratic in <span class="math notranslate nohighlight">\(\dot{q}\)</span>. This can be attributed to
time-reversal symmetry. Because the Cartesian coordinates <span class="math notranslate nohighlight">\(x_i\)</span> do not
depend on <span class="math notranslate nohighlight">\(\dot{q}_i\)</span> or on time, <span class="math notranslate nohighlight">\(\dot{x}_i=(\partial x_i/\partial
q_j)\dot{q}_j\)</span>. Thus, the kinetic energy, <span class="math notranslate nohighlight">\(T=m\dot{x}_i^2/2\)</span>, should
be proportional to two powers of <span class="math notranslate nohighlight">\(\dot{q}\)</span>, which validates the
assumption above.</p>
<p>Here, energy conservation is predicated on the Lagrangian not having
an explicit time dependence. Without an explicit time dependence the
equations of motion are unchanged if one translates a fixed amount in
time because the physics does not depend on when the clock starts. In
contrast, the absolute time becomes relevant if there is an explicit
time dependence. In fact, conservation laws can usually be associated
with symmetries. In this case the translation symmetry in time leads
to energy conservation.</p>
<p>For another example of how symmetry leads to conservation laws,
consider a Lagrangian for a particle of mass <span class="math notranslate nohighlight">\(m\)</span> moving in a
two-dimensional plane where the generalized coordinates are the radius
<span class="math notranslate nohighlight">\(r\)</span> and the angle <span class="math notranslate nohighlight">\(\theta\)</span>. The kinetic energy would be</p>
<!-- Equation labels as ordinary links -->
<div id="_auto102"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
T=\frac{1}{2}m\left\{\dot{r}^2+r^2\dot{\theta}^2\right\},
\label{_auto102} \tag{138}
\end{equation}
\]</div>
<p>and if the potential energy <span class="math notranslate nohighlight">\(V(r)\)</span> depends only on the radius <span class="math notranslate nohighlight">\(r\)</span> and
not on the angle, Lagrange’s equations become</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{d}{dt}(m\dot{r})&amp;=&amp;-\frac{\partial V}{\partial r}+m\dot{\theta}^2r,\\
\nonumber
\frac{d}{dt}(mr^2\dot{\theta})&amp;=&amp;0.
\end{eqnarray}
\end{split}\]</div>
<p>The second equation implies that <span class="math notranslate nohighlight">\(mr^2\dot{\theta}\)</span> is a
constant. Indeed, it is the angular momentum which is conserved for a
radial force. Here, the conservation of angular momentum is associated
with the independence of the physics to changes in <span class="math notranslate nohighlight">\(\theta\)</span>, or in
other words, rotational invariance. Once one knows the fact that
<span class="math notranslate nohighlight">\(L=mr^2\dot{\theta}\)</span> is conserved, it can be inserted into the
equations of motion for <span class="math notranslate nohighlight">\(\dot{r}\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto103"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
m\ddot{r}=-\frac{\partial V}{\partial r}+\frac{L^2}{mr^3}.
\label{_auto103} \tag{139}
\end{equation}
\]</div>
<p>This is related to <a class="reference external" href="http://en.wikipedia.org/wiki/Noether%27s_theorem">Emmy Noether’s theorem</a></p>
<p>Simply stated, if the Lagrangian <span class="math notranslate nohighlight">\(L\)</span> is independent of <span class="math notranslate nohighlight">\(q_i\)</span>, one can
see that the quantity <span class="math notranslate nohighlight">\(\partial L/\partial\dot{q}_i\)</span> is conserved,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto104"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d}{dt}\frac{\partial L}{\partial\dot{q}_i}=0.
\label{_auto104} \tag{140}
\end{equation}
\]</div>
<p>Another easy example is in Cartesian coordinates where the potential
depends only on <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> but not on <span class="math notranslate nohighlight">\(z\)</span>. In that case, there is a
translational symmetry. From the last equation, this translates
into conservation of the momentum in the <span class="math notranslate nohighlight">\(z\)</span> direction.</p>
<p>Consider a pair of particles of mass <span class="math notranslate nohighlight">\(m_1\)</span> and <span class="math notranslate nohighlight">\(m_2\)</span> where the potential is of the form</p>
<div class="math notranslate nohighlight">
\[
U(\boldsymbol{r}_1,\boldsymbol{r}_2)=V_a(|m_1\boldsymbol{r}_1+m_2\boldsymbol{r}_2|/(m_1+m_2))+V_b(|\boldsymbol{r}_1-\boldsymbol{r}_2|).
\]</div>
<p>Using symmetry arguments alone, are there any conserved components of
the momentum? or the angular momentum??</p>
<p>There is no translational invariance, hence there are no conserved
components of the momentum. However, there is rotational invariance
about any axis that goes through the origin. Hence, there is angular
momentum conservation in all three directions. Symmetry arguments are
great ways to recognize the existence of conserved quantities, but
actually expressing them in terms of coordinates can be tricky. For
instance, you may need to write the Lagrangian in terms of angles.</p>
<!-- more examples to be added, in particular develop better pendulum model with constraints -->
<!-- Add material about angular momentum conservation and linear momentum. -->
<!-- Add material about non-inertial frames -->
<!-- Double pendulum and Foucalt's pendulum -->
<!-- Revisit oscillations and example on earthquake models --></div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Moten Hjorth-Jensen<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>